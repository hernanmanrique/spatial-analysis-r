<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 23 Area Data III | An Introduction to Spatial Data Analysis and Statistics: A Course in R</title>
  <meta name="description" content="This book was created as a resource for teaching applied spatial statistics at McMaster University by Antonio Paez, with support from Anastassios Dardas, Rajveer Ubhi, Megan Coad, and Alexis Polidoro. The book is published with support of an Open Educational Resources grant from MacPherson Institute, McMaster University." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 23 Area Data III | An Introduction to Spatial Data Analysis and Statistics: A Course in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.jpg" />
  <meta property="og:description" content="This book was created as a resource for teaching applied spatial statistics at McMaster University by Antonio Paez, with support from Anastassios Dardas, Rajveer Ubhi, Megan Coad, and Alexis Polidoro. The book is published with support of an Open Educational Resources grant from MacPherson Institute, McMaster University." />
  <meta name="github-repo" content="paezha/spatial-analysis-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 23 Area Data III | An Introduction to Spatial Data Analysis and Statistics: A Course in R" />
  
  <meta name="twitter:description" content="This book was created as a resource for teaching applied spatial statistics at McMaster University by Antonio Paez, with support from Anastassios Dardas, Rajveer Ubhi, Megan Coad, and Alexis Polidoro. The book is published with support of an Open Educational Resources grant from MacPherson Institute, McMaster University." />
  <meta name="twitter:image" content="/images/cover.jpg" />

<meta name="author" content="Antonio Paez" />


<meta name="date" content="2022-04-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="activity-10-area-data-ii.html"/>
<link rel="next" href="activity-11-area-data-iii.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<script src="libs/lfx-heat-0.1.0/lfx-heat-prod.js"></script>
<script src="libs/lfx-heat-0.1.0/lfx-heat-bindings.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="libs/colourpicker-1.1/colourpicker.min.css" rel="stylesheet" />
<script src="libs/colourpicker-1.1/colourpicker.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-grid-3.4.1/bootstrap-grid.min.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial Analysis in R</a></li>

<li class="divider"></li>
<li><a href="index.html#section" id="toc-section"></a></li>
<li><a href="front-matter.html#front-matter" id="toc-front-matter">Front Matter<span></span></a>
<ul>
<li><a href="front-matter.html#what-is-this-book-and-who-is-it-for" id="toc-what-is-this-book-and-who-is-it-for">What is this book and who is it for?<span></span></a></li>
<li><a href="front-matter.html#allied-resources" id="toc-allied-resources">Allied resources<span></span></a></li>
<li><a href="front-matter.html#contributing" id="toc-contributing">Contributing<span></span></a>
<ul>
<li><a href="front-matter.html#license" id="toc-license"><span class="toc-section-number">0.0.1</span> License<span></span></a></li>
</ul></li>
<li><a href="front-matter.html#how-to-support-this-project" id="toc-how-to-support-this-project">How to support this project<span></span></a></li>
</ul></li>
<li><a href="preface.html#preface" id="toc-preface">Preface<span></span></a>
<ul>
<li><a href="preface.html#spatial-analysis-and-spatial-statistics" id="toc-spatial-analysis-and-spatial-statistics">Spatial Analysis and Spatial Statistics<span></span></a></li>
<li><a href="preface.html#why-this-text" id="toc-why-this-text">Why this Text?<span></span></a></li>
<li><a href="preface.html#plan" id="toc-plan">Plan<span></span></a></li>
<li><a href="preface.html#audience" id="toc-audience">Audience<span></span></a></li>
<li><a href="preface.html#requisites" id="toc-requisites">Requisites<span></span></a></li>
<li><a href="preface.html#words-of-appreciation" id="toc-words-of-appreciation">Words of Appreciation<span></span></a></li>
<li><a href="preface.html#versioning" id="toc-versioning">Versioning<span></span></a></li>
</ul></li>
<li><a href="#part-part-i-getting-to-know-the-technology" id="toc-part-part-i-getting-to-know-the-technology">(PART) Part I: Getting to Know the Technology<span></span></a></li>
<li><a href="preliminaries.html#preliminaries" id="toc-preliminaries"><span class="toc-section-number">1</span> Preliminaries: Installing <code>R</code> and RStudio<span></span></a>
<ul>
<li><a href="preliminaries.html#introduction" id="toc-introduction"><span class="toc-section-number">1.1</span> Introduction<span></span></a></li>
<li><a href="preliminaries.html#learning-objectives" id="toc-learning-objectives"><span class="toc-section-number">1.2</span> Learning Objectives<span></span></a></li>
<li><a href="preliminaries.html#r-the-open-statistical-computing-project" id="toc-r-the-open-statistical-computing-project"><span class="toc-section-number">1.3</span> <code>R</code>: The Open Statistical Computing Project<span></span></a>
<ul>
<li><a href="preliminaries.html#what-is-r" id="toc-what-is-r"><span class="toc-section-number">1.3.1</span> What is <code>R</code>?<span></span></a></li>
<li><a href="preliminaries.html#the-rstudio-ide" id="toc-the-rstudio-ide"><span class="toc-section-number">1.3.2</span> The RStudio IDE<span></span></a></li>
</ul></li>
<li><a href="preliminaries.html#packages-in-r" id="toc-packages-in-r"><span class="toc-section-number">1.4</span> Packages in R<span></span></a></li>
</ul></li>
<li><a href="basic-operations.html#basic-operations" id="toc-basic-operations"><span class="toc-section-number">2</span> Basic Operations and Data Structures in <code>R</code><span></span></a>
<ul>
<li><a href="basic-operations.html#learning-objectives-1" id="toc-learning-objectives-1"><span class="toc-section-number">2.1</span> Learning Objectives<span></span></a></li>
<li><a href="basic-operations.html#rstudio-ide" id="toc-rstudio-ide"><span class="toc-section-number">2.2</span> RStudio IDE<span></span></a></li>
<li><a href="basic-operations.html#some-basic-operations" id="toc-some-basic-operations"><span class="toc-section-number">2.3</span> Some Basic Operations<span></span></a></li>
<li><a href="basic-operations.html#data-classes-in-r" id="toc-data-classes-in-r"><span class="toc-section-number">2.4</span> Data Classes in R<span></span></a></li>
<li><a href="basic-operations.html#data-types-in-r" id="toc-data-types-in-r"><span class="toc-section-number">2.5</span> Data Types in R<span></span></a></li>
<li><a href="basic-operations.html#indexing-and-data-transformations" id="toc-indexing-and-data-transformations"><span class="toc-section-number">2.6</span> Indexing and Data Transformations<span></span></a></li>
<li><a href="basic-operations.html#visualization" id="toc-visualization"><span class="toc-section-number">2.7</span> Visualization<span></span></a></li>
<li><a href="basic-operations.html#creating-a-simple-map" id="toc-creating-a-simple-map"><span class="toc-section-number">2.8</span> Creating a Simple Map<span></span></a></li>
<li><a href="basic-operations.html#examples-of-digital-cartography-in-r" id="toc-examples-of-digital-cartography-in-r"><span class="toc-section-number">2.9</span> Examples of digital cartography in <code>R</code><span></span></a></li>
<li><a href="basic-operations.html#references" id="toc-references"><span class="toc-section-number">2.10</span> References<span></span></a></li>
</ul></li>
<li><a href="#part-part-ii-statistics-and-maps" id="toc-part-part-ii-statistics-and-maps">(PART) Part II: Statistics and Maps<span></span></a></li>
<li><a href="introduction-to-maps.html#introduction-to-maps" id="toc-introduction-to-maps"><span class="toc-section-number">3</span> Introduction to Mapping in <code>R</code><span></span></a>
<ul>
<li><a href="introduction-to-maps.html#learning-objectives-2" id="toc-learning-objectives-2"><span class="toc-section-number">3.1</span> Learning Objectives<span></span></a></li>
<li><a href="introduction-to-maps.html#suggested-readings" id="toc-suggested-readings"><span class="toc-section-number">3.2</span> Suggested Readings<span></span></a></li>
<li><a href="introduction-to-maps.html#preliminaries-1" id="toc-preliminaries-1"><span class="toc-section-number">3.3</span> Preliminaries<span></span></a></li>
<li><a href="introduction-to-maps.html#packages" id="toc-packages"><span class="toc-section-number">3.4</span> Packages<span></span></a></li>
<li><a href="introduction-to-maps.html#exploring-dataframes-and-a-simple-proportional-symbols-map" id="toc-exploring-dataframes-and-a-simple-proportional-symbols-map"><span class="toc-section-number">3.5</span> Exploring Dataframes and a Simple Proportional Symbols Map<span></span></a></li>
<li><a href="introduction-to-maps.html#improving-on-the-proportional-symbols-map" id="toc-improving-on-the-proportional-symbols-map"><span class="toc-section-number">3.6</span> Improving on the Proportional Symbols Map<span></span></a></li>
<li><a href="introduction-to-maps.html#some-simple-spatial-analysis" id="toc-some-simple-spatial-analysis"><span class="toc-section-number">3.7</span> Some Simple Spatial Analysis<span></span></a></li>
<li><a href="introduction-to-maps.html#other-resources" id="toc-other-resources"><span class="toc-section-number">3.8</span> Other Resources<span></span></a></li>
</ul></li>
<li><a href="activity-statistical-maps-i.html#activity-statistical-maps-i" id="toc-activity-statistical-maps-i"><span class="toc-section-number">4</span> Activity: Statistical Maps I<span></span></a>
<ul>
<li><a href="activity-statistical-maps-i.html#housekeeping-questions" id="toc-housekeeping-questions"><span class="toc-section-number">4.1</span> Housekeeping Questions<span></span></a></li>
<li><a href="activity-statistical-maps-i.html#learning-objectives-3" id="toc-learning-objectives-3"><span class="toc-section-number">4.2</span> Learning Objectives<span></span></a></li>
<li><a href="activity-statistical-maps-i.html#preliminaries-2" id="toc-preliminaries-2"><span class="toc-section-number">4.3</span> Preliminaries<span></span></a></li>
<li><a href="activity-statistical-maps-i.html#creating-a-simple-thematic-map" id="toc-creating-a-simple-thematic-map"><span class="toc-section-number">4.4</span> Creating a simple thematic map<span></span></a></li>
<li><a href="activity-statistical-maps-i.html#activity" id="toc-activity"><span class="toc-section-number">4.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="mapping-continued.html#mapping-continued" id="toc-mapping-continued"><span class="toc-section-number">5</span> Mapping in R: Continued<span></span></a>
<ul>
<li><a href="mapping-continued.html#learning-objectives-4" id="toc-learning-objectives-4"><span class="toc-section-number">5.1</span> Learning Objectives<span></span></a></li>
<li><a href="mapping-continued.html#suggested-readings-1" id="toc-suggested-readings-1"><span class="toc-section-number">5.2</span> Suggested Readings<span></span></a></li>
<li><a href="mapping-continued.html#preliminaries-3" id="toc-preliminaries-3"><span class="toc-section-number">5.3</span> Preliminaries<span></span></a></li>
<li><a href="mapping-continued.html#summarizing-a-dataframe" id="toc-summarizing-a-dataframe"><span class="toc-section-number">5.4</span> Summarizing a Dataframe<span></span></a></li>
<li><a href="mapping-continued.html#factors" id="toc-factors"><span class="toc-section-number">5.5</span> Factors<span></span></a></li>
<li><a href="mapping-continued.html#subsetting-data" id="toc-subsetting-data"><span class="toc-section-number">5.6</span> Subsetting Data<span></span></a></li>
<li><a href="mapping-continued.html#pipe-operator" id="toc-pipe-operator"><span class="toc-section-number">5.7</span> Pipe Operator<span></span></a></li>
<li><a href="mapping-continued.html#more-on-visualization" id="toc-more-on-visualization"><span class="toc-section-number">5.8</span> More on Visualization<span></span></a></li>
</ul></li>
<li><a href="activity-2-statistical-maps-ii.html#activity-2-statistical-maps-ii" id="toc-activity-2-statistical-maps-ii"><span class="toc-section-number">6</span> Activity 2: Statistical Maps II<span></span></a>
<ul>
<li><a href="activity-2-statistical-maps-ii.html#housekeeping-questions-1" id="toc-housekeeping-questions-1"><span class="toc-section-number">6.1</span> Housekeeping Questions<span></span></a></li>
<li><a href="activity-2-statistical-maps-ii.html#learning-objectives-5" id="toc-learning-objectives-5"><span class="toc-section-number">6.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-2-statistical-maps-ii.html#suggested-reading" id="toc-suggested-reading"><span class="toc-section-number">6.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-2-statistical-maps-ii.html#preliminaries-4" id="toc-preliminaries-4"><span class="toc-section-number">6.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-2-statistical-maps-ii.html#activity-1" id="toc-activity-1"><span class="toc-section-number">6.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="maps-as-processes.html#maps-as-processes" id="toc-maps-as-processes"><span class="toc-section-number">7</span> Maps as Processes: Null Landscapes, Spatial Processes, and Statistical Maps<span></span></a>
<ul>
<li><a href="maps-as-processes.html#learning-objectives-6" id="toc-learning-objectives-6"><span class="toc-section-number">7.1</span> Learning Objectives<span></span></a></li>
<li><a href="maps-as-processes.html#suggested-readings-2" id="toc-suggested-readings-2"><span class="toc-section-number">7.2</span> Suggested Readings<span></span></a></li>
<li><a href="maps-as-processes.html#preliminaries-5" id="toc-preliminaries-5"><span class="toc-section-number">7.3</span> Preliminaries<span></span></a></li>
<li><a href="maps-as-processes.html#random-numbers" id="toc-random-numbers"><span class="toc-section-number">7.4</span> Random Numbers<span></span></a></li>
<li><a href="maps-as-processes.html#null-landscapes" id="toc-null-landscapes"><span class="toc-section-number">7.5</span> Null Landscapes<span></span></a></li>
<li><a href="maps-as-processes.html#stochastic-processes" id="toc-stochastic-processes"><span class="toc-section-number">7.6</span> Stochastic Processes<span></span></a></li>
<li><a href="maps-as-processes.html#simulating-spatial-processes" id="toc-simulating-spatial-processes"><span class="toc-section-number">7.7</span> Simulating Spatial Processes<span></span></a></li>
<li><a href="maps-as-processes.html#processes-and-patterns" id="toc-processes-and-patterns"><span class="toc-section-number">7.8</span> Processes and Patterns<span></span></a></li>
</ul></li>
<li><a href="activity-3-maps-as-processes.html#activity-3-maps-as-processes" id="toc-activity-3-maps-as-processes"><span class="toc-section-number">8</span> Activity 3: Maps as Processes<span></span></a>
<ul>
<li><a href="activity-3-maps-as-processes.html#practice-questions" id="toc-practice-questions"><span class="toc-section-number">8.1</span> Practice Questions<span></span></a></li>
<li><a href="activity-3-maps-as-processes.html#learning-objectives-7" id="toc-learning-objectives-7"><span class="toc-section-number">8.2</span> Learning Objectives<span></span></a></li>
<li><a href="activity-3-maps-as-processes.html#suggested-reading-1" id="toc-suggested-reading-1"><span class="toc-section-number">8.3</span> Suggested Reading<span></span></a></li>
<li><a href="activity-3-maps-as-processes.html#preliminaries-6" id="toc-preliminaries-6"><span class="toc-section-number">8.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-3-maps-as-processes.html#activity-2" id="toc-activity-2"><span class="toc-section-number">8.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="#part-part-iii-analysis-of-point-patterns" id="toc-part-part-iii-analysis-of-point-patterns">(PART) Part III: Analysis of Point Patterns<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#point-pattern-analysis-i" id="toc-point-pattern-analysis-i"><span class="toc-section-number">9</span> Point Pattern Analysis I<span></span></a>
<ul>
<li><a href="point-pattern-analysis-i.html#learning-objectives-8" id="toc-learning-objectives-8"><span class="toc-section-number">9.1</span> Learning Objectives<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#suggested-readings-3" id="toc-suggested-readings-3"><span class="toc-section-number">9.2</span> Suggested Readings<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#preliminaries-7" id="toc-preliminaries-7"><span class="toc-section-number">9.3</span> Preliminaries<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#point-patterns" id="toc-point-patterns"><span class="toc-section-number">9.4</span> Point Patterns<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#processes-and-point-patterns" id="toc-processes-and-point-patterns"><span class="toc-section-number">9.5</span> Processes and Point Patterns<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#intensity-and-density" id="toc-intensity-and-density"><span class="toc-section-number">9.6</span> Intensity and Density<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#quadrats-and-density-maps" id="toc-quadrats-and-density-maps"><span class="toc-section-number">9.7</span> Quadrats and Density Maps<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#defining-the-region-for-analysis" id="toc-defining-the-region-for-analysis"><span class="toc-section-number">9.8</span> Defining the Region for Analysis<span></span></a></li>
</ul></li>
<li><a href="activity-4-point-pattern-analysis-i.html#activity-4-point-pattern-analysis-i" id="toc-activity-4-point-pattern-analysis-i"><span class="toc-section-number">10</span> Activity 4: Point Pattern Analysis I<span></span></a>
<ul>
<li><a href="activity-4-point-pattern-analysis-i.html#practice-questions-1" id="toc-practice-questions-1"><span class="toc-section-number">10.1</span> Practice questions<span></span></a></li>
<li><a href="activity-4-point-pattern-analysis-i.html#learning-objectives-9" id="toc-learning-objectives-9"><span class="toc-section-number">10.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-4-point-pattern-analysis-i.html#suggested-reading-2" id="toc-suggested-reading-2"><span class="toc-section-number">10.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-4-point-pattern-analysis-i.html#preliminaries-8" id="toc-preliminaries-8"><span class="toc-section-number">10.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-4-point-pattern-analysis-i.html#activity-3" id="toc-activity-3"><span class="toc-section-number">10.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="point-patern-analysis-ii.html#point-patern-analysis-ii" id="toc-point-patern-analysis-ii"><span class="toc-section-number">11</span> Point Pattern Analysis II<span></span></a>
<ul>
<li><a href="point-patern-analysis-ii.html#learning-objectives-10" id="toc-learning-objectives-10"><span class="toc-section-number">11.1</span> Learning Objectives<span></span></a></li>
<li><a href="point-patern-analysis-ii.html#suggested-readings-4" id="toc-suggested-readings-4"><span class="toc-section-number">11.2</span> Suggested Readings<span></span></a></li>
<li><a href="point-patern-analysis-ii.html#preliminaries-9" id="toc-preliminaries-9"><span class="toc-section-number">11.3</span> Preliminaries<span></span></a></li>
<li><a href="point-patern-analysis-ii.html#a-quadrat-based-test-for-spatial-independence" id="toc-a-quadrat-based-test-for-spatial-independence"><span class="toc-section-number">11.4</span> A Quadrat-based Test for Spatial Independence<span></span></a></li>
<li><a href="point-patern-analysis-ii.html#limitations-of-quadrat-analysis-size-and-number-of-quadrats" id="toc-limitations-of-quadrat-analysis-size-and-number-of-quadrats"><span class="toc-section-number">11.5</span> Limitations of Quadrat Analysis: Size and Number of Quadrats<span></span></a></li>
<li><a href="point-patern-analysis-ii.html#limitations-of-quadrat-analysis-relative-position-of-events" id="toc-limitations-of-quadrat-analysis-relative-position-of-events"><span class="toc-section-number">11.6</span> Limitations of Quadrat Analysis: Relative Position of Events<span></span></a></li>
<li><a href="point-patern-analysis-ii.html#kernel-density" id="toc-kernel-density"><span class="toc-section-number">11.7</span> Kernel Density<span></span></a></li>
</ul></li>
<li><a href="activity-5-point-pattern-analysis-ii.html#activity-5-point-pattern-analysis-ii" id="toc-activity-5-point-pattern-analysis-ii"><span class="toc-section-number">12</span> Activity 5: Point Pattern Analysis II<span></span></a>
<ul>
<li><a href="activity-5-point-pattern-analysis-ii.html#practice-questions-2" id="toc-practice-questions-2"><span class="toc-section-number">12.1</span> Practice questions<span></span></a></li>
<li><a href="activity-5-point-pattern-analysis-ii.html#learning-objectives-11" id="toc-learning-objectives-11"><span class="toc-section-number">12.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-5-point-pattern-analysis-ii.html#suggested-reading-3" id="toc-suggested-reading-3"><span class="toc-section-number">12.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-5-point-pattern-analysis-ii.html#preliminaries-10" id="toc-preliminaries-10"><span class="toc-section-number">12.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-5-point-pattern-analysis-ii.html#activity-4" id="toc-activity-4"><span class="toc-section-number">12.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="point-pattern-analysis-iii.html#point-pattern-analysis-iii" id="toc-point-pattern-analysis-iii"><span class="toc-section-number">13</span> Point Pattern Analysis III<span></span></a>
<ul>
<li><a href="point-pattern-analysis-iii.html#learning-objectives-12" id="toc-learning-objectives-12"><span class="toc-section-number">13.1</span> Learning Objectives<span></span></a></li>
<li><a href="point-pattern-analysis-iii.html#suggested-readings-5" id="toc-suggested-readings-5"><span class="toc-section-number">13.2</span> Suggested Readings<span></span></a></li>
<li><a href="point-pattern-analysis-iii.html#preliminaries-11" id="toc-preliminaries-11"><span class="toc-section-number">13.3</span> Preliminaries<span></span></a></li>
<li><a href="point-pattern-analysis-iii.html#motivation" id="toc-motivation"><span class="toc-section-number">13.4</span> Motivation<span></span></a></li>
<li><a href="point-pattern-analysis-iii.html#nearest-neighbors" id="toc-nearest-neighbors"><span class="toc-section-number">13.5</span> Nearest Neighbors<span></span></a></li>
<li><a href="point-pattern-analysis-iii.html#g-function" id="toc-g-function"><span class="toc-section-number">13.6</span> <span class="math inline">\(G\)</span>-function<span></span></a></li>
</ul></li>
<li><a href="activity-6-point-pattern-analysis-iii.html#activity-6-point-pattern-analysis-iii" id="toc-activity-6-point-pattern-analysis-iii"><span class="toc-section-number">14</span> Activity 6: Point Pattern Analysis III<span></span></a>
<ul>
<li><a href="activity-6-point-pattern-analysis-iii.html#practice-questions-3" id="toc-practice-questions-3"><span class="toc-section-number">14.1</span> Practice questions<span></span></a></li>
<li><a href="activity-6-point-pattern-analysis-iii.html#learning-objectives-13" id="toc-learning-objectives-13"><span class="toc-section-number">14.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-6-point-pattern-analysis-iii.html#suggested-reading-4" id="toc-suggested-reading-4"><span class="toc-section-number">14.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-6-point-pattern-analysis-iii.html#preliminaries-12" id="toc-preliminaries-12"><span class="toc-section-number">14.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-6-point-pattern-analysis-iii.html#activity-5" id="toc-activity-5"><span class="toc-section-number">14.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="point-pattern-analysis-iv.html#point-pattern-analysis-iv" id="toc-point-pattern-analysis-iv"><span class="toc-section-number">15</span> Point Pattern Analysis IV<span></span></a>
<ul>
<li><a href="point-pattern-analysis-iv.html#learning-objectives-14" id="toc-learning-objectives-14"><span class="toc-section-number">15.1</span> Learning Objectives<span></span></a></li>
<li><a href="point-pattern-analysis-iv.html#suggested-readings-6" id="toc-suggested-readings-6"><span class="toc-section-number">15.2</span> Suggested Readings<span></span></a></li>
<li><a href="point-pattern-analysis-iv.html#preliminaries-13" id="toc-preliminaries-13"><span class="toc-section-number">15.3</span> Preliminaries<span></span></a></li>
<li><a href="point-pattern-analysis-iv.html#motivation-1" id="toc-motivation-1"><span class="toc-section-number">15.4</span> Motivation<span></span></a></li>
<li><a href="point-pattern-analysis-iv.html#f-function" id="toc-f-function"><span class="toc-section-number">15.5</span> F-function<span></span></a></li>
<li><a href="point-pattern-analysis-iv.html#hatk-function" id="toc-hatk-function"><span class="toc-section-number">15.6</span> <span class="math inline">\(\hat{K}\)</span>-function<span></span></a></li>
</ul></li>
<li><a href="activity-7-point-pattern-analysis-iv.html#activity-7-point-pattern-analysis-iv" id="toc-activity-7-point-pattern-analysis-iv"><span class="toc-section-number">16</span> Activity 7: Point Pattern Analysis IV<span></span></a>
<ul>
<li><a href="activity-7-point-pattern-analysis-iv.html#practice-questions-4" id="toc-practice-questions-4"><span class="toc-section-number">16.1</span> Practice questions<span></span></a></li>
<li><a href="activity-7-point-pattern-analysis-iv.html#learning-objectives-15" id="toc-learning-objectives-15"><span class="toc-section-number">16.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-7-point-pattern-analysis-iv.html#suggested-reading-5" id="toc-suggested-reading-5"><span class="toc-section-number">16.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-7-point-pattern-analysis-iv.html#preliminaries-14" id="toc-preliminaries-14"><span class="toc-section-number">16.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-7-point-pattern-analysis-iv.html#activity-6" id="toc-activity-6"><span class="toc-section-number">16.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="point-pattern-analysis-v.html#point-pattern-analysis-v" id="toc-point-pattern-analysis-v"><span class="toc-section-number">17</span> Point Pattern Analysis V<span></span></a>
<ul>
<li><a href="point-pattern-analysis-v.html#learning-objectives-16" id="toc-learning-objectives-16"><span class="toc-section-number">17.1</span> Learning Objectives<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#suggested-readings-7" id="toc-suggested-readings-7"><span class="toc-section-number">17.2</span> Suggested Readings<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#preliminaries-15" id="toc-preliminaries-15"><span class="toc-section-number">17.3</span> Preliminaries<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#motivation-hypothesis-testing" id="toc-motivation-hypothesis-testing"><span class="toc-section-number">17.4</span> Motivation: Hypothesis Testing<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#null-landscapes-revisited" id="toc-null-landscapes-revisited"><span class="toc-section-number">17.5</span> Null Landscapes Revisited<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#simulation-envelopes" id="toc-simulation-envelopes"><span class="toc-section-number">17.6</span> Simulation Envelopes<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#things-to-keep-in-mind" id="toc-things-to-keep-in-mind"><span class="toc-section-number">17.7</span> Things to Keep in Mind!<span></span></a>
<ul>
<li><a href="point-pattern-analysis-v.html#definition-of-a-region" id="toc-definition-of-a-region"><span class="toc-section-number">17.7.1</span> Definition of a Region<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#edge-effects" id="toc-edge-effects"><span class="toc-section-number">17.7.2</span> Edge Effects<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#sampled-point-patterns" id="toc-sampled-point-patterns"><span class="toc-section-number">17.7.3</span> Sampled Point Patterns<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="activity-8-point-pattern-analysis-v.html#activity-8-point-pattern-analysis-v" id="toc-activity-8-point-pattern-analysis-v"><span class="toc-section-number">18</span> Activity 8: Point Pattern Analysis V<span></span></a>
<ul>
<li><a href="activity-8-point-pattern-analysis-v.html#practice-questions-5" id="toc-practice-questions-5"><span class="toc-section-number">18.1</span> Practice questions<span></span></a></li>
<li><a href="activity-8-point-pattern-analysis-v.html#learning-objectives-17" id="toc-learning-objectives-17"><span class="toc-section-number">18.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-8-point-pattern-analysis-v.html#suggested-reading-6" id="toc-suggested-reading-6"><span class="toc-section-number">18.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-8-point-pattern-analysis-v.html#preliminaries-16" id="toc-preliminaries-16"><span class="toc-section-number">18.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-8-point-pattern-analysis-v.html#activity-7" id="toc-activity-7"><span class="toc-section-number">18.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="#part-part-iv-data-in-areal-units" id="toc-part-part-iv-data-in-areal-units">(PART) Part IV: Data in Areal Units<span></span></a></li>
<li><a href="area-data-i.html#area-data-i" id="toc-area-data-i"><span class="toc-section-number">19</span> Area Data I<span></span></a>
<ul>
<li><a href="area-data-i.html#learning-objectives-18" id="toc-learning-objectives-18"><span class="toc-section-number">19.1</span> Learning Objectives<span></span></a></li>
<li><a href="area-data-i.html#suggested-readings-8" id="toc-suggested-readings-8"><span class="toc-section-number">19.2</span> Suggested Readings<span></span></a></li>
<li><a href="area-data-i.html#preliminaries-17" id="toc-preliminaries-17"><span class="toc-section-number">19.3</span> Preliminaries<span></span></a></li>
<li><a href="area-data-i.html#area-data" id="toc-area-data"><span class="toc-section-number">19.4</span> Area Data<span></span></a></li>
<li><a href="area-data-i.html#processes-and-area-data" id="toc-processes-and-area-data"><span class="toc-section-number">19.5</span> Processes and Area Data<span></span></a></li>
<li><a href="area-data-i.html#visualizing-area-data-choropleth-maps" id="toc-visualizing-area-data-choropleth-maps"><span class="toc-section-number">19.6</span> Visualizing Area Data: Choropleth Maps<span></span></a></li>
<li><a href="area-data-i.html#visualizing-area-data-cartograms" id="toc-visualizing-area-data-cartograms"><span class="toc-section-number">19.7</span> Visualizing Area Data: Cartograms<span></span></a></li>
</ul></li>
<li><a href="activity-9-area-data-i.html#activity-9-area-data-i" id="toc-activity-9-area-data-i"><span class="toc-section-number">20</span> Activity 9: Area Data I<span></span></a>
<ul>
<li><a href="activity-9-area-data-i.html#practice-questions-6" id="toc-practice-questions-6"><span class="toc-section-number">20.1</span> Practice questions<span></span></a></li>
<li><a href="activity-9-area-data-i.html#learning-objectives-19" id="toc-learning-objectives-19"><span class="toc-section-number">20.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-9-area-data-i.html#suggested-reading-7" id="toc-suggested-reading-7"><span class="toc-section-number">20.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-9-area-data-i.html#preliminaries-18" id="toc-preliminaries-18"><span class="toc-section-number">20.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-9-area-data-i.html#activity-8" id="toc-activity-8"><span class="toc-section-number">20.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="area-data-ii.html#area-data-ii" id="toc-area-data-ii"><span class="toc-section-number">21</span> Area Data II<span></span></a>
<ul>
<li><a href="area-data-ii.html#learning-objectives-20" id="toc-learning-objectives-20"><span class="toc-section-number">21.1</span> Learning Objectives<span></span></a></li>
<li><a href="area-data-ii.html#suggested-readings-9" id="toc-suggested-readings-9"><span class="toc-section-number">21.2</span> Suggested Readings<span></span></a></li>
<li><a href="area-data-ii.html#preliminaries-19" id="toc-preliminaries-19"><span class="toc-section-number">21.3</span> Preliminaries<span></span></a></li>
<li><a href="area-data-ii.html#proximity-in-area-data" id="toc-proximity-in-area-data"><span class="toc-section-number">21.4</span> Proximity in Area Data<span></span></a></li>
<li><a href="area-data-ii.html#spatial-weights-matrices" id="toc-spatial-weights-matrices"><span class="toc-section-number">21.5</span> Spatial Weights Matrices<span></span></a></li>
<li><a href="area-data-ii.html#creating-spatial-weights-matrices-in-r" id="toc-creating-spatial-weights-matrices-in-r"><span class="toc-section-number">21.6</span> Creating Spatial Weights Matrices in <code>R</code><span></span></a></li>
<li><a href="area-data-ii.html#spatial-moving-averages" id="toc-spatial-moving-averages"><span class="toc-section-number">21.7</span> Spatial Moving Averages<span></span></a></li>
<li><a href="area-data-ii.html#other-criteria-for-coding-proximity" id="toc-other-criteria-for-coding-proximity"><span class="toc-section-number">21.8</span> Other Criteria for Coding Proximity<span></span></a></li>
</ul></li>
<li><a href="activity-10-area-data-ii.html#activity-10-area-data-ii" id="toc-activity-10-area-data-ii"><span class="toc-section-number">22</span> Activity 10: Area Data II<span></span></a>
<ul>
<li><a href="activity-10-area-data-ii.html#practice-questions-7" id="toc-practice-questions-7"><span class="toc-section-number">22.1</span> Practice questions<span></span></a></li>
<li><a href="activity-10-area-data-ii.html#learning-objectives-21" id="toc-learning-objectives-21"><span class="toc-section-number">22.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-10-area-data-ii.html#suggested-reading-8" id="toc-suggested-reading-8"><span class="toc-section-number">22.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-10-area-data-ii.html#preliminaries-20" id="toc-preliminaries-20"><span class="toc-section-number">22.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-10-area-data-ii.html#activity-9" id="toc-activity-9"><span class="toc-section-number">22.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="area-data-iii.html#area-data-iii" id="toc-area-data-iii"><span class="toc-section-number">23</span> Area Data III<span></span></a>
<ul>
<li><a href="area-data-iii.html#learning-objectives-22" id="toc-learning-objectives-22"><span class="toc-section-number">23.1</span> Learning Objectives<span></span></a></li>
<li><a href="area-data-iii.html#suggested-readings-10" id="toc-suggested-readings-10"><span class="toc-section-number">23.2</span> Suggested Readings<span></span></a></li>
<li><a href="area-data-iii.html#preliminaries-21" id="toc-preliminaries-21"><span class="toc-section-number">23.3</span> Preliminaries<span></span></a></li>
<li><a href="area-data-iii.html#spatial-moving-averages-and-simulation" id="toc-spatial-moving-averages-and-simulation"><span class="toc-section-number">23.4</span> Spatial Moving Averages and Simulation<span></span></a></li>
<li><a href="area-data-iii.html#the-spatial-moving-average-as-a-smoother" id="toc-the-spatial-moving-average-as-a-smoother"><span class="toc-section-number">23.5</span> The Spatial Moving Average as a Smoother<span></span></a></li>
<li><a href="area-data-iii.html#spatial-moving-average-scatterplots" id="toc-spatial-moving-average-scatterplots"><span class="toc-section-number">23.6</span> Spatial Moving Average Scatterplots<span></span></a></li>
<li><a href="area-data-iii.html#spatial-autocorrelation-and-morans-i-coefficient" id="toc-spatial-autocorrelation-and-morans-i-coefficient"><span class="toc-section-number">23.7</span> Spatial Autocorrelation and Moran’s <span class="math inline">\(I\)</span> coefficient<span></span></a></li>
<li><a href="area-data-iii.html#morans-i-and-morans-scatterplot" id="toc-morans-i-and-morans-scatterplot"><span class="toc-section-number">23.8</span> Moran’s <span class="math inline">\(I\)</span> and Moran’s Scatterplot<span></span></a></li>
<li><a href="area-data-iii.html#hypothesis-testing-for-spatial-autocorrelation" id="toc-hypothesis-testing-for-spatial-autocorrelation"><span class="toc-section-number">23.9</span> Hypothesis Testing for Spatial Autocorrelation<span></span></a></li>
</ul></li>
<li><a href="activity-11-area-data-iii.html#activity-11-area-data-iii" id="toc-activity-11-area-data-iii"><span class="toc-section-number">24</span> Activity 11: Area Data III<span></span></a>
<ul>
<li><a href="activity-11-area-data-iii.html#practice-questions-8" id="toc-practice-questions-8"><span class="toc-section-number">24.1</span> Practice questions<span></span></a></li>
<li><a href="activity-11-area-data-iii.html#learning-objectives-23" id="toc-learning-objectives-23"><span class="toc-section-number">24.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-11-area-data-iii.html#suggested-reading-9" id="toc-suggested-reading-9"><span class="toc-section-number">24.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-11-area-data-iii.html#preliminaries-22" id="toc-preliminaries-22"><span class="toc-section-number">24.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-11-area-data-iii.html#activity-10" id="toc-activity-10"><span class="toc-section-number">24.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="area-data-iv.html#area-data-iv" id="toc-area-data-iv"><span class="toc-section-number">25</span> Area Data IV<span></span></a>
<ul>
<li><a href="area-data-iv.html#learning-objectives-24" id="toc-learning-objectives-24"><span class="toc-section-number">25.1</span> Learning objectives<span></span></a></li>
<li><a href="area-data-iv.html#suggested-readings-11" id="toc-suggested-readings-11"><span class="toc-section-number">25.2</span> Suggested readings<span></span></a></li>
<li><a href="area-data-iv.html#preliminaries-23" id="toc-preliminaries-23"><span class="toc-section-number">25.3</span> Preliminaries<span></span></a></li>
<li><a href="area-data-iv.html#decomposing-morans-i" id="toc-decomposing-morans-i"><span class="toc-section-number">25.4</span> Decomposing Moran’s <span class="math inline">\(I\)</span><span></span></a></li>
<li><a href="area-data-iv.html#local-morans-i-and-mapping" id="toc-local-morans-i-and-mapping"><span class="toc-section-number">25.5</span> Local Moran’s <span class="math inline">\(I\)</span> and Mapping<span></span></a></li>
<li><a href="area-data-iv.html#a-quick-note-on-functions" id="toc-a-quick-note-on-functions"><span class="toc-section-number">25.6</span> A Quick Note on Functions<span></span></a></li>
<li><a href="area-data-iv.html#a-concentration-approach-for-local-analysis-of-spatial-association" id="toc-a-concentration-approach-for-local-analysis-of-spatial-association"><span class="toc-section-number">25.7</span> A Concentration approach for Local Analysis of Spatial Association<span></span></a></li>
<li><a href="area-data-iv.html#a-short-note-on-hypothesis-testing" id="toc-a-short-note-on-hypothesis-testing"><span class="toc-section-number">25.8</span> A Short Note on Hypothesis Testing<span></span></a></li>
<li><a href="area-data-iv.html#detection-of-hot-and-cold-spots" id="toc-detection-of-hot-and-cold-spots"><span class="toc-section-number">25.9</span> Detection of Hot and Cold Spots<span></span></a></li>
<li><a href="area-data-iv.html#other-resources-1" id="toc-other-resources-1"><span class="toc-section-number">25.10</span> Other Resources<span></span></a></li>
</ul></li>
<li><a href="activity-12-area-data-iv.html#activity-12-area-data-iv" id="toc-activity-12-area-data-iv"><span class="toc-section-number">26</span> Activity 12: Area Data IV<span></span></a>
<ul>
<li><a href="activity-12-area-data-iv.html#practice-questions-9" id="toc-practice-questions-9"><span class="toc-section-number">26.1</span> Practice questions<span></span></a></li>
<li><a href="activity-12-area-data-iv.html#learning-objectives-25" id="toc-learning-objectives-25"><span class="toc-section-number">26.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-12-area-data-iv.html#suggested-reading-10" id="toc-suggested-reading-10"><span class="toc-section-number">26.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-12-area-data-iv.html#preliminaries-24" id="toc-preliminaries-24"><span class="toc-section-number">26.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-12-area-data-iv.html#activity-11" id="toc-activity-11"><span class="toc-section-number">26.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="area-data-v.html#area-data-v" id="toc-area-data-v"><span class="toc-section-number">27</span> Area Data V<span></span></a>
<ul>
<li><a href="area-data-v.html#learning-objectives-26" id="toc-learning-objectives-26"><span class="toc-section-number">27.1</span> Learning Objectives<span></span></a></li>
<li><a href="area-data-v.html#suggested-readings-12" id="toc-suggested-readings-12"><span class="toc-section-number">27.2</span> Suggested Readings<span></span></a></li>
<li><a href="area-data-v.html#preliminaries-25" id="toc-preliminaries-25"><span class="toc-section-number">27.3</span> Preliminaries<span></span></a></li>
<li><a href="area-data-v.html#regression-analysis-in-r" id="toc-regression-analysis-in-r"><span class="toc-section-number">27.4</span> Regression Analysis in <code>R</code><span></span></a></li>
<li><a href="area-data-v.html#autocorrelation-as-a-model-diagnostic" id="toc-autocorrelation-as-a-model-diagnostic"><span class="toc-section-number">27.5</span> Autocorrelation as a Model Diagnostic<span></span></a></li>
<li><a href="area-data-v.html#variable-transformations" id="toc-variable-transformations"><span class="toc-section-number">27.6</span> Variable Transformations<span></span></a></li>
<li><a href="area-data-v.html#a-note-about-spatial-autocorrelation-in-regression-analysis" id="toc-a-note-about-spatial-autocorrelation-in-regression-analysis"><span class="toc-section-number">27.7</span> A Note about Spatial Autocorrelation in Regression Analysis<span></span></a></li>
</ul></li>
<li><a href="activity-13-area-data-v.html#activity-13-area-data-v" id="toc-activity-13-area-data-v"><span class="toc-section-number">28</span> Activity 13: Area Data V<span></span></a>
<ul>
<li><a href="activity-13-area-data-v.html#practice-questions-10" id="toc-practice-questions-10"><span class="toc-section-number">28.1</span> Practice questions<span></span></a></li>
<li><a href="activity-13-area-data-v.html#learning-objectives-27" id="toc-learning-objectives-27"><span class="toc-section-number">28.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-13-area-data-v.html#suggested-reading-11" id="toc-suggested-reading-11"><span class="toc-section-number">28.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-13-area-data-v.html#preliminaries-26" id="toc-preliminaries-26"><span class="toc-section-number">28.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-13-area-data-v.html#activity-12" id="toc-activity-12"><span class="toc-section-number">28.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="area-data-vi.html#area-data-vi" id="toc-area-data-vi"><span class="toc-section-number">29</span> Area Data VI<span></span></a>
<ul>
<li><a href="area-data-vi.html#learning-objectives-28" id="toc-learning-objectives-28"><span class="toc-section-number">29.1</span> Learning Objectives<span></span></a></li>
<li><a href="area-data-vi.html#suggested-readings-13" id="toc-suggested-readings-13"><span class="toc-section-number">29.2</span> Suggested Readings<span></span></a></li>
<li><a href="area-data-vi.html#preliminaries-27" id="toc-preliminaries-27"><span class="toc-section-number">29.3</span> Preliminaries<span></span></a></li>
<li><a href="area-data-vi.html#residual-spatial-autocorrelation-revisited" id="toc-residual-spatial-autocorrelation-revisited"><span class="toc-section-number">29.4</span> Residual spatial autocorrelation revisited<span></span></a>
<ul>
<li><a href="area-data-vi.html#incorrect-functional-form" id="toc-incorrect-functional-form"><span class="toc-section-number">29.4.1</span> Incorrect Functional Form<span></span></a></li>
<li><a href="area-data-vi.html#omitted-variables" id="toc-omitted-variables"><span class="toc-section-number">29.4.2</span> Omitted Variables<span></span></a></li>
</ul></li>
<li><a href="area-data-vi.html#remedial-action" id="toc-remedial-action"><span class="toc-section-number">29.5</span> Remedial Action<span></span></a></li>
<li><a href="area-data-vi.html#flexible-functional-forms-and-models-with-spatially-varying-coefficients" id="toc-flexible-functional-forms-and-models-with-spatially-varying-coefficients"><span class="toc-section-number">29.6</span> Flexible Functional Forms and Models with Spatially-varying Coefficients<span></span></a>
<ul>
<li><a href="area-data-vi.html#trend-surface-analysis" id="toc-trend-surface-analysis"><span class="toc-section-number">29.6.1</span> Trend Surface Analysis<span></span></a></li>
<li><a href="area-data-vi.html#models-with-spatially-varying-coefficients" id="toc-models-with-spatially-varying-coefficients"><span class="toc-section-number">29.6.2</span> Models with Spatially-varying Coefficients<span></span></a></li>
</ul></li>
<li><a href="area-data-vi.html#spatial-error-model-sem" id="toc-spatial-error-model-sem"><span class="toc-section-number">29.7</span> Spatial Error Model (SEM)<span></span></a></li>
</ul></li>
<li><a href="activity-14-area-data-vi.html#activity-14-area-data-vi" id="toc-activity-14-area-data-vi"><span class="toc-section-number">30</span> Activity 14: Area Data VI<span></span></a>
<ul>
<li><a href="activity-14-area-data-vi.html#practice-questions-11" id="toc-practice-questions-11"><span class="toc-section-number">30.1</span> Practice questions<span></span></a></li>
<li><a href="activity-14-area-data-vi.html#learning-objectives-29" id="toc-learning-objectives-29"><span class="toc-section-number">30.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-14-area-data-vi.html#suggested-reading-12" id="toc-suggested-reading-12"><span class="toc-section-number">30.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-14-area-data-vi.html#preliminaries-28" id="toc-preliminaries-28"><span class="toc-section-number">30.4</span> Preliminaries<span></span></a>
<ul>
<li><a href="activity-14-area-data-vi.html#new-york-leukemia-data" id="toc-new-york-leukemia-data"><span class="toc-section-number">30.4.1</span> New York leukemia data<span></span></a></li>
<li><a href="activity-14-area-data-vi.html#pennsylvania-lung-cancer" id="toc-pennsylvania-lung-cancer"><span class="toc-section-number">30.4.2</span> Pennsylvania lung cancer<span></span></a></li>
</ul></li>
<li><a href="activity-14-area-data-vi.html#activity-13" id="toc-activity-13"><span class="toc-section-number">30.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="#part-part-v-analysis-and-prediction-of-fields" id="toc-part-part-v-analysis-and-prediction-of-fields">(PART) Part V: Analysis and Prediction of Fields<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#spatially-continuous-data-i" id="toc-spatially-continuous-data-i"><span class="toc-section-number">31</span> Spatially Continuous Data I<span></span></a>
<ul>
<li><a href="spatially-continuous-data-i.html#learning-objectives-30" id="toc-learning-objectives-30"><span class="toc-section-number">31.1</span> Learning objectives<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#suggested-readings-14" id="toc-suggested-readings-14"><span class="toc-section-number">31.2</span> Suggested readings<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#preliminaries-29" id="toc-preliminaries-29"><span class="toc-section-number">31.3</span> Preliminaries<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#spatially-continuous-field-data" id="toc-spatially-continuous-field-data"><span class="toc-section-number">31.4</span> Spatially continuous (field) data<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#exploratory-visualization" id="toc-exploratory-visualization"><span class="toc-section-number">31.5</span> Exploratory visualization<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#tile-based-methods" id="toc-tile-based-methods"><span class="toc-section-number">31.6</span> Tile-based methods<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#inverse-distance-weighting-idw" id="toc-inverse-distance-weighting-idw"><span class="toc-section-number">31.7</span> Inverse distance weighting (IDW)<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#k-point-means" id="toc-k-point-means"><span class="toc-section-number">31.8</span> <span class="math inline">\(k\)</span>-point means<span></span></a></li>
</ul></li>
<li><a href="activity-15-spatially-continuous-data-i.html#activity-15-spatially-continuous-data-i" id="toc-activity-15-spatially-continuous-data-i"><span class="toc-section-number">32</span> Activity 15: Spatially Continuous Data I<span></span></a>
<ul>
<li><a href="activity-15-spatially-continuous-data-i.html#practice-questions-12" id="toc-practice-questions-12"><span class="toc-section-number">32.1</span> Practice questions<span></span></a></li>
<li><a href="activity-15-spatially-continuous-data-i.html#learning-objectives-31" id="toc-learning-objectives-31"><span class="toc-section-number">32.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-15-spatially-continuous-data-i.html#suggested-reading-13" id="toc-suggested-reading-13"><span class="toc-section-number">32.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-15-spatially-continuous-data-i.html#preliminaries-30" id="toc-preliminaries-30"><span class="toc-section-number">32.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-15-spatially-continuous-data-i.html#activity-14" id="toc-activity-14"><span class="toc-section-number">32.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="spatially-continuous-data-ii.html#spatially-continuous-data-ii" id="toc-spatially-continuous-data-ii"><span class="toc-section-number">33</span> Spatially Continuous Data II<span></span></a>
<ul>
<li><a href="spatially-continuous-data-ii.html#learning-objectives-32" id="toc-learning-objectives-32"><span class="toc-section-number">33.1</span> Learning objectives<span></span></a></li>
<li><a href="spatially-continuous-data-ii.html#suggested-readings-15" id="toc-suggested-readings-15"><span class="toc-section-number">33.2</span> Suggested readings<span></span></a></li>
<li><a href="spatially-continuous-data-ii.html#preliminaries-31" id="toc-preliminaries-31"><span class="toc-section-number">33.3</span> Preliminaries<span></span></a></li>
<li><a href="spatially-continuous-data-ii.html#uncertainty-in-the-predictions" id="toc-uncertainty-in-the-predictions"><span class="toc-section-number">33.4</span> Uncertainty in the predictions<span></span></a></li>
<li><a href="spatially-continuous-data-ii.html#trend-surface-analysis-1" id="toc-trend-surface-analysis-1"><span class="toc-section-number">33.5</span> Trend surface analysis<span></span></a></li>
<li><a href="spatially-continuous-data-ii.html#accuracy-and-precision" id="toc-accuracy-and-precision"><span class="toc-section-number">33.6</span> Accuracy and precision<span></span></a></li>
</ul></li>
<li><a href="activity-16-spatially-continuous-data-ii.html#activity-16-spatially-continuous-data-ii" id="toc-activity-16-spatially-continuous-data-ii"><span class="toc-section-number">34</span> Activity 16: Spatially Continuous Data II<span></span></a>
<ul>
<li><a href="activity-16-spatially-continuous-data-ii.html#practice-questions-13" id="toc-practice-questions-13"><span class="toc-section-number">34.1</span> Practice questions<span></span></a></li>
<li><a href="activity-16-spatially-continuous-data-ii.html#learning-objectives-33" id="toc-learning-objectives-33"><span class="toc-section-number">34.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-16-spatially-continuous-data-ii.html#suggested-reading-14" id="toc-suggested-reading-14"><span class="toc-section-number">34.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-16-spatially-continuous-data-ii.html#preliminaries-32" id="toc-preliminaries-32"><span class="toc-section-number">34.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-16-spatially-continuous-data-ii.html#activity-15" id="toc-activity-15"><span class="toc-section-number">34.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="spatially-continuous-data-iii.html#spatially-continuous-data-iii" id="toc-spatially-continuous-data-iii"><span class="toc-section-number">35</span> Spatially Continuous Data III<span></span></a>
<ul>
<li><a href="spatially-continuous-data-iii.html#learning-objectives-34" id="toc-learning-objectives-34"><span class="toc-section-number">35.1</span> Learning objectives<span></span></a></li>
<li><a href="spatially-continuous-data-iii.html#suggested-reading-15" id="toc-suggested-reading-15"><span class="toc-section-number">35.2</span> Suggested reading<span></span></a></li>
<li><a href="spatially-continuous-data-iii.html#preliminaries-33" id="toc-preliminaries-33"><span class="toc-section-number">35.3</span> Preliminaries<span></span></a></li>
<li><a href="spatially-continuous-data-iii.html#residual-spatial-pattern" id="toc-residual-spatial-pattern"><span class="toc-section-number">35.4</span> Residual spatial pattern<span></span></a></li>
<li><a href="spatially-continuous-data-iii.html#measuring-spatial-dependence-in-spatially-continuous-data" id="toc-measuring-spatial-dependence-in-spatially-continuous-data"><span class="toc-section-number">35.5</span> Measuring spatial dependence in spatially continuous data<span></span></a></li>
<li><a href="spatially-continuous-data-iii.html#variographic-analyisis" id="toc-variographic-analyisis"><span class="toc-section-number">35.6</span> Variographic analyisis<span></span></a></li>
</ul></li>
<li><a href="activity-17-spatially-continuous-data-iii.html#activity-17-spatially-continuous-data-iii" id="toc-activity-17-spatially-continuous-data-iii"><span class="toc-section-number">36</span> Activity 17: Spatially Continuous Data III<span></span></a>
<ul>
<li><a href="activity-17-spatially-continuous-data-iii.html#practice-questions-14" id="toc-practice-questions-14"><span class="toc-section-number">36.1</span> Practice questions<span></span></a></li>
<li><a href="activity-17-spatially-continuous-data-iii.html#learning-objectives-35" id="toc-learning-objectives-35"><span class="toc-section-number">36.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-17-spatially-continuous-data-iii.html#suggested-reading-16" id="toc-suggested-reading-16"><span class="toc-section-number">36.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-17-spatially-continuous-data-iii.html#preliminaries-34" id="toc-preliminaries-34"><span class="toc-section-number">36.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-17-spatially-continuous-data-iii.html#activity-16" id="toc-activity-16"><span class="toc-section-number">36.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="spatially-continuous-data-iv.html#spatially-continuous-data-iv" id="toc-spatially-continuous-data-iv"><span class="toc-section-number">37</span> Spatially Continuous Data IV<span></span></a>
<ul>
<li><a href="spatially-continuous-data-iv.html#learning-objectives-36" id="toc-learning-objectives-36"><span class="toc-section-number">37.1</span> Learning objectives<span></span></a></li>
<li><a href="spatially-continuous-data-iv.html#suggested-reading-17" id="toc-suggested-reading-17"><span class="toc-section-number">37.2</span> Suggested reading<span></span></a></li>
<li><a href="spatially-continuous-data-iv.html#preliminaries-35" id="toc-preliminaries-35"><span class="toc-section-number">37.3</span> Preliminaries<span></span></a></li>
<li><a href="spatially-continuous-data-iv.html#using-residual-spatial-pattern-to-estimate-prediction-errors" id="toc-using-residual-spatial-pattern-to-estimate-prediction-errors"><span class="toc-section-number">37.4</span> Using residual spatial pattern to estimate prediction errors<span></span></a></li>
<li><a href="spatially-continuous-data-iv.html#kriging-a-method-for-optimal-prediction." id="toc-kriging-a-method-for-optimal-prediction."><span class="toc-section-number">37.5</span> Kriging: a method for optimal prediction.<span></span></a></li>
</ul></li>
<li><a href="activity-18-spatially-continuous-data-iv.html#activity-18-spatially-continuous-data-iv" id="toc-activity-18-spatially-continuous-data-iv"><span class="toc-section-number">38</span> Activity 18: Spatially Continuous Data IV<span></span></a>
<ul>
<li><a href="activity-18-spatially-continuous-data-iv.html#practice-questions-15" id="toc-practice-questions-15"><span class="toc-section-number">38.1</span> Practice questions<span></span></a></li>
<li><a href="activity-18-spatially-continuous-data-iv.html#learning-objectives-37" id="toc-learning-objectives-37"><span class="toc-section-number">38.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-18-spatially-continuous-data-iv.html#suggested-reading-18" id="toc-suggested-reading-18"><span class="toc-section-number">38.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-18-spatially-continuous-data-iv.html#preliminaries-36" id="toc-preliminaries-36"><span class="toc-section-number">38.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-18-spatially-continuous-data-iv.html#activity-17" id="toc-activity-17"><span class="toc-section-number">38.5</span> Activity<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/paezha/spatial-analysis-R" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Spatial Data Analysis and Statistics: A Course in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="area-data-iii" class="section level1 hasAnchor" number="23">
<h1><span class="header-section-number">Chapter 23</span> Area Data III<a href="area-data-iii.html#area-data-iii" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>NOTE</em>: The source files for this book are available with companion package <a href="https://paezha.github.io/isdas/">{isdas}</a>. The source files are in Rmarkdown format and packed as templates. These files allow you execute code within the notebook, so that you can work interactively with the notes.</p>
<div id="learning-objectives-22" class="section level2 hasAnchor" number="23.1">
<h2><span class="header-section-number">23.1</span> Learning Objectives<a href="area-data-iii.html#learning-objectives-22" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous chapter and its corresponding activity, you learned about different ways to define <em>proximity</em> for area data, about spatial weights matrices, and how spatial weights matrices could be used to calculate spatial moving averages.</p>
<p>In this practice, you will learn about:</p>
<ol style="list-style-type: decimal">
<li>Spatial moving averages and simulation.</li>
<li>The concept of spatial autocorrelation.</li>
<li>Moran’s <span class="math inline">\(I\)</span> coefficient and Moran’s scatterplot.</li>
<li>Hypothesis testing for spatial autocorrelation.</li>
</ol>
</div>
<div id="suggested-readings-10" class="section level2 hasAnchor" number="23.2">
<h2><span class="header-section-number">23.2</span> Suggested Readings<a href="area-data-iii.html#suggested-readings-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Bailey TC and Gatrell AC <span class="citation">(<a href="#ref-Bailey1995" role="doc-biblioref">1995</a>)</span> Interactive Spatial Data Analysis, Chapter 7. Longman: Essex.</li>
<li>Bivand RS, Pebesma E, and Gomez-Rubio V <span class="citation">(<a href="#ref-Bivand2008" role="doc-biblioref">2008</a>)</span> Applied Spatial Data Analysis with R, Chapter 9. Springer: New York.</li>
<li>Brunsdon C and Comber L <span class="citation">(<a href="#ref-Brunsdon2015R" role="doc-biblioref">2015</a>)</span> An Introduction to R for Spatial Analysis and Mapping, Chapter 7. Sage: Los Angeles.</li>
<li>O’Sullivan D and Unwin D <span class="citation">(<a href="#ref-Osullivan2010" role="doc-biblioref">2010</a>)</span> Geographic Information Analysis, 2nd Edition, Chapter 7. John Wiley &amp; Sons: New Jersey.</li>
</ul>
</div>
<div id="preliminaries-21" class="section level2 hasAnchor" number="23.3">
<h2><span class="header-section-number">23.3</span> Preliminaries<a href="area-data-iii.html#preliminaries-21" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As usual, it is good practice to clear the working space to make sure that you do not have extraneous items there when you begin your work. The command in <code>R</code> to clear the workspace is <code>rm</code> (for “remove”), followed by a list of items to be removed. To clear the workspace from <em>all</em> objects, do the following:</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="area-data-iii.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>Note that <code>ls()</code> lists all objects currently on the workspace.</p>
<p>Load the libraries you will use in this activity:</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="area-data-iii.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(isdas)</span>
<span id="cb468-2"><a href="area-data-iii.html#cb468-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb468-3"><a href="area-data-iii.html#cb468-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb468-4"><a href="area-data-iii.html#cb468-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb468-5"><a href="area-data-iii.html#cb468-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb468-6"><a href="area-data-iii.html#cb468-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Read the data used in this chapter. This is an object of class <code>sf</code> (simple feature) with the census tracts of Hamilton CMA and some selected population variables from the 2011 Census of Canada:</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="area-data-iii.html#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Hamilton_CT)</span></code></pre></div>
<p>You can quickly verify the contents of the dataframe by means of <code>summary</code>:</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="area-data-iii.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Hamilton_CT)</span></code></pre></div>
<pre><code>##        ID               AREA             TRACT             POPULATION   
##  Min.   : 919807   Min.   :  0.3154   Length:188         Min.   :    5  
##  1st Qu.: 927964   1st Qu.:  0.8552   Class :character   1st Qu.: 2639  
##  Median : 948130   Median :  1.4157   Mode  :character   Median : 3595  
##  Mean   : 948710   Mean   :  7.4578                      Mean   : 3835  
##  3rd Qu.: 959722   3rd Qu.:  2.7775                      3rd Qu.: 4692  
##  Max.   :1115750   Max.   :138.4466                      Max.   :11675  
##   POP_DENSITY         AGE_LESS_20      AGE_20_TO_24    AGE_25_TO_29  
##  Min.   :    2.591   Min.   :   0.0   Min.   :  0.0   Min.   :  0.0  
##  1st Qu.: 1438.007   1st Qu.: 528.8   1st Qu.:168.8   1st Qu.:135.0  
##  Median : 2689.737   Median : 750.0   Median :225.0   Median :215.0  
##  Mean   : 2853.078   Mean   : 899.3   Mean   :253.9   Mean   :232.8  
##  3rd Qu.: 3783.889   3rd Qu.:1110.0   3rd Qu.:311.2   3rd Qu.:296.2  
##  Max.   :14234.286   Max.   :3285.0   Max.   :835.0   Max.   :915.0  
##   AGE_30_TO_34     AGE_35_TO_39     AGE_40_TO_44     AGE_45_TO_49  
##  Min.   :   0.0   Min.   :   0.0   Min.   :   0.0   Min.   :  0.0  
##  1st Qu.: 135.0   1st Qu.: 145.0   1st Qu.: 170.0   1st Qu.:203.8  
##  Median : 195.0   Median : 200.0   Median : 230.0   Median :282.5  
##  Mean   : 228.2   Mean   : 239.6   Mean   : 268.7   Mean   :310.6  
##  3rd Qu.: 281.2   3rd Qu.: 280.0   3rd Qu.: 325.0   3rd Qu.:385.0  
##  Max.   :1320.0   Max.   :1200.0   Max.   :1105.0   Max.   :880.0  
##   AGE_50_TO_54    AGE_55_TO_59    AGE_60_TO_64  AGE_65_TO_69    AGE_70_TO_74  
##  Min.   :  0.0   Min.   :  0.0   Min.   :  0   Min.   :  0.0   Min.   :  0.0  
##  1st Qu.:203.8   1st Qu.:175.0   1st Qu.:140   1st Qu.:115.0   1st Qu.: 90.0  
##  Median :280.0   Median :240.0   Median :220   Median :157.5   Median :130.0  
##  Mean   :300.3   Mean   :257.7   Mean   :229   Mean   :174.2   Mean   :139.7  
##  3rd Qu.:375.0   3rd Qu.:325.0   3rd Qu.:295   3rd Qu.:221.2   3rd Qu.:180.0  
##  Max.   :740.0   Max.   :625.0   Max.   :540   Max.   :625.0   Max.   :540.0  
##   AGE_75_TO_79     AGE_80_TO_84     AGE_MORE_85              geometry  
##  Min.   :  0.00   Min.   :  0.00   Min.   :  0.00   POLYGON      :188  
##  1st Qu.: 68.75   1st Qu.: 50.00   1st Qu.: 35.00   epsg:26917   :  0  
##  Median :100.00   Median : 77.50   Median : 70.00   +proj=utm ...:  0  
##  Mean   :118.32   Mean   : 95.05   Mean   : 87.71                      
##  3rd Qu.:160.00   3rd Qu.:120.00   3rd Qu.:105.00                      
##  Max.   :575.00   Max.   :420.00   Max.   :400.00</code></pre>
</div>
<div id="spatial-moving-averages-and-simulation" class="section level2 hasAnchor" number="23.4">
<h2><span class="header-section-number">23.4</span> Spatial Moving Averages and Simulation<a href="area-data-iii.html#spatial-moving-averages-and-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the preceding chapter and activity you learned about different criteria to define proximity for the analysis of area data, and how spatial weights matrices can be used to code patterns of proximity among zones in a spatial system. Furthermore, you also saw how spatial weights matrices can be used to calculate spatial moving averages, which in turn can be used to explore spatial patterns in area data.</p>
<p>We will begin this chapter by briefly revisiting some of these notions. In the following chunk, we create a spatial weights matrix for Hamilton CMA census tracts based on the adjacency criterion:</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="area-data-iii.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function `poly2nb()` builds a list of neighbors based on contiguous boundaries. The argument for this function is an object of class &quot;sf&quot;, which contains multi-polygon objects. </span></span>
<span id="cb472-2"><a href="area-data-iii.html#cb472-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-3"><a href="area-data-iii.html#cb472-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function `nb2listw()` takes a list of neighbors and creates a matrix of spatial weights in the form of a list. Together, these two functions create a spatial weights matrix for the Census Tracts in Hamilton.</span></span>
<span id="cb472-4"><a href="area-data-iii.html#cb472-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-5"><a href="area-data-iii.html#cb472-5" aria-hidden="true" tabindex="-1"></a>Hamilton_CT.nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(<span class="at">pl =</span> Hamilton_CT)</span>
<span id="cb472-6"><a href="area-data-iii.html#cb472-6" aria-hidden="true" tabindex="-1"></a>Hamilton_CT.w <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Hamilton_CT.nb)</span></code></pre></div>
<p>Once that you have a matrix of spatial weights, it can be used to calculate the spatial moving average. In this example, we calculate the spatial moving average of the variable for population density, i.e., <code>POP_DENSITY</code> which is found in the <code>sf</code> dataframe:</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="area-data-iii.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The function `lag.listw()` takes as argument the population density by census tracts in Hamilton, and calculates the moving average, with the &quot;moving&quot; part given by the local neighborhoods around each zone as defined by `Hamilton_CT.w`</span></span>
<span id="cb473-2"><a href="area-data-iii.html#cb473-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb473-3"><a href="area-data-iii.html#cb473-3" aria-hidden="true" tabindex="-1"></a>POP_DENSITY.sma <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(Hamilton_CT.w, Hamilton_CT<span class="sc">$</span>POP_DENSITY)</span></code></pre></div>
<p>After calculating the spatial moving average of population density, we can join this new variable to the <code>sf</code> object:</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="area-data-iii.html#cb474-1" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY.sma <span class="ot">&lt;-</span> POP_DENSITY.sma</span></code></pre></div>
<p>As you saw in your last activity, the spatial moving average can be used in two ways to explore the spatial pattern of an area variable: as a smoother and by means of a scatterplot, combined with the original variable.</p>
</div>
<div id="the-spatial-moving-average-as-a-smoother" class="section level2 hasAnchor" number="23.5">
<h2><span class="header-section-number">23.5</span> The Spatial Moving Average as a Smoother<a href="area-data-iii.html#the-spatial-moving-average-as-a-smoother" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The spatial moving average, when mapped, is essentially a smoothing technique. What do we mean by smoothing? By reporting the average of the neighbors instead of the actually observed value of the variable, we reduce the amount of variability that is communicated. This often can make it easier to distinguish the overall pattern, at the cost of some information loss (think of how when mapping quadrats we lost some information/detail by calculating the intensity for areas).</p>
<p>We can illustrate the use of the spatial moving average as a smoother with the help of a little simulation.</p>
<p>To simulate a random spatial variable, we can randomize the observations that we already have, reassigning them at random to areas in the system. This is accomplished as follows:</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="area-data-iii.html#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By sampling at random and without replacement from the original variable, we create a null landscape. We will call this `POP_DENSITY_s1`, where the &quot;s1&quot; part is to indicate that this is our first simulated random landscape. We will actually repeat this process below.</span></span>
<span id="cb475-2"><a href="area-data-iii.html#cb475-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-3"><a href="area-data-iii.html#cb475-3" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Hamilton_CT<span class="sc">$</span>POP_DENSITY)</span></code></pre></div>
<p>Calculate the spatial moving average for this randomized variable (i.e., null landscape):</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="area-data-iii.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We use the function `lag.listw()` to calculate the spatial moving average, but now for the null landscape we just simulated. </span></span>
<span id="cb476-2"><a href="area-data-iii.html#cb476-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-3"><a href="area-data-iii.html#cb476-3" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s1.sma <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(Hamilton_CT.w, POP_DENSITY_s1)</span></code></pre></div>
<p>Once that you have seen how to randomize the variable, repeat the process to simulate a total of eight new variables/null landscapes, and calculate their spatial moving averages:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="area-data-iii.html#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that we are creating 8 null landscapes based on our original population density variable, and that we are calculating the spatial moving average for each of them. Each simulation has a new name: s2, s3, s4,..., s8. </span></span>
<span id="cb477-2"><a href="area-data-iii.html#cb477-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-3"><a href="area-data-iii.html#cb477-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Null landscape/simulation #2</span></span>
<span id="cb477-4"><a href="area-data-iii.html#cb477-4" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Hamilton_CT<span class="sc">$</span>POP_DENSITY)</span>
<span id="cb477-5"><a href="area-data-iii.html#cb477-5" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s2.sma <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(Hamilton_CT.w, POP_DENSITY_s2)</span>
<span id="cb477-6"><a href="area-data-iii.html#cb477-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-7"><a href="area-data-iii.html#cb477-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Null landscape/simulation #3</span></span>
<span id="cb477-8"><a href="area-data-iii.html#cb477-8" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Hamilton_CT<span class="sc">$</span>POP_DENSITY)</span>
<span id="cb477-9"><a href="area-data-iii.html#cb477-9" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s3.sma <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(Hamilton_CT.w, POP_DENSITY_s3)</span>
<span id="cb477-10"><a href="area-data-iii.html#cb477-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-11"><a href="area-data-iii.html#cb477-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Null landscape/simulation #4</span></span>
<span id="cb477-12"><a href="area-data-iii.html#cb477-12" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s4 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Hamilton_CT<span class="sc">$</span>POP_DENSITY)</span>
<span id="cb477-13"><a href="area-data-iii.html#cb477-13" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s4.sma <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(Hamilton_CT.w, POP_DENSITY_s4)</span>
<span id="cb477-14"><a href="area-data-iii.html#cb477-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-15"><a href="area-data-iii.html#cb477-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Null landscape/simulation #5</span></span>
<span id="cb477-16"><a href="area-data-iii.html#cb477-16" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s5 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Hamilton_CT<span class="sc">$</span>POP_DENSITY)</span>
<span id="cb477-17"><a href="area-data-iii.html#cb477-17" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s5.sma <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(Hamilton_CT.w, POP_DENSITY_s5)</span>
<span id="cb477-18"><a href="area-data-iii.html#cb477-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-19"><a href="area-data-iii.html#cb477-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Null landscape/simulation #6</span></span>
<span id="cb477-20"><a href="area-data-iii.html#cb477-20" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s6 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Hamilton_CT<span class="sc">$</span>POP_DENSITY)</span>
<span id="cb477-21"><a href="area-data-iii.html#cb477-21" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s6.sma <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(Hamilton_CT.w, POP_DENSITY_s6)</span>
<span id="cb477-22"><a href="area-data-iii.html#cb477-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-23"><a href="area-data-iii.html#cb477-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Null landscape/simulation #7</span></span>
<span id="cb477-24"><a href="area-data-iii.html#cb477-24" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s7 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Hamilton_CT<span class="sc">$</span>POP_DENSITY)</span>
<span id="cb477-25"><a href="area-data-iii.html#cb477-25" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s7.sma <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(Hamilton_CT.w, POP_DENSITY_s7)</span>
<span id="cb477-26"><a href="area-data-iii.html#cb477-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-27"><a href="area-data-iii.html#cb477-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Null landscape/simulation #8</span></span>
<span id="cb477-28"><a href="area-data-iii.html#cb477-28" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s8 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Hamilton_CT<span class="sc">$</span>POP_DENSITY)</span>
<span id="cb477-29"><a href="area-data-iii.html#cb477-29" aria-hidden="true" tabindex="-1"></a>POP_DENSITY_s8.sma <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(Hamilton_CT.w, POP_DENSITY_s8)</span></code></pre></div>
<p>Next, we will add all the null landscapes that you just simulated to the dataframes, as well as their spatial moving averages. This is useful for mapping and plotting purposes:</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="area-data-iii.html#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we add the simulated landscapes to the `sf` dataframe.</span></span>
<span id="cb478-2"><a href="area-data-iii.html#cb478-2" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s1 <span class="ot">&lt;-</span> POP_DENSITY_s1</span>
<span id="cb478-3"><a href="area-data-iii.html#cb478-3" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s2 <span class="ot">&lt;-</span> POP_DENSITY_s2</span>
<span id="cb478-4"><a href="area-data-iii.html#cb478-4" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s3 <span class="ot">&lt;-</span> POP_DENSITY_s3</span>
<span id="cb478-5"><a href="area-data-iii.html#cb478-5" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s4 <span class="ot">&lt;-</span> POP_DENSITY_s4</span>
<span id="cb478-6"><a href="area-data-iii.html#cb478-6" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s5 <span class="ot">&lt;-</span> POP_DENSITY_s5</span>
<span id="cb478-7"><a href="area-data-iii.html#cb478-7" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s6 <span class="ot">&lt;-</span> POP_DENSITY_s6</span>
<span id="cb478-8"><a href="area-data-iii.html#cb478-8" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s7 <span class="ot">&lt;-</span> POP_DENSITY_s7</span>
<span id="cb478-9"><a href="area-data-iii.html#cb478-9" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s8 <span class="ot">&lt;-</span> POP_DENSITY_s8</span>
<span id="cb478-10"><a href="area-data-iii.html#cb478-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-11"><a href="area-data-iii.html#cb478-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we add the spatial moving averages of the simulated landscapes to the `sf` dataframe.</span></span>
<span id="cb478-12"><a href="area-data-iii.html#cb478-12" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s1.sma <span class="ot">&lt;-</span> POP_DENSITY_s1.sma</span>
<span id="cb478-13"><a href="area-data-iii.html#cb478-13" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s2.sma <span class="ot">&lt;-</span> POP_DENSITY_s2.sma</span>
<span id="cb478-14"><a href="area-data-iii.html#cb478-14" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s3.sma <span class="ot">&lt;-</span> POP_DENSITY_s3.sma</span>
<span id="cb478-15"><a href="area-data-iii.html#cb478-15" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s4.sma <span class="ot">&lt;-</span> POP_DENSITY_s4.sma</span>
<span id="cb478-16"><a href="area-data-iii.html#cb478-16" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s5.sma <span class="ot">&lt;-</span> POP_DENSITY_s5.sma</span>
<span id="cb478-17"><a href="area-data-iii.html#cb478-17" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s6.sma <span class="ot">&lt;-</span> POP_DENSITY_s6.sma</span>
<span id="cb478-18"><a href="area-data-iii.html#cb478-18" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s7.sma <span class="ot">&lt;-</span> POP_DENSITY_s7.sma</span>
<span id="cb478-19"><a href="area-data-iii.html#cb478-19" aria-hidden="true" tabindex="-1"></a>Hamilton_CT<span class="sc">$</span>POP_DENSITY_s8.sma <span class="ot">&lt;-</span> POP_DENSITY_s8.sma</span></code></pre></div>
<p>It would be useful to compare the original landscape of population density to the null landscapes that you created before. To create a single figure with choropleth maps of the empirical variable and the eight simulated variables using the <code>facet_wrap()</code> function of <code>ggplot2</code>, we must first reorganize the data so that all the population density variables are in a single column, and all spatial moving average variables are also in a single column. Further, we need a new column to identifies which variable the values in this column correspond to. We will solve this little data management problem by copying only the data we are interested in into a new dataframe (by means of <code>select()</code>), and then <em>gathering</em> the spatial moving averages into a single column:</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="area-data-iii.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&quot;Hamilton_CT2 is a new dataframe. Here, the pipe operators (%&gt;%) are used to pass the original dataframe to the select() function, and then the output of that is passed on to the `gather()` function. Notice that we are selecting the empirical spatial moving average and the 8 simulated instances of population densities. </span></span>
<span id="cb479-2"><a href="area-data-iii.html#cb479-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-3"><a href="area-data-iii.html#cb479-3" aria-hidden="true" tabindex="-1"></a>Hamilton_CT2 <span class="ot">&lt;-</span> Hamilton_CT <span class="sc">%&gt;%</span> <span class="co"># This pipe operator passes the dataframe to `select()`</span></span>
<span id="cb479-4"><a href="area-data-iii.html#cb479-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># `select()` keeps only the spatial moving averages and geometry</span></span>
<span id="cb479-5"><a href="area-data-iii.html#cb479-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(POP_DENSITY.sma, </span>
<span id="cb479-6"><a href="area-data-iii.html#cb479-6" aria-hidden="true" tabindex="-1"></a>         POP_DENSITY_s1.sma,</span>
<span id="cb479-7"><a href="area-data-iii.html#cb479-7" aria-hidden="true" tabindex="-1"></a>         POP_DENSITY_s2.sma,</span>
<span id="cb479-8"><a href="area-data-iii.html#cb479-8" aria-hidden="true" tabindex="-1"></a>         POP_DENSITY_s3.sma,</span>
<span id="cb479-9"><a href="area-data-iii.html#cb479-9" aria-hidden="true" tabindex="-1"></a>         POP_DENSITY_s4.sma,</span>
<span id="cb479-10"><a href="area-data-iii.html#cb479-10" aria-hidden="true" tabindex="-1"></a>         POP_DENSITY_s5.sma,</span>
<span id="cb479-11"><a href="area-data-iii.html#cb479-11" aria-hidden="true" tabindex="-1"></a>         POP_DENSITY_s6.sma,</span>
<span id="cb479-12"><a href="area-data-iii.html#cb479-12" aria-hidden="true" tabindex="-1"></a>         POP_DENSITY_s7.sma,</span>
<span id="cb479-13"><a href="area-data-iii.html#cb479-13" aria-hidden="true" tabindex="-1"></a>         POP_DENSITY_s8.sma,</span>
<span id="cb479-14"><a href="area-data-iii.html#cb479-14" aria-hidden="true" tabindex="-1"></a>         geometry) <span class="sc">%&gt;%</span> <span class="co"># This pipe operator passes the dataframe with only the spatial moving average variables and the geometry to `gather()`</span></span>
<span id="cb479-15"><a href="area-data-iii.html#cb479-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># `gather()` places all variables with the exception of `geometry` in a single column named `DENSITY_SMA` and creates a new variable called `VAR` with the names of the original columns (i.e., POP_DENSITY.sma, POP_DENSITY_s1.sma, etc.)</span></span>
<span id="cb479-16"><a href="area-data-iii.html#cb479-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(VAR, DENSITY_SMA, <span class="sc">-</span>geometry)</span></code></pre></div>
<p>Now the new dataframe with all spatial moving averages in a single column can be used to create choropleth maps. The function <code>facet_wrap()</code> is used to create facet plots so that we can place all maps in a single figure:</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="area-data-iii.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb480-2"><a href="area-data-iii.html#cb480-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> Hamilton_CT2, </span>
<span id="cb480-3"><a href="area-data-iii.html#cb480-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">fill =</span> DENSITY_SMA), <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb480-4"><a href="area-data-iii.html#cb480-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>VAR, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># We are creating multiple plots for single data frame by means of the &quot;facet_wrap&quot; function.</span></span>
<span id="cb480-5"><a href="area-data-iii.html#cb480-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;YlOrRd&quot;</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># Select palette for colors </span></span>
<span id="cb480-6"><a href="area-data-iii.html#cb480-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Pop Den SMA&quot;</span>) <span class="sc">+</span> <span class="co"># Change the label of the legend</span></span>
<span id="cb480-7"><a href="area-data-iii.html#cb480-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb480-8"><a href="area-data-iii.html#cb480-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()) <span class="co"># Remove the axis labels to avoid cluttering the plots</span></span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-162-1.png" width="672" /></p>
<p>The empirical variable is the map in the upper left corner (labeled <code>POP_DENSITY.sma</code>). The remaining 8 maps are simulated variables. Would you say the map of the empirical variable is fairly different from the map of the simulated variables? What are the key differences?</p>
<p>An additional advantage of the spatial moving average is its use in the development of scatterplots. The information below provides further examples of exploring spatial moving averages with scatterplots.</p>
</div>
<div id="spatial-moving-average-scatterplots" class="section level2 hasAnchor" number="23.6">
<h2><span class="header-section-number">23.6</span> Spatial Moving Average Scatterplots<a href="area-data-iii.html#spatial-moving-average-scatterplots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let us explore the use of spatial moving average scatterplots. First, we will extract the density information from the original <code>sf</code> object, reorganize, and bind to <code>Hamilton_CT2</code> so that we can plot using faceting:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="area-data-iii.html#cb481-1" aria-hidden="true" tabindex="-1"></a>Hamilton_CT2 <span class="ot">&lt;-</span> Hamilton_CT2 <span class="sc">%&gt;%</span> <span class="co"># Pass `Hamilton_CT2` as the first argument of `data.frame()`</span></span>
<span id="cb481-2"><a href="area-data-iii.html#cb481-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(Hamilton_CT <span class="sc">%&gt;%</span> <span class="co"># Pass `Hamilton_CT` to `st_drop_geometry()`</span></span>
<span id="cb481-3"><a href="area-data-iii.html#cb481-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> <span class="co"># Drop the geometry because it is already available in `Hamilton_CT2`.</span></span>
<span id="cb481-4"><a href="area-data-iii.html#cb481-4" aria-hidden="true" tabindex="-1"></a>               <span class="co"># Select from `Hamilton_CT` the original population density and the 8 null landscapes simulated from it.</span></span>
<span id="cb481-5"><a href="area-data-iii.html#cb481-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">select</span>(POP_DENSITY,</span>
<span id="cb481-6"><a href="area-data-iii.html#cb481-6" aria-hidden="true" tabindex="-1"></a>                      POP_DENSITY_s1,</span>
<span id="cb481-7"><a href="area-data-iii.html#cb481-7" aria-hidden="true" tabindex="-1"></a>                      POP_DENSITY_s2,</span>
<span id="cb481-8"><a href="area-data-iii.html#cb481-8" aria-hidden="true" tabindex="-1"></a>                      POP_DENSITY_s3,</span>
<span id="cb481-9"><a href="area-data-iii.html#cb481-9" aria-hidden="true" tabindex="-1"></a>                      POP_DENSITY_s4,</span>
<span id="cb481-10"><a href="area-data-iii.html#cb481-10" aria-hidden="true" tabindex="-1"></a>                      POP_DENSITY_s5,</span>
<span id="cb481-11"><a href="area-data-iii.html#cb481-11" aria-hidden="true" tabindex="-1"></a>                      POP_DENSITY_s6,</span>
<span id="cb481-12"><a href="area-data-iii.html#cb481-12" aria-hidden="true" tabindex="-1"></a>                      POP_DENSITY_s7,</span>
<span id="cb481-13"><a href="area-data-iii.html#cb481-13" aria-hidden="true" tabindex="-1"></a>                      POP_DENSITY_s8) <span class="sc">%&gt;%</span> <span class="co"># Pass the result to `gather()`  </span></span>
<span id="cb481-14"><a href="area-data-iii.html#cb481-14" aria-hidden="true" tabindex="-1"></a>               <span class="fu">gather</span>(VAR, DENSITY) <span class="sc">%&gt;%</span> <span class="co"># Copy all density variables to a single column, and create a new variable called `VAR` with the names of the original columns (i.e., POP_DENSITY, POP_DENSITY_s1, etc.) </span></span>
<span id="cb481-15"><a href="area-data-iii.html#cb481-15" aria-hidden="true" tabindex="-1"></a>               <span class="fu">select</span>(DENSITY)) <span class="co"># Drop VAR from the the dataframe</span></span></code></pre></div>
<p>After reorganizing the data we can create the scatterplot of the empirical population density and its spatial moving average, as well as the scatterplots of the simulated variables and their spatial moving averages for comparison (the plots include the 45 degree line). Again, the use of <code>facet_wrap()</code> allows us to put all plots in a single figure:</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="area-data-iii.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We are adding a geom and line (slope = 1)</span></span>
<span id="cb482-2"><a href="area-data-iii.html#cb482-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Hamilton_CT2, <span class="fu">aes</span>(<span class="at">x =</span> DENSITY, <span class="at">y =</span> DENSITY_SMA, <span class="at">color =</span> VAR)) <span class="sc">+</span></span>
<span id="cb482-3"><a href="area-data-iii.html#cb482-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb482-4"><a href="area-data-iii.html#cb482-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb482-5"><a href="area-data-iii.html#cb482-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb482-6"><a href="area-data-iii.html#cb482-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> VAR, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-164-1.png" width="672" /></p>
<p>What difference do you see between the empirical and simulated variables in these scatterplots?</p>
<p>It is possible to fit a line to the scatterplots (i.e., adding a regression line). This makes it easier to appreciate the difference between the empirical and simulated variables. This line would take the following form, with <span class="math inline">\(\beta\)</span> as the slope of the line, and <span class="math inline">\(\alpha\)</span> the intercept:
<span class="math display">\[
\overline{x_i} =\alpha + \beta x_i
\]</span></p>
<p>Recreate the previous figure, but now add fitted lines to the scatterplots by means of the function <code>geom_smooth()</code>. The method “lm” means <em>linear model</em>, so the fitted line is a straight line:</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="area-data-iii.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Hamilton_CT2, <span class="fu">aes</span>(<span class="at">x =</span> DENSITY, <span class="at">y =</span> DENSITY_SMA, <span class="at">color =</span> VAR)) <span class="sc">+</span></span>
<span id="cb483-2"><a href="area-data-iii.html#cb483-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb483-3"><a href="area-data-iii.html#cb483-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb483-4"><a href="area-data-iii.html#cb483-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a fitted line to the plots</span></span>
<span id="cb483-5"><a href="area-data-iii.html#cb483-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb483-6"><a href="area-data-iii.html#cb483-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb483-7"><a href="area-data-iii.html#cb483-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> VAR, <span class="at">ncol =</span> <span class="dv">3</span>) </span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<p>You will notice that the slope of the line tends to be flat in the simulated variables; this is to be expected, since these variables are spatially random: <em>the values of the variable at <span class="math inline">\(i\)</span> are independent of the values of their local means!</em>. In other words, the probability that the map is random is pretty high (in fact, since these 8 of these maps are null landscapes, we know for a fact that they are random).</p>
<p>The empirical variable, on the other hand, has a slope that is much closer to the 45 degree line. This indicates that the values of the variable at <span class="math inline">\(i\)</span> are not independent of their local means: in other words, <span class="math inline">\(x_i\)</span> is correlated with <span class="math inline">\(\overline{x_i}\)</span>, and the probability of a non-random pattern is high. This phenomenon is called <em>spatial autocorrelation</em>, and it is a fundamental way to describe spatial data. We will discuss this more extensively next.</p>
</div>
<div id="spatial-autocorrelation-and-morans-i-coefficient" class="section level2 hasAnchor" number="23.7">
<h2><span class="header-section-number">23.7</span> Spatial Autocorrelation and Moran’s <span class="math inline">\(I\)</span> coefficient<a href="area-data-iii.html#spatial-autocorrelation-and-morans-i-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As seen above, the spatial moving average can provide evidence of the phenomenon of spatial autocorrelation, that is, when a variable displays spatial patterns whereby the values of a variable at zone <span class="math inline">\(i\)</span> are not independent of the values of the variable in the neighborhood of zone <span class="math inline">\(i\)</span>.</p>
<p>A convenient modification to the concept of the spatial moving average is as follows. Instead of using the variable <span class="math inline">\(x\)</span> for the calculation of the spatial moving average, we first center it on the global mean:
<span class="math display">\[
z_i = x_i - \bar{x}
\]</span></p>
<p>In this way, the values of <span class="math inline">\(z_i\)</span> are given in <em>deviations from the mean</em>. By forcing the variable to be centered on the mean, the slope of the fit line is forced to pass through the origin.</p>
<p>Calculate the mean-centered version of POP_DENSIT, and then its spatial moving average:</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="area-data-iii.html#cb485-1" aria-hidden="true" tabindex="-1"></a>df_mean_center_scatterplot <span class="ot">&lt;-</span> <span class="fu">transmute</span>(Hamilton_CT, <span class="co"># Modify values in dataframe</span></span>
<span id="cb485-2"><a href="area-data-iii.html#cb485-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">Density_z =</span> POP_DENSITY <span class="sc">-</span> <span class="fu">mean</span>(POP_DENSITY), <span class="co"># Subtract the mean, so that the variable now is deviations from the mean </span></span>
<span id="cb485-3"><a href="area-data-iii.html#cb485-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">SMA_z =</span> <span class="fu">lag.listw</span>(Hamilton_CT.w, Density_z)) <span class="co"># Calculate the spatial moving average of the newly created variable `Density_z`</span></span></code></pre></div>
<p>Compare the following two plots. You will see that they are identical, but in the mean-centered one the origin of the axes coincides with the means of <span class="math inline">\(x\)</span> and the spatial moving average of <span class="math inline">\(x\)</span>. In other words, we have the same data, but we have displaced the origin of the plot:</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="area-data-iii.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of population density and its spatial moving average</span></span>
<span id="cb486-2"><a href="area-data-iii.html#cb486-2" aria-hidden="true" tabindex="-1"></a>sc1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">filter</span>(Hamilton_CT2, VAR <span class="sc">==</span> <span class="st">&quot;POP_DENSITY.sma&quot;</span>),</span>
<span id="cb486-3"><a href="area-data-iii.html#cb486-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> DENSITY, <span class="at">y =</span> DENSITY_SMA)) <span class="sc">+</span></span>
<span id="cb486-4"><a href="area-data-iii.html#cb486-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb486-5"><a href="area-data-iii.html#cb486-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb486-6"><a href="area-data-iii.html#cb486-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb486-7"><a href="area-data-iii.html#cb486-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Population Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb486-8"><a href="area-data-iii.html#cb486-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span>
<span id="cb486-9"><a href="area-data-iii.html#cb486-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-10"><a href="area-data-iii.html#cb486-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatterplot of the mean-centered population density, and its spatial moving average</span></span>
<span id="cb486-11"><a href="area-data-iii.html#cb486-11" aria-hidden="true" tabindex="-1"></a>sc2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_mean_center_scatterplot, </span>
<span id="cb486-12"><a href="area-data-iii.html#cb486-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> Density_z, <span class="at">y =</span> SMA_z)) <span class="sc">+</span></span>
<span id="cb486-13"><a href="area-data-iii.html#cb486-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb486-14"><a href="area-data-iii.html#cb486-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb486-15"><a href="area-data-iii.html#cb486-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x<span class="dv">-1</span>) <span class="sc">+</span></span>
<span id="cb486-16"><a href="area-data-iii.html#cb486-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mean-Centered Population Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb486-17"><a href="area-data-iii.html#cb486-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span>
<span id="cb486-18"><a href="area-data-iii.html#cb486-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-19"><a href="area-data-iii.html#cb486-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Use patchwork to place the two plots in a single figure </span></span>
<span id="cb486-20"><a href="area-data-iii.html#cb486-20" aria-hidden="true" tabindex="-1"></a>sc1 <span class="sc">+</span> sc2</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
<p>How is it useful to displace the origin of the axes to the mean values of <span class="math inline">\(x\)</span> and its spatial moving average? To explain this, notice that the values on the top scatterplot are all positive. The values on the bottom scatterplot are positive or negative, depending if they are <em>above</em> or <em>below</em> the mean. This sign is interesting. Notice what happens when the variable <span class="math inline">\(z_i\)</span> multiplies its spatial moving average:
<span class="math display">\[
z_i\bar{z}_i = z_i\sum_{j=1}^n{w_{ij}^{st}z_j}
\]</span></p>
<p>When <span class="math inline">\(z_i\)</span> is above its mean, it is a positive value. When it is below the mean, it is a negative value. Likewise, when <span class="math inline">\(\bar{z}_i\)</span> is above its mean, it is a positive value, and negative otherwise. The mean is a useful benchmark to see if values are relatively high, or relatively low.</p>
<p>There are four possibilities with respect to the combinations of (relatively) high and low values.</p>
<ol style="list-style-type: decimal">
<li>Quadrant 1 (the value of <span class="math inline">\(z_i\)</span> is high &amp; the value of <span class="math inline">\(\bar{z}_i\)</span> is also high):</li>
</ol>
<p>If <span class="math inline">\(z_i\)</span> is above the mean, it is a relatively high value in the distribution (signed positive). If its neighbors are also relatively high values, the spatial moving average will be above the mean, and also signed positive. Their product will be positive (positive times positive equals positive).</p>
<ol start="2" style="list-style-type: decimal">
<li>Quadrant 2 (the value of <span class="math inline">\(z_i\)</span> is low &amp; the value of <span class="math inline">\(\bar{z}_i\)</span> is high):</li>
</ol>
<p>If <span class="math inline">\(z_i\)</span> is below the mean, it is a relatively low value in the distribution (signed negative). If its neighbors in contrast are relatively high values, the spatial moving average will be above the mean, and signed positive. Their product will be negative (negative times positive equals negative).</p>
<ol start="3" style="list-style-type: decimal">
<li>Quadrant 3 (the value of <span class="math inline">\(z_i\)</span> is low &amp; the value of <span class="math inline">\(\bar{z}_i\)</span> is also low):</li>
</ol>
<p>If <span class="math inline">\(z_i\)</span> is below the mean, it is a relatively low value in the distribution (signed negative). If its neighbors are also relatively low values, the spatial moving average will be below the mean, and also signed negative. Their product will be positive (negative times negative equals positive).</p>
<ol start="4" style="list-style-type: decimal">
<li>Quadrant 4 (the value of <span class="math inline">\(z_i\)</span> is high &amp; the value of <span class="math inline">\(\bar{z}_i\)</span> is low):</li>
</ol>
<p>If <span class="math inline">\(z_i\)</span> is above the mean, it is a relatively high value in the distribution (signed positive). If its neighbors are relatively low values, the spatial moving average will be below the mean, and signed negative. Their product will be negative (positive times negative equals negative).</p>
<p>These four quadrants are shown in the following plot:</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="area-data-iii.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_mean_center_scatterplot, </span>
<span id="cb488-2"><a href="area-data-iii.html#cb488-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Density_z, <span class="at">y =</span> SMA_z)) <span class="sc">+</span></span>
<span id="cb488-3"><a href="area-data-iii.html#cb488-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb488-4"><a href="area-data-iii.html#cb488-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb488-5"><a href="area-data-iii.html#cb488-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb488-6"><a href="area-data-iii.html#cb488-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># You can also add annotations to plots by using `annotate()`. The inputs are the kind of annotation; in this case &quot;text&quot;, but it could be circles, arrows, rectangles, labels, and other things. For text, you need a label, and coordinates for the annotation.</span></span>
<span id="cb488-7"><a href="area-data-iii.html#cb488-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;Q1: Positive&quot;</span>, <span class="at">x=</span> <span class="dv">2000</span>, <span class="at">y =</span> <span class="dv">2500</span>) <span class="sc">+</span></span>
<span id="cb488-8"><a href="area-data-iii.html#cb488-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;Q4: Negative&quot;</span>, <span class="at">x=</span> <span class="dv">2000</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">2500</span>) <span class="sc">+</span></span>
<span id="cb488-9"><a href="area-data-iii.html#cb488-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;Q2: Negative&quot;</span>, <span class="at">x=</span> <span class="sc">-</span><span class="dv">2000</span>, <span class="at">y =</span> <span class="dv">2500</span>) <span class="sc">+</span></span>
<span id="cb488-10"><a href="area-data-iii.html#cb488-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;Q3: Positive&quot;</span>, <span class="at">x=</span> <span class="sc">-</span><span class="dv">2000</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">2500</span>) <span class="sc">+</span></span>
<span id="cb488-11"><a href="area-data-iii.html#cb488-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-168-1.png" width="672" /></p>
<p>We can take the products of <span class="math inline">\(z_i\)</span> by <span class="math inline">\(\bar{z}_i\)</span> for all <span class="math inline">\(i\)</span> and add them:
<span class="math display">\[
\sum_{i=1}^n{z_i\overline{z_i}} = \sum_{i=1}^n{z_i\sum_{j=1}^n{w_{ij}^{st}z_j}}
\]</span></p>
<p>If many dots are in Quadrants 1 and 3 in the scatterplot, the sum of the products will tend to be a large positive number. On the other hand, if many dots are in Quadrants 2 and 4, the sum of the products will tend to be a large number, but negative. Either case would be indicative of a pattern:</p>
<ol style="list-style-type: decimal">
<li><p>If the sum is positive, this would suggest that high &amp; high values tend to be together, while low &amp; low values also tend to be together.</p></li>
<li><p>In contrast, if the sum is negative, this would suggest that high values tend to be surrounded by low values, and vice-versa.</p></li>
</ol>
<p>Finally, if the dots are scattered over the four quadrants, some products will be positive and some will be negative, and they will tend to cancel each other when summed. In this way, the sum of the products will tend to be closer to zero.</p>
</div>
<div id="morans-i-and-morans-scatterplot" class="section level2 hasAnchor" number="23.8">
<h2><span class="header-section-number">23.8</span> Moran’s <span class="math inline">\(I\)</span> and Moran’s Scatterplot<a href="area-data-iii.html#morans-i-and-morans-scatterplot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Based on the discussion above, let us define the following coefficient, called <em>Moran’s I</em>:
<span class="math display">\[
I = \frac{\sum_{i=1}^n{z_i\sum_{j=1}^n{w_{ij}^{st}z_j}}}{\sum_{i=1}^{n}{z_i^2}}
\]</span></p>
<p>The numerator in this expression is the sum of the products described above. The denominator is the variance of variable <span class="math inline">\(x_i\)</span>, and is used here to scale Moran’s <span class="math inline">\(I\)</span> so that it is contained roughly in the interval <span class="math inline">\((-1, 1)\)</span> (the exact bounds depend on the characteristics of the zoning system).</p>
<p>Moran’s <span class="math inline">\(I\)</span> is a coefficient of <em>spatial autocorrelation</em>.</p>
<p>We can calculate Moran’s <span class="math inline">\(I\)</span> as follows, using as an example the mean-centered population density (notice how it is the sum of the products of <span class="math inline">\(z_i\)</span> by their spatial moving averages <span class="math inline">\(\bar{z}_i\)</span>, divided by the variance):</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="area-data-iii.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try to decipher the formula. You should be able to see that we are calculating the sum of the products by their spatial moving averages, divided by variance</span></span>
<span id="cb489-2"><a href="area-data-iii.html#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(df_mean_center_scatterplot<span class="sc">$</span>Density_z <span class="sc">*</span>  df_mean_center_scatterplot<span class="sc">$</span>SMA_z) <span class="sc">/</span> <span class="fu">sum</span>(df_mean_center_scatterplot<span class="sc">$</span>Density_z<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.5179736</code></pre>
<p>Since the value is positive, and relatively high, this would suggest a non-random spatial pattern of similar values (i.e., high &amp; high and low &amp; low).</p>
<p>Moran’s <span class="math inline">\(I\)</span> is implemented in <code>R</code> in the <code>spdep</code> package, which makes its calculation easy, since you do not have to go manually through the process of calculating the spatial moving averages, etc.</p>
<p>The function <code>moran()</code> requires as input arguments a variable, a set of spatial weights, the number of zones (<span class="math inline">\(n\)</span>), and the total sum of all weights (termed <span class="math inline">\(S_0\)</span>) - which in the case of row-standardized spatial weights is equal to the number of zones. Therefore:</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="area-data-iii.html#cb491-1" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">moran</span>(Hamilton_CT<span class="sc">$</span>POP_DENSITY, Hamilton_CT.w, <span class="at">n =</span> <span class="dv">188</span>, <span class="at">S0 =</span>  <span class="dv">188</span>)</span>
<span id="cb491-2"><a href="area-data-iii.html#cb491-2" aria-hidden="true" tabindex="-1"></a>mc<span class="sc">$</span>I</span></code></pre></div>
<pre><code>## [1] 0.5179736</code></pre>
<p>You can verify that this matches the value calculated above. The kind of scatterplots that we used previously are called <em>Moran’s scatterplots</em>, and they can also be created easily by means of the <code>moran.plot()</code> function of the <code>spdep</code> package:</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="area-data-iii.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirming the results from the Moran coefficient above. We use &quot;moran.plot&quot; to illustrate the SMA of population density by census tract in Hamilton. </span></span>
<span id="cb493-2"><a href="area-data-iii.html#cb493-2" aria-hidden="true" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">moran.plot</span>(Hamilton_CT<span class="sc">$</span>POP_DENSITY, Hamilton_CT.w)</span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
</div>
<div id="hypothesis-testing-for-spatial-autocorrelation" class="section level2 hasAnchor" number="23.9">
<h2><span class="header-section-number">23.9</span> Hypothesis Testing for Spatial Autocorrelation<a href="area-data-iii.html#hypothesis-testing-for-spatial-autocorrelation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The tools described so far are useful to suggest whether a pattern is random; however, while inspection of the scatterplot is suggestive, we would like a more formal criterion to decide whether the pattern is random. Fortunately, Moran’s <span class="math inline">\(I\)</span> can be used to develop a test of hypothesis. The expected value of Moran’s <span class="math inline">\(I\)</span> under the null hypothesis of spatial randomness (or independence), as well as its variance, have been derived.</p>
<p>A test for autocorrelation based on Moran’s <span class="math inline">\(I\)</span> is implemented in the <code>spdep</code> package:</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="area-data-iii.html#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&quot;moran.test&quot; is calculating spatial autocorrelation of population density in Hamilton census tracts</span></span>
<span id="cb494-2"><a href="area-data-iii.html#cb494-2" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(Hamilton_CT<span class="sc">$</span>POP_DENSITY, Hamilton_CT.w)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  Hamilton_CT$POP_DENSITY  
## weights: Hamilton_CT.w    
## 
## Moran I statistic standard deviate = 12.722, p-value &lt; 2.2e-16
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##       0.517973553      -0.005347594       0.001691977</code></pre>
<p>Since the null hypothesis is of spatial independence, the <span class="math inline">\(p\)</span>-value of the statistic is interpreted as the probability of making a mistake by rejecting the null hypothesis. In the present case, the <span class="math inline">\(p\)</span>-value is such a small number that we can reject the null hypothesis with a high degree of confidence.</p>
<p>Moran’s <span class="math inline">\(I\)</span> and Moran’s scatterplots are among the most widely used tools in the analysis of spatial area data.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bailey1995" class="csl-entry">
Bailey, T. C., and A. C. Gatrell. 1995. <em>Interactive Spatial Data Analysis</em>. Book. Essex: Addison Wesley Longman.
</div>
<div id="ref-Bivand2008" class="csl-entry">
Bivand, R. S., E. J. Pebesma, and V. Gómez-Rubio. 2008. <em>Applied Spatial Data Analysis with r</em>. Book. New York: Springer Science+Business Media.
</div>
<div id="ref-Brunsdon2015R" class="csl-entry">
Brunsdon, Chris, and Lex Comber. 2015. <em>An Introduction to r for Spatial Analysis and Mapping</em>. Book. Sage.
</div>
<div id="ref-Osullivan2010" class="csl-entry">
O’Sullivan, David, and David Unwin. 2010. <em>Geographic Information Analysis</em>. Book. 2nd. Edition. Hoboken, New Jersey: John Wiley &amp; Sons.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="activity-10-area-data-ii.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="activity-11-area-data-iii.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/paezha/spatial-analysis-R/edit/main/23-Area-Data-III.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["spatial-analysis-R.pdf", "spatial-analysis-R.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
