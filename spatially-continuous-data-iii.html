<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 35 Spatially Continuous Data III | An Introduction to Spatial Data Analysis and Statistics: A Course in R</title>
  <meta name="description" content="This book was created as a resource for teaching applied spatial statistics at McMaster University by Antonio Paez, with support from Anastassios Dardas, Rajveer Ubhi, Megan Coad, and Alexis Polidoro. The book is published with support of an Open Educational Resources grant from MacPherson Institute, McMaster University." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 35 Spatially Continuous Data III | An Introduction to Spatial Data Analysis and Statistics: A Course in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.jpg" />
  <meta property="og:description" content="This book was created as a resource for teaching applied spatial statistics at McMaster University by Antonio Paez, with support from Anastassios Dardas, Rajveer Ubhi, Megan Coad, and Alexis Polidoro. The book is published with support of an Open Educational Resources grant from MacPherson Institute, McMaster University." />
  <meta name="github-repo" content="paezha/spatial-analysis-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 35 Spatially Continuous Data III | An Introduction to Spatial Data Analysis and Statistics: A Course in R" />
  
  <meta name="twitter:description" content="This book was created as a resource for teaching applied spatial statistics at McMaster University by Antonio Paez, with support from Anastassios Dardas, Rajveer Ubhi, Megan Coad, and Alexis Polidoro. The book is published with support of an Open Educational Resources grant from MacPherson Institute, McMaster University." />
  <meta name="twitter:image" content="/images/cover.jpg" />

<meta name="author" content="Antonio Paez" />


<meta name="date" content="2022-04-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="activity-16-spatially-continuous-data-ii.html"/>
<link rel="next" href="activity-17-spatially-continuous-data-iii.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<script src="libs/lfx-heat-0.1.0/lfx-heat-prod.js"></script>
<script src="libs/lfx-heat-0.1.0/lfx-heat-bindings.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="libs/colourpicker-1.1/colourpicker.min.css" rel="stylesheet" />
<script src="libs/colourpicker-1.1/colourpicker.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-grid-3.4.1/bootstrap-grid.min.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial Analysis in R</a></li>

<li class="divider"></li>
<li><a href="index.html#section" id="toc-section"></a></li>
<li><a href="front-matter.html#front-matter" id="toc-front-matter">Front Matter<span></span></a>
<ul>
<li><a href="front-matter.html#what-is-this-book-and-who-is-it-for" id="toc-what-is-this-book-and-who-is-it-for">What is this book and who is it for?<span></span></a></li>
<li><a href="front-matter.html#allied-resources" id="toc-allied-resources">Allied resources<span></span></a></li>
<li><a href="front-matter.html#contributing" id="toc-contributing">Contributing<span></span></a>
<ul>
<li><a href="front-matter.html#license" id="toc-license"><span class="toc-section-number">0.0.1</span> License<span></span></a></li>
</ul></li>
<li><a href="front-matter.html#how-to-support-this-project" id="toc-how-to-support-this-project">How to support this project<span></span></a></li>
</ul></li>
<li><a href="preface.html#preface" id="toc-preface">Preface<span></span></a>
<ul>
<li><a href="preface.html#spatial-analysis-and-spatial-statistics" id="toc-spatial-analysis-and-spatial-statistics">Spatial Analysis and Spatial Statistics<span></span></a></li>
<li><a href="preface.html#why-this-text" id="toc-why-this-text">Why this Text?<span></span></a></li>
<li><a href="preface.html#plan" id="toc-plan">Plan<span></span></a></li>
<li><a href="preface.html#audience" id="toc-audience">Audience<span></span></a></li>
<li><a href="preface.html#requisites" id="toc-requisites">Requisites<span></span></a></li>
<li><a href="preface.html#words-of-appreciation" id="toc-words-of-appreciation">Words of Appreciation<span></span></a></li>
<li><a href="preface.html#versioning" id="toc-versioning">Versioning<span></span></a></li>
</ul></li>
<li><a href="#part-part-i-getting-to-know-the-technology" id="toc-part-part-i-getting-to-know-the-technology">(PART) Part I: Getting to Know the Technology<span></span></a></li>
<li><a href="preliminaries.html#preliminaries" id="toc-preliminaries"><span class="toc-section-number">1</span> Preliminaries: Installing <code>R</code> and RStudio<span></span></a>
<ul>
<li><a href="preliminaries.html#introduction" id="toc-introduction"><span class="toc-section-number">1.1</span> Introduction<span></span></a></li>
<li><a href="preliminaries.html#learning-objectives" id="toc-learning-objectives"><span class="toc-section-number">1.2</span> Learning Objectives<span></span></a></li>
<li><a href="preliminaries.html#r-the-open-statistical-computing-project" id="toc-r-the-open-statistical-computing-project"><span class="toc-section-number">1.3</span> <code>R</code>: The Open Statistical Computing Project<span></span></a>
<ul>
<li><a href="preliminaries.html#what-is-r" id="toc-what-is-r"><span class="toc-section-number">1.3.1</span> What is <code>R</code>?<span></span></a></li>
<li><a href="preliminaries.html#the-rstudio-ide" id="toc-the-rstudio-ide"><span class="toc-section-number">1.3.2</span> The RStudio IDE<span></span></a></li>
</ul></li>
<li><a href="preliminaries.html#packages-in-r" id="toc-packages-in-r"><span class="toc-section-number">1.4</span> Packages in R<span></span></a></li>
</ul></li>
<li><a href="basic-operations.html#basic-operations" id="toc-basic-operations"><span class="toc-section-number">2</span> Basic Operations and Data Structures in <code>R</code><span></span></a>
<ul>
<li><a href="basic-operations.html#learning-objectives-1" id="toc-learning-objectives-1"><span class="toc-section-number">2.1</span> Learning Objectives<span></span></a></li>
<li><a href="basic-operations.html#rstudio-ide" id="toc-rstudio-ide"><span class="toc-section-number">2.2</span> RStudio IDE<span></span></a></li>
<li><a href="basic-operations.html#some-basic-operations" id="toc-some-basic-operations"><span class="toc-section-number">2.3</span> Some Basic Operations<span></span></a></li>
<li><a href="basic-operations.html#data-classes-in-r" id="toc-data-classes-in-r"><span class="toc-section-number">2.4</span> Data Classes in R<span></span></a></li>
<li><a href="basic-operations.html#data-types-in-r" id="toc-data-types-in-r"><span class="toc-section-number">2.5</span> Data Types in R<span></span></a></li>
<li><a href="basic-operations.html#indexing-and-data-transformations" id="toc-indexing-and-data-transformations"><span class="toc-section-number">2.6</span> Indexing and Data Transformations<span></span></a></li>
<li><a href="basic-operations.html#visualization" id="toc-visualization"><span class="toc-section-number">2.7</span> Visualization<span></span></a></li>
<li><a href="basic-operations.html#creating-a-simple-map" id="toc-creating-a-simple-map"><span class="toc-section-number">2.8</span> Creating a Simple Map<span></span></a></li>
<li><a href="basic-operations.html#examples-of-digital-cartography-in-r" id="toc-examples-of-digital-cartography-in-r"><span class="toc-section-number">2.9</span> Examples of digital cartography in <code>R</code><span></span></a></li>
<li><a href="basic-operations.html#references" id="toc-references"><span class="toc-section-number">2.10</span> References<span></span></a></li>
</ul></li>
<li><a href="#part-part-ii-statistics-and-maps" id="toc-part-part-ii-statistics-and-maps">(PART) Part II: Statistics and Maps<span></span></a></li>
<li><a href="introduction-to-maps.html#introduction-to-maps" id="toc-introduction-to-maps"><span class="toc-section-number">3</span> Introduction to Mapping in <code>R</code><span></span></a>
<ul>
<li><a href="introduction-to-maps.html#learning-objectives-2" id="toc-learning-objectives-2"><span class="toc-section-number">3.1</span> Learning Objectives<span></span></a></li>
<li><a href="introduction-to-maps.html#suggested-readings" id="toc-suggested-readings"><span class="toc-section-number">3.2</span> Suggested Readings<span></span></a></li>
<li><a href="introduction-to-maps.html#preliminaries-1" id="toc-preliminaries-1"><span class="toc-section-number">3.3</span> Preliminaries<span></span></a></li>
<li><a href="introduction-to-maps.html#packages" id="toc-packages"><span class="toc-section-number">3.4</span> Packages<span></span></a></li>
<li><a href="introduction-to-maps.html#exploring-dataframes-and-a-simple-proportional-symbols-map" id="toc-exploring-dataframes-and-a-simple-proportional-symbols-map"><span class="toc-section-number">3.5</span> Exploring Dataframes and a Simple Proportional Symbols Map<span></span></a></li>
<li><a href="introduction-to-maps.html#improving-on-the-proportional-symbols-map" id="toc-improving-on-the-proportional-symbols-map"><span class="toc-section-number">3.6</span> Improving on the Proportional Symbols Map<span></span></a></li>
<li><a href="introduction-to-maps.html#some-simple-spatial-analysis" id="toc-some-simple-spatial-analysis"><span class="toc-section-number">3.7</span> Some Simple Spatial Analysis<span></span></a></li>
<li><a href="introduction-to-maps.html#other-resources" id="toc-other-resources"><span class="toc-section-number">3.8</span> Other Resources<span></span></a></li>
</ul></li>
<li><a href="activity-statistical-maps-i.html#activity-statistical-maps-i" id="toc-activity-statistical-maps-i"><span class="toc-section-number">4</span> Activity: Statistical Maps I<span></span></a>
<ul>
<li><a href="activity-statistical-maps-i.html#housekeeping-questions" id="toc-housekeeping-questions"><span class="toc-section-number">4.1</span> Housekeeping Questions<span></span></a></li>
<li><a href="activity-statistical-maps-i.html#learning-objectives-3" id="toc-learning-objectives-3"><span class="toc-section-number">4.2</span> Learning Objectives<span></span></a></li>
<li><a href="activity-statistical-maps-i.html#preliminaries-2" id="toc-preliminaries-2"><span class="toc-section-number">4.3</span> Preliminaries<span></span></a></li>
<li><a href="activity-statistical-maps-i.html#creating-a-simple-thematic-map" id="toc-creating-a-simple-thematic-map"><span class="toc-section-number">4.4</span> Creating a simple thematic map<span></span></a></li>
<li><a href="activity-statistical-maps-i.html#activity" id="toc-activity"><span class="toc-section-number">4.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="mapping-continued.html#mapping-continued" id="toc-mapping-continued"><span class="toc-section-number">5</span> Mapping in R: Continued<span></span></a>
<ul>
<li><a href="mapping-continued.html#learning-objectives-4" id="toc-learning-objectives-4"><span class="toc-section-number">5.1</span> Learning Objectives<span></span></a></li>
<li><a href="mapping-continued.html#suggested-readings-1" id="toc-suggested-readings-1"><span class="toc-section-number">5.2</span> Suggested Readings<span></span></a></li>
<li><a href="mapping-continued.html#preliminaries-3" id="toc-preliminaries-3"><span class="toc-section-number">5.3</span> Preliminaries<span></span></a></li>
<li><a href="mapping-continued.html#summarizing-a-dataframe" id="toc-summarizing-a-dataframe"><span class="toc-section-number">5.4</span> Summarizing a Dataframe<span></span></a></li>
<li><a href="mapping-continued.html#factors" id="toc-factors"><span class="toc-section-number">5.5</span> Factors<span></span></a></li>
<li><a href="mapping-continued.html#subsetting-data" id="toc-subsetting-data"><span class="toc-section-number">5.6</span> Subsetting Data<span></span></a></li>
<li><a href="mapping-continued.html#pipe-operator" id="toc-pipe-operator"><span class="toc-section-number">5.7</span> Pipe Operator<span></span></a></li>
<li><a href="mapping-continued.html#more-on-visualization" id="toc-more-on-visualization"><span class="toc-section-number">5.8</span> More on Visualization<span></span></a></li>
</ul></li>
<li><a href="activity-2-statistical-maps-ii.html#activity-2-statistical-maps-ii" id="toc-activity-2-statistical-maps-ii"><span class="toc-section-number">6</span> Activity 2: Statistical Maps II<span></span></a>
<ul>
<li><a href="activity-2-statistical-maps-ii.html#housekeeping-questions-1" id="toc-housekeeping-questions-1"><span class="toc-section-number">6.1</span> Housekeeping Questions<span></span></a></li>
<li><a href="activity-2-statistical-maps-ii.html#learning-objectives-5" id="toc-learning-objectives-5"><span class="toc-section-number">6.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-2-statistical-maps-ii.html#suggested-reading" id="toc-suggested-reading"><span class="toc-section-number">6.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-2-statistical-maps-ii.html#preliminaries-4" id="toc-preliminaries-4"><span class="toc-section-number">6.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-2-statistical-maps-ii.html#activity-1" id="toc-activity-1"><span class="toc-section-number">6.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="maps-as-processes.html#maps-as-processes" id="toc-maps-as-processes"><span class="toc-section-number">7</span> Maps as Processes: Null Landscapes, Spatial Processes, and Statistical Maps<span></span></a>
<ul>
<li><a href="maps-as-processes.html#learning-objectives-6" id="toc-learning-objectives-6"><span class="toc-section-number">7.1</span> Learning Objectives<span></span></a></li>
<li><a href="maps-as-processes.html#suggested-readings-2" id="toc-suggested-readings-2"><span class="toc-section-number">7.2</span> Suggested Readings<span></span></a></li>
<li><a href="maps-as-processes.html#preliminaries-5" id="toc-preliminaries-5"><span class="toc-section-number">7.3</span> Preliminaries<span></span></a></li>
<li><a href="maps-as-processes.html#random-numbers" id="toc-random-numbers"><span class="toc-section-number">7.4</span> Random Numbers<span></span></a></li>
<li><a href="maps-as-processes.html#null-landscapes" id="toc-null-landscapes"><span class="toc-section-number">7.5</span> Null Landscapes<span></span></a></li>
<li><a href="maps-as-processes.html#stochastic-processes" id="toc-stochastic-processes"><span class="toc-section-number">7.6</span> Stochastic Processes<span></span></a></li>
<li><a href="maps-as-processes.html#simulating-spatial-processes" id="toc-simulating-spatial-processes"><span class="toc-section-number">7.7</span> Simulating Spatial Processes<span></span></a></li>
<li><a href="maps-as-processes.html#processes-and-patterns" id="toc-processes-and-patterns"><span class="toc-section-number">7.8</span> Processes and Patterns<span></span></a></li>
</ul></li>
<li><a href="activity-3-maps-as-processes.html#activity-3-maps-as-processes" id="toc-activity-3-maps-as-processes"><span class="toc-section-number">8</span> Activity 3: Maps as Processes<span></span></a>
<ul>
<li><a href="activity-3-maps-as-processes.html#practice-questions" id="toc-practice-questions"><span class="toc-section-number">8.1</span> Practice Questions<span></span></a></li>
<li><a href="activity-3-maps-as-processes.html#learning-objectives-7" id="toc-learning-objectives-7"><span class="toc-section-number">8.2</span> Learning Objectives<span></span></a></li>
<li><a href="activity-3-maps-as-processes.html#suggested-reading-1" id="toc-suggested-reading-1"><span class="toc-section-number">8.3</span> Suggested Reading<span></span></a></li>
<li><a href="activity-3-maps-as-processes.html#preliminaries-6" id="toc-preliminaries-6"><span class="toc-section-number">8.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-3-maps-as-processes.html#activity-2" id="toc-activity-2"><span class="toc-section-number">8.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="#part-part-iii-analysis-of-point-patterns" id="toc-part-part-iii-analysis-of-point-patterns">(PART) Part III: Analysis of Point Patterns<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#point-pattern-analysis-i" id="toc-point-pattern-analysis-i"><span class="toc-section-number">9</span> Point Pattern Analysis I<span></span></a>
<ul>
<li><a href="point-pattern-analysis-i.html#learning-objectives-8" id="toc-learning-objectives-8"><span class="toc-section-number">9.1</span> Learning Objectives<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#suggested-readings-3" id="toc-suggested-readings-3"><span class="toc-section-number">9.2</span> Suggested Readings<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#preliminaries-7" id="toc-preliminaries-7"><span class="toc-section-number">9.3</span> Preliminaries<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#point-patterns" id="toc-point-patterns"><span class="toc-section-number">9.4</span> Point Patterns<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#processes-and-point-patterns" id="toc-processes-and-point-patterns"><span class="toc-section-number">9.5</span> Processes and Point Patterns<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#intensity-and-density" id="toc-intensity-and-density"><span class="toc-section-number">9.6</span> Intensity and Density<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#quadrats-and-density-maps" id="toc-quadrats-and-density-maps"><span class="toc-section-number">9.7</span> Quadrats and Density Maps<span></span></a></li>
<li><a href="point-pattern-analysis-i.html#defining-the-region-for-analysis" id="toc-defining-the-region-for-analysis"><span class="toc-section-number">9.8</span> Defining the Region for Analysis<span></span></a></li>
</ul></li>
<li><a href="activity-4-point-pattern-analysis-i.html#activity-4-point-pattern-analysis-i" id="toc-activity-4-point-pattern-analysis-i"><span class="toc-section-number">10</span> Activity 4: Point Pattern Analysis I<span></span></a>
<ul>
<li><a href="activity-4-point-pattern-analysis-i.html#practice-questions-1" id="toc-practice-questions-1"><span class="toc-section-number">10.1</span> Practice questions<span></span></a></li>
<li><a href="activity-4-point-pattern-analysis-i.html#learning-objectives-9" id="toc-learning-objectives-9"><span class="toc-section-number">10.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-4-point-pattern-analysis-i.html#suggested-reading-2" id="toc-suggested-reading-2"><span class="toc-section-number">10.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-4-point-pattern-analysis-i.html#preliminaries-8" id="toc-preliminaries-8"><span class="toc-section-number">10.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-4-point-pattern-analysis-i.html#activity-3" id="toc-activity-3"><span class="toc-section-number">10.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="point-patern-analysis-ii.html#point-patern-analysis-ii" id="toc-point-patern-analysis-ii"><span class="toc-section-number">11</span> Point Pattern Analysis II<span></span></a>
<ul>
<li><a href="point-patern-analysis-ii.html#learning-objectives-10" id="toc-learning-objectives-10"><span class="toc-section-number">11.1</span> Learning Objectives<span></span></a></li>
<li><a href="point-patern-analysis-ii.html#suggested-readings-4" id="toc-suggested-readings-4"><span class="toc-section-number">11.2</span> Suggested Readings<span></span></a></li>
<li><a href="point-patern-analysis-ii.html#preliminaries-9" id="toc-preliminaries-9"><span class="toc-section-number">11.3</span> Preliminaries<span></span></a></li>
<li><a href="point-patern-analysis-ii.html#a-quadrat-based-test-for-spatial-independence" id="toc-a-quadrat-based-test-for-spatial-independence"><span class="toc-section-number">11.4</span> A Quadrat-based Test for Spatial Independence<span></span></a></li>
<li><a href="point-patern-analysis-ii.html#limitations-of-quadrat-analysis-size-and-number-of-quadrats" id="toc-limitations-of-quadrat-analysis-size-and-number-of-quadrats"><span class="toc-section-number">11.5</span> Limitations of Quadrat Analysis: Size and Number of Quadrats<span></span></a></li>
<li><a href="point-patern-analysis-ii.html#limitations-of-quadrat-analysis-relative-position-of-events" id="toc-limitations-of-quadrat-analysis-relative-position-of-events"><span class="toc-section-number">11.6</span> Limitations of Quadrat Analysis: Relative Position of Events<span></span></a></li>
<li><a href="point-patern-analysis-ii.html#kernel-density" id="toc-kernel-density"><span class="toc-section-number">11.7</span> Kernel Density<span></span></a></li>
</ul></li>
<li><a href="activity-5-point-pattern-analysis-ii.html#activity-5-point-pattern-analysis-ii" id="toc-activity-5-point-pattern-analysis-ii"><span class="toc-section-number">12</span> Activity 5: Point Pattern Analysis II<span></span></a>
<ul>
<li><a href="activity-5-point-pattern-analysis-ii.html#practice-questions-2" id="toc-practice-questions-2"><span class="toc-section-number">12.1</span> Practice questions<span></span></a></li>
<li><a href="activity-5-point-pattern-analysis-ii.html#learning-objectives-11" id="toc-learning-objectives-11"><span class="toc-section-number">12.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-5-point-pattern-analysis-ii.html#suggested-reading-3" id="toc-suggested-reading-3"><span class="toc-section-number">12.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-5-point-pattern-analysis-ii.html#preliminaries-10" id="toc-preliminaries-10"><span class="toc-section-number">12.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-5-point-pattern-analysis-ii.html#activity-4" id="toc-activity-4"><span class="toc-section-number">12.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="point-pattern-analysis-iii.html#point-pattern-analysis-iii" id="toc-point-pattern-analysis-iii"><span class="toc-section-number">13</span> Point Pattern Analysis III<span></span></a>
<ul>
<li><a href="point-pattern-analysis-iii.html#learning-objectives-12" id="toc-learning-objectives-12"><span class="toc-section-number">13.1</span> Learning Objectives<span></span></a></li>
<li><a href="point-pattern-analysis-iii.html#suggested-readings-5" id="toc-suggested-readings-5"><span class="toc-section-number">13.2</span> Suggested Readings<span></span></a></li>
<li><a href="point-pattern-analysis-iii.html#preliminaries-11" id="toc-preliminaries-11"><span class="toc-section-number">13.3</span> Preliminaries<span></span></a></li>
<li><a href="point-pattern-analysis-iii.html#motivation" id="toc-motivation"><span class="toc-section-number">13.4</span> Motivation<span></span></a></li>
<li><a href="point-pattern-analysis-iii.html#nearest-neighbors" id="toc-nearest-neighbors"><span class="toc-section-number">13.5</span> Nearest Neighbors<span></span></a></li>
<li><a href="point-pattern-analysis-iii.html#g-function" id="toc-g-function"><span class="toc-section-number">13.6</span> <span class="math inline">\(G\)</span>-function<span></span></a></li>
</ul></li>
<li><a href="activity-6-point-pattern-analysis-iii.html#activity-6-point-pattern-analysis-iii" id="toc-activity-6-point-pattern-analysis-iii"><span class="toc-section-number">14</span> Activity 6: Point Pattern Analysis III<span></span></a>
<ul>
<li><a href="activity-6-point-pattern-analysis-iii.html#practice-questions-3" id="toc-practice-questions-3"><span class="toc-section-number">14.1</span> Practice questions<span></span></a></li>
<li><a href="activity-6-point-pattern-analysis-iii.html#learning-objectives-13" id="toc-learning-objectives-13"><span class="toc-section-number">14.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-6-point-pattern-analysis-iii.html#suggested-reading-4" id="toc-suggested-reading-4"><span class="toc-section-number">14.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-6-point-pattern-analysis-iii.html#preliminaries-12" id="toc-preliminaries-12"><span class="toc-section-number">14.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-6-point-pattern-analysis-iii.html#activity-5" id="toc-activity-5"><span class="toc-section-number">14.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="point-pattern-analysis-iv.html#point-pattern-analysis-iv" id="toc-point-pattern-analysis-iv"><span class="toc-section-number">15</span> Point Pattern Analysis IV<span></span></a>
<ul>
<li><a href="point-pattern-analysis-iv.html#learning-objectives-14" id="toc-learning-objectives-14"><span class="toc-section-number">15.1</span> Learning Objectives<span></span></a></li>
<li><a href="point-pattern-analysis-iv.html#suggested-readings-6" id="toc-suggested-readings-6"><span class="toc-section-number">15.2</span> Suggested Readings<span></span></a></li>
<li><a href="point-pattern-analysis-iv.html#preliminaries-13" id="toc-preliminaries-13"><span class="toc-section-number">15.3</span> Preliminaries<span></span></a></li>
<li><a href="point-pattern-analysis-iv.html#motivation-1" id="toc-motivation-1"><span class="toc-section-number">15.4</span> Motivation<span></span></a></li>
<li><a href="point-pattern-analysis-iv.html#f-function" id="toc-f-function"><span class="toc-section-number">15.5</span> F-function<span></span></a></li>
<li><a href="point-pattern-analysis-iv.html#hatk-function" id="toc-hatk-function"><span class="toc-section-number">15.6</span> <span class="math inline">\(\hat{K}\)</span>-function<span></span></a></li>
</ul></li>
<li><a href="activity-7-point-pattern-analysis-iv.html#activity-7-point-pattern-analysis-iv" id="toc-activity-7-point-pattern-analysis-iv"><span class="toc-section-number">16</span> Activity 7: Point Pattern Analysis IV<span></span></a>
<ul>
<li><a href="activity-7-point-pattern-analysis-iv.html#practice-questions-4" id="toc-practice-questions-4"><span class="toc-section-number">16.1</span> Practice questions<span></span></a></li>
<li><a href="activity-7-point-pattern-analysis-iv.html#learning-objectives-15" id="toc-learning-objectives-15"><span class="toc-section-number">16.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-7-point-pattern-analysis-iv.html#suggested-reading-5" id="toc-suggested-reading-5"><span class="toc-section-number">16.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-7-point-pattern-analysis-iv.html#preliminaries-14" id="toc-preliminaries-14"><span class="toc-section-number">16.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-7-point-pattern-analysis-iv.html#activity-6" id="toc-activity-6"><span class="toc-section-number">16.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="point-pattern-analysis-v.html#point-pattern-analysis-v" id="toc-point-pattern-analysis-v"><span class="toc-section-number">17</span> Point Pattern Analysis V<span></span></a>
<ul>
<li><a href="point-pattern-analysis-v.html#learning-objectives-16" id="toc-learning-objectives-16"><span class="toc-section-number">17.1</span> Learning Objectives<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#suggested-readings-7" id="toc-suggested-readings-7"><span class="toc-section-number">17.2</span> Suggested Readings<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#preliminaries-15" id="toc-preliminaries-15"><span class="toc-section-number">17.3</span> Preliminaries<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#motivation-hypothesis-testing" id="toc-motivation-hypothesis-testing"><span class="toc-section-number">17.4</span> Motivation: Hypothesis Testing<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#null-landscapes-revisited" id="toc-null-landscapes-revisited"><span class="toc-section-number">17.5</span> Null Landscapes Revisited<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#simulation-envelopes" id="toc-simulation-envelopes"><span class="toc-section-number">17.6</span> Simulation Envelopes<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#things-to-keep-in-mind" id="toc-things-to-keep-in-mind"><span class="toc-section-number">17.7</span> Things to Keep in Mind!<span></span></a>
<ul>
<li><a href="point-pattern-analysis-v.html#definition-of-a-region" id="toc-definition-of-a-region"><span class="toc-section-number">17.7.1</span> Definition of a Region<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#edge-effects" id="toc-edge-effects"><span class="toc-section-number">17.7.2</span> Edge Effects<span></span></a></li>
<li><a href="point-pattern-analysis-v.html#sampled-point-patterns" id="toc-sampled-point-patterns"><span class="toc-section-number">17.7.3</span> Sampled Point Patterns<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="activity-8-point-pattern-analysis-v.html#activity-8-point-pattern-analysis-v" id="toc-activity-8-point-pattern-analysis-v"><span class="toc-section-number">18</span> Activity 8: Point Pattern Analysis V<span></span></a>
<ul>
<li><a href="activity-8-point-pattern-analysis-v.html#practice-questions-5" id="toc-practice-questions-5"><span class="toc-section-number">18.1</span> Practice questions<span></span></a></li>
<li><a href="activity-8-point-pattern-analysis-v.html#learning-objectives-17" id="toc-learning-objectives-17"><span class="toc-section-number">18.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-8-point-pattern-analysis-v.html#suggested-reading-6" id="toc-suggested-reading-6"><span class="toc-section-number">18.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-8-point-pattern-analysis-v.html#preliminaries-16" id="toc-preliminaries-16"><span class="toc-section-number">18.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-8-point-pattern-analysis-v.html#activity-7" id="toc-activity-7"><span class="toc-section-number">18.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="#part-part-iv-data-in-areal-units" id="toc-part-part-iv-data-in-areal-units">(PART) Part IV: Data in Areal Units<span></span></a></li>
<li><a href="area-data-i.html#area-data-i" id="toc-area-data-i"><span class="toc-section-number">19</span> Area Data I<span></span></a>
<ul>
<li><a href="area-data-i.html#learning-objectives-18" id="toc-learning-objectives-18"><span class="toc-section-number">19.1</span> Learning Objectives<span></span></a></li>
<li><a href="area-data-i.html#suggested-readings-8" id="toc-suggested-readings-8"><span class="toc-section-number">19.2</span> Suggested Readings<span></span></a></li>
<li><a href="area-data-i.html#preliminaries-17" id="toc-preliminaries-17"><span class="toc-section-number">19.3</span> Preliminaries<span></span></a></li>
<li><a href="area-data-i.html#area-data" id="toc-area-data"><span class="toc-section-number">19.4</span> Area Data<span></span></a></li>
<li><a href="area-data-i.html#processes-and-area-data" id="toc-processes-and-area-data"><span class="toc-section-number">19.5</span> Processes and Area Data<span></span></a></li>
<li><a href="area-data-i.html#visualizing-area-data-choropleth-maps" id="toc-visualizing-area-data-choropleth-maps"><span class="toc-section-number">19.6</span> Visualizing Area Data: Choropleth Maps<span></span></a></li>
<li><a href="area-data-i.html#visualizing-area-data-cartograms" id="toc-visualizing-area-data-cartograms"><span class="toc-section-number">19.7</span> Visualizing Area Data: Cartograms<span></span></a></li>
</ul></li>
<li><a href="activity-9-area-data-i.html#activity-9-area-data-i" id="toc-activity-9-area-data-i"><span class="toc-section-number">20</span> Activity 9: Area Data I<span></span></a>
<ul>
<li><a href="activity-9-area-data-i.html#practice-questions-6" id="toc-practice-questions-6"><span class="toc-section-number">20.1</span> Practice questions<span></span></a></li>
<li><a href="activity-9-area-data-i.html#learning-objectives-19" id="toc-learning-objectives-19"><span class="toc-section-number">20.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-9-area-data-i.html#suggested-reading-7" id="toc-suggested-reading-7"><span class="toc-section-number">20.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-9-area-data-i.html#preliminaries-18" id="toc-preliminaries-18"><span class="toc-section-number">20.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-9-area-data-i.html#activity-8" id="toc-activity-8"><span class="toc-section-number">20.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="area-data-ii.html#area-data-ii" id="toc-area-data-ii"><span class="toc-section-number">21</span> Area Data II<span></span></a>
<ul>
<li><a href="area-data-ii.html#learning-objectives-20" id="toc-learning-objectives-20"><span class="toc-section-number">21.1</span> Learning Objectives<span></span></a></li>
<li><a href="area-data-ii.html#suggested-readings-9" id="toc-suggested-readings-9"><span class="toc-section-number">21.2</span> Suggested Readings<span></span></a></li>
<li><a href="area-data-ii.html#preliminaries-19" id="toc-preliminaries-19"><span class="toc-section-number">21.3</span> Preliminaries<span></span></a></li>
<li><a href="area-data-ii.html#proximity-in-area-data" id="toc-proximity-in-area-data"><span class="toc-section-number">21.4</span> Proximity in Area Data<span></span></a></li>
<li><a href="area-data-ii.html#spatial-weights-matrices" id="toc-spatial-weights-matrices"><span class="toc-section-number">21.5</span> Spatial Weights Matrices<span></span></a></li>
<li><a href="area-data-ii.html#creating-spatial-weights-matrices-in-r" id="toc-creating-spatial-weights-matrices-in-r"><span class="toc-section-number">21.6</span> Creating Spatial Weights Matrices in <code>R</code><span></span></a></li>
<li><a href="area-data-ii.html#spatial-moving-averages" id="toc-spatial-moving-averages"><span class="toc-section-number">21.7</span> Spatial Moving Averages<span></span></a></li>
<li><a href="area-data-ii.html#other-criteria-for-coding-proximity" id="toc-other-criteria-for-coding-proximity"><span class="toc-section-number">21.8</span> Other Criteria for Coding Proximity<span></span></a></li>
</ul></li>
<li><a href="activity-10-area-data-ii.html#activity-10-area-data-ii" id="toc-activity-10-area-data-ii"><span class="toc-section-number">22</span> Activity 10: Area Data II<span></span></a>
<ul>
<li><a href="activity-10-area-data-ii.html#practice-questions-7" id="toc-practice-questions-7"><span class="toc-section-number">22.1</span> Practice questions<span></span></a></li>
<li><a href="activity-10-area-data-ii.html#learning-objectives-21" id="toc-learning-objectives-21"><span class="toc-section-number">22.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-10-area-data-ii.html#suggested-reading-8" id="toc-suggested-reading-8"><span class="toc-section-number">22.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-10-area-data-ii.html#preliminaries-20" id="toc-preliminaries-20"><span class="toc-section-number">22.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-10-area-data-ii.html#activity-9" id="toc-activity-9"><span class="toc-section-number">22.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="area-data-iii.html#area-data-iii" id="toc-area-data-iii"><span class="toc-section-number">23</span> Area Data III<span></span></a>
<ul>
<li><a href="area-data-iii.html#learning-objectives-22" id="toc-learning-objectives-22"><span class="toc-section-number">23.1</span> Learning Objectives<span></span></a></li>
<li><a href="area-data-iii.html#suggested-readings-10" id="toc-suggested-readings-10"><span class="toc-section-number">23.2</span> Suggested Readings<span></span></a></li>
<li><a href="area-data-iii.html#preliminaries-21" id="toc-preliminaries-21"><span class="toc-section-number">23.3</span> Preliminaries<span></span></a></li>
<li><a href="area-data-iii.html#spatial-moving-averages-and-simulation" id="toc-spatial-moving-averages-and-simulation"><span class="toc-section-number">23.4</span> Spatial Moving Averages and Simulation<span></span></a></li>
<li><a href="area-data-iii.html#the-spatial-moving-average-as-a-smoother" id="toc-the-spatial-moving-average-as-a-smoother"><span class="toc-section-number">23.5</span> The Spatial Moving Average as a Smoother<span></span></a></li>
<li><a href="area-data-iii.html#spatial-moving-average-scatterplots" id="toc-spatial-moving-average-scatterplots"><span class="toc-section-number">23.6</span> Spatial Moving Average Scatterplots<span></span></a></li>
<li><a href="area-data-iii.html#spatial-autocorrelation-and-morans-i-coefficient" id="toc-spatial-autocorrelation-and-morans-i-coefficient"><span class="toc-section-number">23.7</span> Spatial Autocorrelation and Moran’s <span class="math inline">\(I\)</span> coefficient<span></span></a></li>
<li><a href="area-data-iii.html#morans-i-and-morans-scatterplot" id="toc-morans-i-and-morans-scatterplot"><span class="toc-section-number">23.8</span> Moran’s <span class="math inline">\(I\)</span> and Moran’s Scatterplot<span></span></a></li>
<li><a href="area-data-iii.html#hypothesis-testing-for-spatial-autocorrelation" id="toc-hypothesis-testing-for-spatial-autocorrelation"><span class="toc-section-number">23.9</span> Hypothesis Testing for Spatial Autocorrelation<span></span></a></li>
</ul></li>
<li><a href="activity-11-area-data-iii.html#activity-11-area-data-iii" id="toc-activity-11-area-data-iii"><span class="toc-section-number">24</span> Activity 11: Area Data III<span></span></a>
<ul>
<li><a href="activity-11-area-data-iii.html#practice-questions-8" id="toc-practice-questions-8"><span class="toc-section-number">24.1</span> Practice questions<span></span></a></li>
<li><a href="activity-11-area-data-iii.html#learning-objectives-23" id="toc-learning-objectives-23"><span class="toc-section-number">24.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-11-area-data-iii.html#suggested-reading-9" id="toc-suggested-reading-9"><span class="toc-section-number">24.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-11-area-data-iii.html#preliminaries-22" id="toc-preliminaries-22"><span class="toc-section-number">24.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-11-area-data-iii.html#activity-10" id="toc-activity-10"><span class="toc-section-number">24.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="area-data-iv.html#area-data-iv" id="toc-area-data-iv"><span class="toc-section-number">25</span> Area Data IV<span></span></a>
<ul>
<li><a href="area-data-iv.html#learning-objectives-24" id="toc-learning-objectives-24"><span class="toc-section-number">25.1</span> Learning objectives<span></span></a></li>
<li><a href="area-data-iv.html#suggested-readings-11" id="toc-suggested-readings-11"><span class="toc-section-number">25.2</span> Suggested readings<span></span></a></li>
<li><a href="area-data-iv.html#preliminaries-23" id="toc-preliminaries-23"><span class="toc-section-number">25.3</span> Preliminaries<span></span></a></li>
<li><a href="area-data-iv.html#decomposing-morans-i" id="toc-decomposing-morans-i"><span class="toc-section-number">25.4</span> Decomposing Moran’s <span class="math inline">\(I\)</span><span></span></a></li>
<li><a href="area-data-iv.html#local-morans-i-and-mapping" id="toc-local-morans-i-and-mapping"><span class="toc-section-number">25.5</span> Local Moran’s <span class="math inline">\(I\)</span> and Mapping<span></span></a></li>
<li><a href="area-data-iv.html#a-quick-note-on-functions" id="toc-a-quick-note-on-functions"><span class="toc-section-number">25.6</span> A Quick Note on Functions<span></span></a></li>
<li><a href="area-data-iv.html#a-concentration-approach-for-local-analysis-of-spatial-association" id="toc-a-concentration-approach-for-local-analysis-of-spatial-association"><span class="toc-section-number">25.7</span> A Concentration approach for Local Analysis of Spatial Association<span></span></a></li>
<li><a href="area-data-iv.html#a-short-note-on-hypothesis-testing" id="toc-a-short-note-on-hypothesis-testing"><span class="toc-section-number">25.8</span> A Short Note on Hypothesis Testing<span></span></a></li>
<li><a href="area-data-iv.html#detection-of-hot-and-cold-spots" id="toc-detection-of-hot-and-cold-spots"><span class="toc-section-number">25.9</span> Detection of Hot and Cold Spots<span></span></a></li>
<li><a href="area-data-iv.html#other-resources-1" id="toc-other-resources-1"><span class="toc-section-number">25.10</span> Other Resources<span></span></a></li>
</ul></li>
<li><a href="activity-12-area-data-iv.html#activity-12-area-data-iv" id="toc-activity-12-area-data-iv"><span class="toc-section-number">26</span> Activity 12: Area Data IV<span></span></a>
<ul>
<li><a href="activity-12-area-data-iv.html#practice-questions-9" id="toc-practice-questions-9"><span class="toc-section-number">26.1</span> Practice questions<span></span></a></li>
<li><a href="activity-12-area-data-iv.html#learning-objectives-25" id="toc-learning-objectives-25"><span class="toc-section-number">26.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-12-area-data-iv.html#suggested-reading-10" id="toc-suggested-reading-10"><span class="toc-section-number">26.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-12-area-data-iv.html#preliminaries-24" id="toc-preliminaries-24"><span class="toc-section-number">26.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-12-area-data-iv.html#activity-11" id="toc-activity-11"><span class="toc-section-number">26.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="area-data-v.html#area-data-v" id="toc-area-data-v"><span class="toc-section-number">27</span> Area Data V<span></span></a>
<ul>
<li><a href="area-data-v.html#learning-objectives-26" id="toc-learning-objectives-26"><span class="toc-section-number">27.1</span> Learning Objectives<span></span></a></li>
<li><a href="area-data-v.html#suggested-readings-12" id="toc-suggested-readings-12"><span class="toc-section-number">27.2</span> Suggested Readings<span></span></a></li>
<li><a href="area-data-v.html#preliminaries-25" id="toc-preliminaries-25"><span class="toc-section-number">27.3</span> Preliminaries<span></span></a></li>
<li><a href="area-data-v.html#regression-analysis-in-r" id="toc-regression-analysis-in-r"><span class="toc-section-number">27.4</span> Regression Analysis in <code>R</code><span></span></a></li>
<li><a href="area-data-v.html#autocorrelation-as-a-model-diagnostic" id="toc-autocorrelation-as-a-model-diagnostic"><span class="toc-section-number">27.5</span> Autocorrelation as a Model Diagnostic<span></span></a></li>
<li><a href="area-data-v.html#variable-transformations" id="toc-variable-transformations"><span class="toc-section-number">27.6</span> Variable Transformations<span></span></a></li>
<li><a href="area-data-v.html#a-note-about-spatial-autocorrelation-in-regression-analysis" id="toc-a-note-about-spatial-autocorrelation-in-regression-analysis"><span class="toc-section-number">27.7</span> A Note about Spatial Autocorrelation in Regression Analysis<span></span></a></li>
</ul></li>
<li><a href="activity-13-area-data-v.html#activity-13-area-data-v" id="toc-activity-13-area-data-v"><span class="toc-section-number">28</span> Activity 13: Area Data V<span></span></a>
<ul>
<li><a href="activity-13-area-data-v.html#practice-questions-10" id="toc-practice-questions-10"><span class="toc-section-number">28.1</span> Practice questions<span></span></a></li>
<li><a href="activity-13-area-data-v.html#learning-objectives-27" id="toc-learning-objectives-27"><span class="toc-section-number">28.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-13-area-data-v.html#suggested-reading-11" id="toc-suggested-reading-11"><span class="toc-section-number">28.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-13-area-data-v.html#preliminaries-26" id="toc-preliminaries-26"><span class="toc-section-number">28.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-13-area-data-v.html#activity-12" id="toc-activity-12"><span class="toc-section-number">28.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="area-data-vi.html#area-data-vi" id="toc-area-data-vi"><span class="toc-section-number">29</span> Area Data VI<span></span></a>
<ul>
<li><a href="area-data-vi.html#learning-objectives-28" id="toc-learning-objectives-28"><span class="toc-section-number">29.1</span> Learning Objectives<span></span></a></li>
<li><a href="area-data-vi.html#suggested-readings-13" id="toc-suggested-readings-13"><span class="toc-section-number">29.2</span> Suggested Readings<span></span></a></li>
<li><a href="area-data-vi.html#preliminaries-27" id="toc-preliminaries-27"><span class="toc-section-number">29.3</span> Preliminaries<span></span></a></li>
<li><a href="area-data-vi.html#residual-spatial-autocorrelation-revisited" id="toc-residual-spatial-autocorrelation-revisited"><span class="toc-section-number">29.4</span> Residual spatial autocorrelation revisited<span></span></a>
<ul>
<li><a href="area-data-vi.html#incorrect-functional-form" id="toc-incorrect-functional-form"><span class="toc-section-number">29.4.1</span> Incorrect Functional Form<span></span></a></li>
<li><a href="area-data-vi.html#omitted-variables" id="toc-omitted-variables"><span class="toc-section-number">29.4.2</span> Omitted Variables<span></span></a></li>
</ul></li>
<li><a href="area-data-vi.html#remedial-action" id="toc-remedial-action"><span class="toc-section-number">29.5</span> Remedial Action<span></span></a></li>
<li><a href="area-data-vi.html#flexible-functional-forms-and-models-with-spatially-varying-coefficients" id="toc-flexible-functional-forms-and-models-with-spatially-varying-coefficients"><span class="toc-section-number">29.6</span> Flexible Functional Forms and Models with Spatially-varying Coefficients<span></span></a>
<ul>
<li><a href="area-data-vi.html#trend-surface-analysis" id="toc-trend-surface-analysis"><span class="toc-section-number">29.6.1</span> Trend Surface Analysis<span></span></a></li>
<li><a href="area-data-vi.html#models-with-spatially-varying-coefficients" id="toc-models-with-spatially-varying-coefficients"><span class="toc-section-number">29.6.2</span> Models with Spatially-varying Coefficients<span></span></a></li>
</ul></li>
<li><a href="area-data-vi.html#spatial-error-model-sem" id="toc-spatial-error-model-sem"><span class="toc-section-number">29.7</span> Spatial Error Model (SEM)<span></span></a></li>
</ul></li>
<li><a href="activity-14-area-data-vi.html#activity-14-area-data-vi" id="toc-activity-14-area-data-vi"><span class="toc-section-number">30</span> Activity 14: Area Data VI<span></span></a>
<ul>
<li><a href="activity-14-area-data-vi.html#practice-questions-11" id="toc-practice-questions-11"><span class="toc-section-number">30.1</span> Practice questions<span></span></a></li>
<li><a href="activity-14-area-data-vi.html#learning-objectives-29" id="toc-learning-objectives-29"><span class="toc-section-number">30.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-14-area-data-vi.html#suggested-reading-12" id="toc-suggested-reading-12"><span class="toc-section-number">30.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-14-area-data-vi.html#preliminaries-28" id="toc-preliminaries-28"><span class="toc-section-number">30.4</span> Preliminaries<span></span></a>
<ul>
<li><a href="activity-14-area-data-vi.html#new-york-leukemia-data" id="toc-new-york-leukemia-data"><span class="toc-section-number">30.4.1</span> New York leukemia data<span></span></a></li>
<li><a href="activity-14-area-data-vi.html#pennsylvania-lung-cancer" id="toc-pennsylvania-lung-cancer"><span class="toc-section-number">30.4.2</span> Pennsylvania lung cancer<span></span></a></li>
</ul></li>
<li><a href="activity-14-area-data-vi.html#activity-13" id="toc-activity-13"><span class="toc-section-number">30.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="#part-part-v-analysis-and-prediction-of-fields" id="toc-part-part-v-analysis-and-prediction-of-fields">(PART) Part V: Analysis and Prediction of Fields<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#spatially-continuous-data-i" id="toc-spatially-continuous-data-i"><span class="toc-section-number">31</span> Spatially Continuous Data I<span></span></a>
<ul>
<li><a href="spatially-continuous-data-i.html#learning-objectives-30" id="toc-learning-objectives-30"><span class="toc-section-number">31.1</span> Learning objectives<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#suggested-readings-14" id="toc-suggested-readings-14"><span class="toc-section-number">31.2</span> Suggested readings<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#preliminaries-29" id="toc-preliminaries-29"><span class="toc-section-number">31.3</span> Preliminaries<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#spatially-continuous-field-data" id="toc-spatially-continuous-field-data"><span class="toc-section-number">31.4</span> Spatially continuous (field) data<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#exploratory-visualization" id="toc-exploratory-visualization"><span class="toc-section-number">31.5</span> Exploratory visualization<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#tile-based-methods" id="toc-tile-based-methods"><span class="toc-section-number">31.6</span> Tile-based methods<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#inverse-distance-weighting-idw" id="toc-inverse-distance-weighting-idw"><span class="toc-section-number">31.7</span> Inverse distance weighting (IDW)<span></span></a></li>
<li><a href="spatially-continuous-data-i.html#k-point-means" id="toc-k-point-means"><span class="toc-section-number">31.8</span> <span class="math inline">\(k\)</span>-point means<span></span></a></li>
</ul></li>
<li><a href="activity-15-spatially-continuous-data-i.html#activity-15-spatially-continuous-data-i" id="toc-activity-15-spatially-continuous-data-i"><span class="toc-section-number">32</span> Activity 15: Spatially Continuous Data I<span></span></a>
<ul>
<li><a href="activity-15-spatially-continuous-data-i.html#practice-questions-12" id="toc-practice-questions-12"><span class="toc-section-number">32.1</span> Practice questions<span></span></a></li>
<li><a href="activity-15-spatially-continuous-data-i.html#learning-objectives-31" id="toc-learning-objectives-31"><span class="toc-section-number">32.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-15-spatially-continuous-data-i.html#suggested-reading-13" id="toc-suggested-reading-13"><span class="toc-section-number">32.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-15-spatially-continuous-data-i.html#preliminaries-30" id="toc-preliminaries-30"><span class="toc-section-number">32.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-15-spatially-continuous-data-i.html#activity-14" id="toc-activity-14"><span class="toc-section-number">32.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="spatially-continuous-data-ii.html#spatially-continuous-data-ii" id="toc-spatially-continuous-data-ii"><span class="toc-section-number">33</span> Spatially Continuous Data II<span></span></a>
<ul>
<li><a href="spatially-continuous-data-ii.html#learning-objectives-32" id="toc-learning-objectives-32"><span class="toc-section-number">33.1</span> Learning objectives<span></span></a></li>
<li><a href="spatially-continuous-data-ii.html#suggested-readings-15" id="toc-suggested-readings-15"><span class="toc-section-number">33.2</span> Suggested readings<span></span></a></li>
<li><a href="spatially-continuous-data-ii.html#preliminaries-31" id="toc-preliminaries-31"><span class="toc-section-number">33.3</span> Preliminaries<span></span></a></li>
<li><a href="spatially-continuous-data-ii.html#uncertainty-in-the-predictions" id="toc-uncertainty-in-the-predictions"><span class="toc-section-number">33.4</span> Uncertainty in the predictions<span></span></a></li>
<li><a href="spatially-continuous-data-ii.html#trend-surface-analysis-1" id="toc-trend-surface-analysis-1"><span class="toc-section-number">33.5</span> Trend surface analysis<span></span></a></li>
<li><a href="spatially-continuous-data-ii.html#accuracy-and-precision" id="toc-accuracy-and-precision"><span class="toc-section-number">33.6</span> Accuracy and precision<span></span></a></li>
</ul></li>
<li><a href="activity-16-spatially-continuous-data-ii.html#activity-16-spatially-continuous-data-ii" id="toc-activity-16-spatially-continuous-data-ii"><span class="toc-section-number">34</span> Activity 16: Spatially Continuous Data II<span></span></a>
<ul>
<li><a href="activity-16-spatially-continuous-data-ii.html#practice-questions-13" id="toc-practice-questions-13"><span class="toc-section-number">34.1</span> Practice questions<span></span></a></li>
<li><a href="activity-16-spatially-continuous-data-ii.html#learning-objectives-33" id="toc-learning-objectives-33"><span class="toc-section-number">34.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-16-spatially-continuous-data-ii.html#suggested-reading-14" id="toc-suggested-reading-14"><span class="toc-section-number">34.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-16-spatially-continuous-data-ii.html#preliminaries-32" id="toc-preliminaries-32"><span class="toc-section-number">34.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-16-spatially-continuous-data-ii.html#activity-15" id="toc-activity-15"><span class="toc-section-number">34.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="spatially-continuous-data-iii.html#spatially-continuous-data-iii" id="toc-spatially-continuous-data-iii"><span class="toc-section-number">35</span> Spatially Continuous Data III<span></span></a>
<ul>
<li><a href="spatially-continuous-data-iii.html#learning-objectives-34" id="toc-learning-objectives-34"><span class="toc-section-number">35.1</span> Learning objectives<span></span></a></li>
<li><a href="spatially-continuous-data-iii.html#suggested-reading-15" id="toc-suggested-reading-15"><span class="toc-section-number">35.2</span> Suggested reading<span></span></a></li>
<li><a href="spatially-continuous-data-iii.html#preliminaries-33" id="toc-preliminaries-33"><span class="toc-section-number">35.3</span> Preliminaries<span></span></a></li>
<li><a href="spatially-continuous-data-iii.html#residual-spatial-pattern" id="toc-residual-spatial-pattern"><span class="toc-section-number">35.4</span> Residual spatial pattern<span></span></a></li>
<li><a href="spatially-continuous-data-iii.html#measuring-spatial-dependence-in-spatially-continuous-data" id="toc-measuring-spatial-dependence-in-spatially-continuous-data"><span class="toc-section-number">35.5</span> Measuring spatial dependence in spatially continuous data<span></span></a></li>
<li><a href="spatially-continuous-data-iii.html#variographic-analyisis" id="toc-variographic-analyisis"><span class="toc-section-number">35.6</span> Variographic analyisis<span></span></a></li>
</ul></li>
<li><a href="activity-17-spatially-continuous-data-iii.html#activity-17-spatially-continuous-data-iii" id="toc-activity-17-spatially-continuous-data-iii"><span class="toc-section-number">36</span> Activity 17: Spatially Continuous Data III<span></span></a>
<ul>
<li><a href="activity-17-spatially-continuous-data-iii.html#practice-questions-14" id="toc-practice-questions-14"><span class="toc-section-number">36.1</span> Practice questions<span></span></a></li>
<li><a href="activity-17-spatially-continuous-data-iii.html#learning-objectives-35" id="toc-learning-objectives-35"><span class="toc-section-number">36.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-17-spatially-continuous-data-iii.html#suggested-reading-16" id="toc-suggested-reading-16"><span class="toc-section-number">36.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-17-spatially-continuous-data-iii.html#preliminaries-34" id="toc-preliminaries-34"><span class="toc-section-number">36.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-17-spatially-continuous-data-iii.html#activity-16" id="toc-activity-16"><span class="toc-section-number">36.5</span> Activity<span></span></a></li>
</ul></li>
<li><a href="spatially-continuous-data-iv.html#spatially-continuous-data-iv" id="toc-spatially-continuous-data-iv"><span class="toc-section-number">37</span> Spatially Continuous Data IV<span></span></a>
<ul>
<li><a href="spatially-continuous-data-iv.html#learning-objectives-36" id="toc-learning-objectives-36"><span class="toc-section-number">37.1</span> Learning objectives<span></span></a></li>
<li><a href="spatially-continuous-data-iv.html#suggested-reading-17" id="toc-suggested-reading-17"><span class="toc-section-number">37.2</span> Suggested reading<span></span></a></li>
<li><a href="spatially-continuous-data-iv.html#preliminaries-35" id="toc-preliminaries-35"><span class="toc-section-number">37.3</span> Preliminaries<span></span></a></li>
<li><a href="spatially-continuous-data-iv.html#using-residual-spatial-pattern-to-estimate-prediction-errors" id="toc-using-residual-spatial-pattern-to-estimate-prediction-errors"><span class="toc-section-number">37.4</span> Using residual spatial pattern to estimate prediction errors<span></span></a></li>
<li><a href="spatially-continuous-data-iv.html#kriging-a-method-for-optimal-prediction." id="toc-kriging-a-method-for-optimal-prediction."><span class="toc-section-number">37.5</span> Kriging: a method for optimal prediction.<span></span></a></li>
</ul></li>
<li><a href="activity-18-spatially-continuous-data-iv.html#activity-18-spatially-continuous-data-iv" id="toc-activity-18-spatially-continuous-data-iv"><span class="toc-section-number">38</span> Activity 18: Spatially Continuous Data IV<span></span></a>
<ul>
<li><a href="activity-18-spatially-continuous-data-iv.html#practice-questions-15" id="toc-practice-questions-15"><span class="toc-section-number">38.1</span> Practice questions<span></span></a></li>
<li><a href="activity-18-spatially-continuous-data-iv.html#learning-objectives-37" id="toc-learning-objectives-37"><span class="toc-section-number">38.2</span> Learning objectives<span></span></a></li>
<li><a href="activity-18-spatially-continuous-data-iv.html#suggested-reading-18" id="toc-suggested-reading-18"><span class="toc-section-number">38.3</span> Suggested reading<span></span></a></li>
<li><a href="activity-18-spatially-continuous-data-iv.html#preliminaries-36" id="toc-preliminaries-36"><span class="toc-section-number">38.4</span> Preliminaries<span></span></a></li>
<li><a href="activity-18-spatially-continuous-data-iv.html#activity-17" id="toc-activity-17"><span class="toc-section-number">38.5</span> Activity<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/paezha/spatial-analysis-R" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Spatial Data Analysis and Statistics: A Course in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatially-continuous-data-iii" class="section level1 hasAnchor" number="35">
<h1><span class="header-section-number">Chapter 35</span> Spatially Continuous Data III<a href="spatially-continuous-data-iii.html#spatially-continuous-data-iii" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>NOTE</em>: The source files for this book are available with companion package <a href="https://paezha.github.io/isdas/">{isdas}</a>. The source files are in Rmarkdown format and packed as templates. These files allow you execute code within the notebook, so that you can work interactively with the notes.</p>
<p>In the previous practice you were introduced to the concept of fields/spatially continuous data.</p>
<div id="learning-objectives-34" class="section level2 hasAnchor" number="35.1">
<h2><span class="header-section-number">35.1</span> Learning objectives<a href="spatially-continuous-data-iii.html#learning-objectives-34" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Previously, in Chapter <a href="spatially-continuous-data-ii.html#spatially-continuous-data-ii">33</a>, we discussed some limitations of tile-based approaches, inverse distance weighting, and <span class="math inline">\(k\)</span>-points mean. Particularly, these methods do not provide estimates of the uncertainty of point estimates when doing spatial interpolation. Trend surface analysis was introduced as a method for spatial interpolation that also provides estimates of the standard error. However, we saw that it is possible for the residuals of a trend surface model to be autocorrelated: this is an indication that there is still systematic variation in the residuals that was not fully captured by the model. To more fully exploit that residual pattern we need some additional tools. In this practice, you will learn some of said tools, as follows:</p>
<ol style="list-style-type: decimal">
<li>About the implications of residual spatial pattern for predictions.</li>
<li>The measurement of spatial dependence in fields.</li>
<li>Variographic analysis.</li>
</ol>
</div>
<div id="suggested-reading-15" class="section level2 hasAnchor" number="35.2">
<h2><span class="header-section-number">35.2</span> Suggested reading<a href="spatially-continuous-data-iii.html#suggested-reading-15" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Bailey TC and Gatrell AC <span class="citation">(<a href="#ref-Bailey1995" role="doc-biblioref">1995</a>)</span> Interactive Spatial Data Analysis, Chapters 5 and 6. Longman: Essex.</li>
<li>Bivand RS, Pebesma E, and Gomez-Rubio V <span class="citation">(<a href="#ref-Bivand2008" role="doc-biblioref">2008</a>)</span> Applied Spatial Data Analysis with R, Chapter 8. Springer: New York.</li>
<li>Brunsdon C and Comber L <span class="citation">(<a href="#ref-Brunsdon2015R" role="doc-biblioref">2015</a>)</span> An Introduction to R for Spatial Analysis and Mapping, Chapter 6, Sections 6.7 and 6.8. Sage: Los Angeles.</li>
<li>Isaaks EH and Srivastava RM <span class="citation">(<a href="#ref-Isaaks1989applied" role="doc-biblioref">1989</a>)</span> An Introduction to Applied Geostatistics, Chapter 7. Oxford University Press: Oxford.</li>
<li>O’Sullivan D and Unwin D <span class="citation">(<a href="#ref-Osullivan2010" role="doc-biblioref">2010</a>)</span> Geographic Information Analysis, 2nd Edition, Chapters 9 and 10. John Wiley &amp; Sons: New Jersey.</li>
</ul>
</div>
<div id="preliminaries-33" class="section level2 hasAnchor" number="35.3">
<h2><span class="header-section-number">35.3</span> Preliminaries<a href="spatially-continuous-data-iii.html#preliminaries-33" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As usual, it is good practice to clear the working space to make sure that you do not have extraneous items there when you begin your work. The command in <code>R</code> to clear the workspace is <code>rm</code> (for “remove”), followed by a list of items to be removed. To clear the workspace from <em>all</em> objects, do the following:</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="spatially-continuous-data-iii.html#cb767-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>Note that <code>ls()</code> lists all objects currently on the workspace.</p>
<p>Load the libraries you will use in this activity:</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="spatially-continuous-data-iii.html#cb768-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(isdas)</span>
<span id="cb768-2"><a href="spatially-continuous-data-iii.html#cb768-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gstat)</span>
<span id="cb768-3"><a href="spatially-continuous-data-iii.html#cb768-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb768-4"><a href="spatially-continuous-data-iii.html#cb768-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Begin by loading the data file:</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="spatially-continuous-data-iii.html#cb769-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We have been working with the Walker Lake dataset for the last few chapters.</span></span>
<span id="cb769-2"><a href="spatially-continuous-data-iii.html#cb769-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Walker_Lake&quot;</span>)  </span></code></pre></div>
<p>You can verify the contents of the dataframe:</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="spatially-continuous-data-iii.html#cb770-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Walker_Lake)</span></code></pre></div>
<pre><code>##       ID                  X               Y               V         
##  Length:470         Min.   :  8.0   Min.   :  8.0   Min.   :   0.0  
##  Class :character   1st Qu.: 51.0   1st Qu.: 80.0   1st Qu.: 182.0  
##  Mode  :character   Median : 89.0   Median :139.5   Median : 425.2  
##                     Mean   :111.1   Mean   :141.3   Mean   : 435.4  
##                     3rd Qu.:170.0   3rd Qu.:208.0   3rd Qu.: 644.4  
##                     Max.   :251.0   Max.   :291.0   Max.   :1528.1  
##                                                                     
##        U           T      
##  Min.   :   0.00   1: 45  
##  1st Qu.:  83.95   2:425  
##  Median : 335.00          
##  Mean   : 613.27          
##  3rd Qu.: 883.20          
##  Max.   :5190.10          
##  NA&#39;s   :195</code></pre>
</div>
<div id="residual-spatial-pattern" class="section level2 hasAnchor" number="35.4">
<h2><span class="header-section-number">35.4</span> Residual spatial pattern<a href="spatially-continuous-data-iii.html#residual-spatial-pattern" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Chapter @ref{spatially-continuous-data-i} we used trend surface analysis for spatial interpolation. Trend surface analysis improves on methods such as Voronoi polygons, IDW, and <span class="math inline">\(k\)</span>-point means by providing a built-in mechanism for estimating the uncertainty in the predictions. Let us quickly revisit this idea.</p>
<p>The objective of interpolation is to provide the following estimates:
<span class="math display">\[
\hat{z}_p + \hat{\epsilon}_p
\]</span></p>
<p>Trend surface analysis provides interpolated values by generating a trend surface as follows:
<span class="math display">\[
\hat{z} = f(x, y)
\]</span>
from which estimates of <span class="math inline">\(\hat{z}_p\)</span> can be obtained by using suitable prediction coordinates <span class="math inline">\((x_p, y_p)\)</span>.</p>
<p>Next, although trend surface analysis does not provide an estimate of the prediction error <span class="math inline">\(\hat{\epsilon}_p\)</span> (since we do <em>not</em> know the true value of the field at <span class="math inline">\(p\)</span>), it provides confidence intervals for the prediction. In this way we can at the very least bound the prediction error as follows:
<span class="math display">\[
CI_{z_p} = [z_{p_{lwr}}, z_{p_{upr}}].
\]</span></p>
<p>As previously seen, however, use of trend surface analysis does not guarantee that the residuals of the model will be independent.</p>
<p>Let us revisit the model for Walker Lake.</p>
<p>As before, we first calculate the polynomial terms of the coordinates:</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="spatially-continuous-data-iii.html#cb772-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we use `mutate()` to calculate the polynomial terms of the coordinates.</span></span>
<span id="cb772-2"><a href="spatially-continuous-data-iii.html#cb772-2" aria-hidden="true" tabindex="-1"></a>Walker_Lake <span class="ot">&lt;-</span> <span class="fu">mutate</span>(Walker_Lake,</span>
<span id="cb772-3"><a href="spatially-continuous-data-iii.html#cb772-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">X3 =</span> X<span class="sc">^</span><span class="dv">3</span>, <span class="at">X2Y =</span> X<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> Y, <span class="at">X2 =</span> X<span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb772-4"><a href="spatially-continuous-data-iii.html#cb772-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">XY =</span> X <span class="sc">*</span> Y,</span>
<span id="cb772-5"><a href="spatially-continuous-data-iii.html#cb772-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Y2 =</span> Y<span class="sc">^</span><span class="dv">2</span>, <span class="at">XY2 =</span> X <span class="sc">*</span> Y<span class="sc">^</span><span class="dv">2</span>, <span class="at">Y3 =</span> Y<span class="sc">^</span><span class="dv">3</span>)</span></code></pre></div>
<p>And proceed to estimate the following cubic trend surface model, which provided the best fit to the data:</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="spatially-continuous-data-iii.html#cb773-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall use of the linear model for walker lake</span></span>
<span id="cb773-2"><a href="spatially-continuous-data-iii.html#cb773-2" aria-hidden="true" tabindex="-1"></a>WL.trend3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> V <span class="sc">~</span> X3 <span class="sc">+</span> X2Y <span class="sc">+</span> X2 <span class="sc">+</span> X <span class="sc">+</span> XY <span class="sc">+</span> Y <span class="sc">+</span> Y2 <span class="sc">+</span> XY2 <span class="sc">+</span> Y3, </span>
<span id="cb773-3"><a href="spatially-continuous-data-iii.html#cb773-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> Walker_Lake) </span>
<span id="cb773-4"><a href="spatially-continuous-data-iii.html#cb773-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(WL.trend3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = V ~ X3 + X2Y + X2 + X + XY + Y + Y2 + XY2 + Y3, 
##     data = Walker_Lake)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -564.19 -197.41    7.91  194.25  929.72 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -8.620e+00  1.227e+02  -0.070 0.944035    
## X3           1.533e-04  4.806e-05   3.190 0.001522 ** 
## X2Y          6.139e-05  3.909e-05   1.570 0.117000    
## X2          -6.651e-02  1.838e-02  -3.618 0.000330 ***
## X            9.172e+00  2.386e+00   3.844 0.000138 ***
## XY          -4.420e-02  1.430e-02  -3.092 0.002110 ** 
## Y            4.794e+00  2.040e+00   2.350 0.019220 *  
## Y2          -1.806e-03  1.327e-02  -0.136 0.891822    
## XY2          7.679e-05  2.956e-05   2.598 0.009669 ** 
## Y3          -4.170e-05  2.819e-05  -1.479 0.139759    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 276.7 on 460 degrees of freedom
## Multiple R-squared:  0.1719, Adjusted R-squared:  0.1557 
## F-statistic: 10.61 on 9 and 460 DF,  p-value: 5.381e-15</code></pre>
<p>To examine the residuals, first we label them as “positive” or “negative”:</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="spatially-continuous-data-iii.html#cb775-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The function `ifelse()` is used to label the residuals as &quot;Positive&quot; if they are </span></span>
<span id="cb775-2"><a href="spatially-continuous-data-iii.html#cb775-2" aria-hidden="true" tabindex="-1"></a><span class="co"># greater than zero, or &quot;Negative&quot; if they are zero or less.</span></span>
<span id="cb775-3"><a href="spatially-continuous-data-iii.html#cb775-3" aria-hidden="true" tabindex="-1"></a>Walker_Lake <span class="ot">&lt;-</span> Walker_Lake <span class="sc">%&gt;%</span></span>
<span id="cb775-4"><a href="spatially-continuous-data-iii.html#cb775-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residual3 =</span> <span class="fu">ifelse</span>(WL.trend3<span class="sc">$</span>residuals <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb775-5"><a href="spatially-continuous-data-iii.html#cb775-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Positive&quot;</span>, </span>
<span id="cb775-6"><a href="spatially-continuous-data-iii.html#cb775-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Negative&quot;</span>))</span></code></pre></div>
<p>Once the residuals have been labeled we can be plotted as follows:</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="spatially-continuous-data-iii.html#cb776-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Walker_Lake, </span>
<span id="cb776-2"><a href="spatially-continuous-data-iii.html#cb776-2" aria-hidden="true" tabindex="-1"></a>       <span class="co"># Note color is only applied to results of positive or negative residuals</span></span>
<span id="cb776-3"><a href="spatially-continuous-data-iii.html#cb776-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">color =</span> residual3)) <span class="sc">+</span> </span>
<span id="cb776-4"><a href="spatially-continuous-data-iii.html#cb776-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb776-5"><a href="spatially-continuous-data-iii.html#cb776-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="co"># Ensures equal scales for both axes</span></span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-380-1.png" width="672" /></p>
<p>As seen before, there is considerable spatial autocorrelation as confirmed by Moran’s <span class="math inline">\(I\)</span> coefficient:</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="spatially-continuous-data-iii.html#cb777-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the coordinates of Walker Lake and convert to matrix.</span></span>
<span id="cb777-2"><a href="spatially-continuous-data-iii.html#cb777-2" aria-hidden="true" tabindex="-1"></a>WL.listw <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Walker_Lake[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb777-3"><a href="spatially-continuous-data-iii.html#cb777-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find the 5 nearest neighbors of each observations.</span></span>
<span id="cb777-4"><a href="spatially-continuous-data-iii.html#cb777-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knearneigh</span>(<span class="at">k =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb777-5"><a href="spatially-continuous-data-iii.html#cb777-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert the nearest neighbors to `nb` object.</span></span>
<span id="cb777-6"><a href="spatially-continuous-data-iii.html#cb777-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">knn2nb</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb777-7"><a href="spatially-continuous-data-iii.html#cb777-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert the `nb` object into spatial weights. </span></span>
<span id="cb777-8"><a href="spatially-continuous-data-iii.html#cb777-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nb2listw</span>() </span>
<span id="cb777-9"><a href="spatially-continuous-data-iii.html#cb777-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb777-10"><a href="spatially-continuous-data-iii.html#cb777-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Use Moran&#39;s test on the residuals of the trend surface model </span></span>
<span id="cb777-11"><a href="spatially-continuous-data-iii.html#cb777-11" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(<span class="at">x =</span> WL.trend3<span class="sc">$</span>residuals, <span class="at">listw =</span> WL.listw)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  WL.trend3$residuals  
## weights: WL.listw    
## 
## Moran I statistic standard deviate = 17.199, p-value &lt; 2.2e-16
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##      0.4633803457     -0.0021321962      0.0007325452</code></pre>
<p>The fact that the residuals are not independent has important implications for prediction. Consider the following thought experiment.</p>
<p>Imagine that you were asked to guess whether the residual was positive or negative at the locations indicated with triangles in the figure. These are locations where an observation was not made, and we only have the interpolated value of the variable according to the trend surface model:</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="spatially-continuous-data-iii.html#cb779-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Walker_Lake, </span>
<span id="cb779-2"><a href="spatially-continuous-data-iii.html#cb779-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb779-3"><a href="spatially-continuous-data-iii.html#cb779-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> residual3)) <span class="sc">+</span></span>
<span id="cb779-4"><a href="spatially-continuous-data-iii.html#cb779-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Here we add coordinates for the triangles in the figure</span></span>
<span id="cb779-5"><a href="spatially-continuous-data-iii.html#cb779-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">25</span>, <span class="dv">210</span>, <span class="dv">227</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">200</span>, <span class="dv">90</span>, <span class="dv">90</span>, <span class="dv">230</span>)), </span>
<span id="cb779-6"><a href="spatially-continuous-data-iii.html#cb779-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb779-7"><a href="spatially-continuous-data-iii.html#cb779-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-382-1.png" width="672" /></p>
<p>What would your guess be, and why? Would you say that your guess has a better than 50% chance of being right?</p>
<p>Now imagine that you were asked to guess whether the residual was positive or negative at the locations indicated with squares in the figure:</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="spatially-continuous-data-iii.html#cb780-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Walker_Lake, </span>
<span id="cb780-2"><a href="spatially-continuous-data-iii.html#cb780-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb780-3"><a href="spatially-continuous-data-iii.html#cb780-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> residual3)) <span class="sc">+</span></span>
<span id="cb780-4"><a href="spatially-continuous-data-iii.html#cb780-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Here we adding coordinates for the squares in the figure</span></span>
<span id="cb780-5"><a href="spatially-continuous-data-iii.html#cb780-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">240</span>, <span class="dv">12</span>, <span class="dv">120</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="dv">280</span>, <span class="dv">240</span>, <span class="dv">180</span>)), </span>
<span id="cb780-6"><a href="spatially-continuous-data-iii.html#cb780-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">shape =</span> <span class="dv">15</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb780-7"><a href="spatially-continuous-data-iii.html#cb780-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-383-1.png" width="672" /></p>
<p>Again, what would your guess be, and why? Would you be able to guess this way if the residuals were random?</p>
<p>The fact that you can guess and be fairly sure about the quality of your guess is a consequence of the strong residual pattern. If the residuals were random, there would be no information left to use: the odds of a residual being positive or negative would essentially be 50%. However, when there is residual pattern, this information can be used to enhance the quality of your guesses about the residuals, or in other words, of the <span class="math inline">\(\hat{\epsilon}_p\)</span> terms. At the very least you can guess whether they are positive or negative (therefore reducing their confidence intervals), but possibly you can learn even more from them, as will be seen later.</p>
<p>Before learning how to do this, however, we need to think more about the way in which we measure spatial pattern in spatially continuous data.</p>
</div>
<div id="measuring-spatial-dependence-in-spatially-continuous-data" class="section level2 hasAnchor" number="35.5">
<h2><span class="header-section-number">35.5</span> Measuring spatial dependence in spatially continuous data<a href="spatially-continuous-data-iii.html#measuring-spatial-dependence-in-spatially-continuous-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the preceding sections we used Moran’s <span class="math inline">\(I\)</span> coefficient to measure spatial pattern. Moran’s <span class="math inline">\(I\)</span> is, by design, a single-scale statistic, not unlike the case of nearest neighbor analysis in point patterns. The reason for this is that Moran’s <span class="math inline">\(I\)</span> is limited to detecting pattern at the scale at which the spatial weights are defined: for instance, at the level of adjacency, contiguity, or <span class="math inline">\(k\)</span>-nearest neighbors.</p>
<p>While this makes sense (mostly) in the case of area data, since the areas inherently introduce spatial discontinuities, it makes less sense in the case of fields, where the underlying process is typically smooth. In fact, more often we are interested in exploring the properties of the pattern over the field, not just the nearest neighbors.</p>
<p>One way of extending Moran’s <span class="math inline">\(I\)</span> analysis to multiple scales is by means of the <em>correlogram</em>. The correlogram is simply a sequence of Moran’s <span class="math inline">\(I\)</span> coefficients computed at different scales.</p>
<p>Consider for example the following sequence of coefficients, computed for <span class="math inline">\(k\)</span>=10 neighbors to <span class="math inline">\(k\)</span>=30 neighbors. Notice how the <code>for</code> loop calculates spatial weights using the designated number of neighbors, before calculating Moran’s <span class="math inline">\(I\)</span>.</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="spatially-continuous-data-iii.html#cb781-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the values of k</span></span>
<span id="cb781-2"><a href="spatially-continuous-data-iii.html#cb781-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb781-3"><a href="spatially-continuous-data-iii.html#cb781-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb781-4"><a href="spatially-continuous-data-iii.html#cb781-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty vector to store the results of calculating Moran&#39;s I </span></span>
<span id="cb781-5"><a href="spatially-continuous-data-iii.html#cb781-5" aria-hidden="true" tabindex="-1"></a>moranI <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="fu">length</span>(k)) </span>
<span id="cb781-6"><a href="spatially-continuous-data-iii.html#cb781-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb781-7"><a href="spatially-continuous-data-iii.html#cb781-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty dataframe to store the values of k and moranI</span></span>
<span id="cb781-8"><a href="spatially-continuous-data-iii.html#cb781-8" aria-hidden="true" tabindex="-1"></a>correlogram <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(k, moranI) </span>
<span id="cb781-9"><a href="spatially-continuous-data-iii.html#cb781-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb781-10"><a href="spatially-continuous-data-iii.html#cb781-10" aria-hidden="true" tabindex="-1"></a><span class="co"># A `for` loop is a way of repeating instructions a defined number of times, </span></span>
<span id="cb781-11"><a href="spatially-continuous-data-iii.html#cb781-11" aria-hidden="true" tabindex="-1"></a><span class="co"># here from 1 to the length of vector `k`.</span></span>
<span id="cb781-12"><a href="spatially-continuous-data-iii.html#cb781-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)){</span>
<span id="cb781-13"><a href="spatially-continuous-data-iii.html#cb781-13" aria-hidden="true" tabindex="-1"></a>  listwk <span class="ot">&lt;-</span> Walker_Lake[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">%&gt;%</span></span>
<span id="cb781-14"><a href="spatially-continuous-data-iii.html#cb781-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span></span>
<span id="cb781-15"><a href="spatially-continuous-data-iii.html#cb781-15" aria-hidden="true" tabindex="-1"></a>     <span class="co"># Use the ith element of vector `k` to find the nearest neighbors</span></span>
<span id="cb781-16"><a href="spatially-continuous-data-iii.html#cb781-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">knearneigh</span>(<span class="at">k =</span> k[i]) <span class="sc">%&gt;%</span></span>
<span id="cb781-17"><a href="spatially-continuous-data-iii.html#cb781-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">knn2nb</span>() <span class="sc">%&gt;%</span></span>
<span id="cb781-18"><a href="spatially-continuous-data-iii.html#cb781-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nb2listw</span>()</span>
<span id="cb781-19"><a href="spatially-continuous-data-iii.html#cb781-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb781-20"><a href="spatially-continuous-data-iii.html#cb781-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Moran test for residuals</span></span>
<span id="cb781-21"><a href="spatially-continuous-data-iii.html#cb781-21" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="at">x =</span> WL.trend3<span class="sc">$</span>residuals, <span class="at">listw =</span> listwk)</span>
<span id="cb781-22"><a href="spatially-continuous-data-iii.html#cb781-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb781-23"><a href="spatially-continuous-data-iii.html#cb781-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the value of Moran&#39;s I statistic to the ith element of vector correlogram</span></span>
<span id="cb781-24"><a href="spatially-continuous-data-iii.html#cb781-24" aria-hidden="true" tabindex="-1"></a>  correlogram<span class="sc">$</span>moranI[i] <span class="ot">&lt;-</span> m<span class="sc">$</span>estimate[<span class="dv">1</span>] </span>
<span id="cb781-25"><a href="spatially-continuous-data-iii.html#cb781-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Given the values of Moran’s <span class="math inline">\(I\)</span> at different scales (i.e., values of <span class="math inline">\(k\)</span>), the correlogram can be plotted as:</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="spatially-continuous-data-iii.html#cb782-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> correlogram,</span>
<span id="cb782-2"><a href="spatially-continuous-data-iii.html#cb782-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> k, </span>
<span id="cb782-3"><a href="spatially-continuous-data-iii.html#cb782-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> moranI)) <span class="sc">+</span> </span>
<span id="cb782-4"><a href="spatially-continuous-data-iii.html#cb782-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-385-1.png" width="672" /></p>
<p>As can be seen in the plot, spatial autocorrelation tends to decline as the number of nearest neighbors used in the test grows - in other words, as the scale of the test increases. This is a common occurrence: when autocorrelation is present, observations tend to be more similar to their closest neighbors than to their more distant neighbors.</p>
<p>The use of <span class="math inline">\(k\)</span>-nearest neighbors points to a problem, however. The scale of the process does not depend on distance, which would be a more natural metric for a continuous process. In this case, <span class="math inline">\(k\)</span>-nearest neighbors were used to ensure that each sum in the coefficient had the same number of observations. However, this means that “neighborhoods” will be geographically smaller where the observations are more dense, and larger where they are sparse.</p>
<p>While this issue is not insurmountable (for instance, instead of <span class="math inline">\(k\)</span>-nearst neighbors we could have used the neighbors found at a certain distance), it points out to the fact that Moran’s <span class="math inline">\(I\)</span> is not by design well suited for the analysis of spatially continuous data.</p>
<p>A different approach, known as variographic analysis, is introduced next.</p>
</div>
<div id="variographic-analyisis" class="section level2 hasAnchor" number="35.6">
<h2><span class="header-section-number">35.6</span> Variographic analyisis<a href="spatially-continuous-data-iii.html#variographic-analyisis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To introduce variographic analysis it is worthwhile to recall the definition of the covariance between two variables, say <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>:
<span class="math display">\[
C(X,Y) = E[{(X_i^2 - \bar{X})(Y_i^2 - \bar{Y})}]
\]</span>
Where <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(\bar{Y}\)</span> are the means of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> respectively.</p>
<p>The expectation operator <span class="math inline">\(E[]\)</span> turns out to be the mean:
<span class="math display">\[
C(X,Y) = \frac{1}{n}\sum_{i=1}^{n}{(X_i^2 - \bar{X})(Y_j^2 - \bar{Y})}
\]</span></p>
<p>The observations <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span> in the covariance formula can be seen as a points in a scatterplot, with the axes shifted to the means of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, as shown in Figure @ref{fig:covariance-as-scatterplot}.</p>
<div class="figure"><span style="display:block;" id="fig:covariance-as-a-scatterplot"></span>
<img src="figures/35-Figure-1.jpg" alt="\label{fig:covariance-as-scatterplot}Observations of the covariance as a scatterplot" width="640" />
<p class="caption">
FIGURE 35.1: Observations of the covariance as a scatterplot
</p>
</div>
<p>The autocovariance of variable <span class="math inline">\(z\)</span> can be defined in a similar way, the difference being that instead of two variables, it is the covariance of a variable with <em>itself</em> but at a different location (i.e., between locations <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>):
<span class="math display">\[
C(z_i,z_j) = E[{(z_i^2 - \bar{z})(z_j^2 - \bar{z})}]
\]</span></p>
<p>To implement the spatial autocovariance we need some criterion to explicitly define the spatial relationship between locations <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. A useful criterion in this case is as follows:</p>
<p><span class="math display">\[
w_{ij}(h)=\bigg\{\begin{array}{l l}
1\text{ if } d_{ij} = h\\
0\text{ otherwise}\\
\end{array}
\]</span>
In other words, <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are considered to be spatially related for the purposes of calculating the autocovariance, if the distance between the two locations is equal to some predefined spatial lag <span class="math inline">\(h\)</span>.</p>
<p>The above criterion makes explicit the assumption that the autocovariance is a function of the separation <span class="math inline">\(h\)</span> between two observations, but not of other factors, such as the angle between observations. This assumption is called <em>isotropy</em>.</p>
<p>Further, if we assume that the variance of <span class="math inline">\(z\)</span> is constant, and the correlation between observations does not depend on location (an assumption called <em>intrinsic stationarity</em>), we can <em>pool</em> observations from across the map to create a scatterplot to form the basis of the autocovariance calculations.</p>
<p>Consider the (regular) arrangement of observations spaced at <span class="math inline">\(h\)</span> in Figure @ref{fig:autocovariance}. Each observation generally has four neighbors, with the exception of those in the edges, which have fewer neighbors at spatial lag <span class="math inline">\(h\)</span>. This means that most observations will contribute four points to the scatterplot (<span class="math inline">\(z_i\)</span> and <span class="math inline">\(z_j\)</span>, <span class="math inline">\(z_k\)</span>, <span class="math inline">\(z_l\)</span>, and <span class="math inline">\(z_m\)</span>), and others will contribute three or at least two (those in the corners).</p>
<div class="figure"><span style="display:block;" id="fig:autocovariance"></span>
<img src="figures/35-Figure-2.jpg" alt="\label{fig:autocovariance}Finding spatial pairs for the calculation of the autocovariance" width="640" />
<p class="caption">
FIGURE 35.2: Finding spatial pairs for the calculation of the autocovariance
</p>
</div>
<p>Given those pairs of observations, the autocovariance at lag <span class="math inline">\(h\)</span> can be calculated as:
<span class="math display">\[
C_{z}(h) = \frac{\sum_{i=1}^{n}{w_{ij}(h)(z_i^2 - \bar{z})(z_j^2 - \bar{z})}}{\sum_{i=1}^n{w_{ij}(h)}}
\]</span></p>
<p>Changing the spatial lag <span class="math inline">\(h\)</span> allows us to calculate the autocovariance at different scales. The plot of the autocovariance at different scales is called a <em>covariogram</em>.</p>
<p>A related quantity that is more commonly used (mainly for historical reasons) is the <em>semivariance</em>.</p>
<p>The semivariance is defined as follows, calculated based on the difference between <span class="math inline">\(z_i\)</span> and <span class="math inline">\(z_j\)</span>:
<span class="math display">\[
\hat{\gamma}_{z}(h) = \frac{\sum_{i=1}^{n}{w_{ij}(h)(z_i - z_j)^2}}{2\sum_{i=1}^n{w_{ij}(h)}}
\]</span></p>
<p>The plot of the semivariance at different lags <span class="math inline">\(h\)</span> is called a <em>semivariogram</em>.</p>
<p>The covariogram and semivariogram are related by the following formula:
<span class="math display">\[
C_{z}(h) =\sigma^2 - \hat{\gamma}_{z}(h)
\]</span>
where <span class="math inline">\(\sigma^2\)</span> is the sample variance.</p>
<p>The condition that <span class="math inline">\(d_{ij} = h\)</span> is, with the exception of gridded data, too strict, and is often relaxed in the following way:</p>
<p><span class="math display">\[
w_{ij}(\tilde{h})=\bigg\{\begin{array}{l l}
1\text{ if } d_{ij}\simeq h\\
0\text{ otherwise}\\
\end{array}
\]</span></p>
<p>In this way, the distance between observations <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> does not need to be <em>exactly</em>, but can be an approximation. The approximation can be defined explicitly as follows:</p>
<p><span class="math display">\[
w_{ij}(\tilde{h})=\bigg\{\begin{array}{l l}
1\text{ if } h - \Delta h &lt; d_{ij} &lt; h + \Delta h\\
0\text{ otherwise}\\
\end{array}
\]</span></p>
<p>Instead of forming pairs with observations that are at exactly a distance <span class="math inline">\(h\)</span> (which would lead in many cases to too few pairs), pairs are formed with observations at approximately lag <span class="math inline">\(h\)</span> (or <span class="math inline">\(\tilde{h}\)</span>), with a tolerance given by <span class="math inline">\(\Delta h\)</span>.</p>
<p>Analysis based on the semivariogram (called <em>variographic analysis</em>) is implemented in <code>R</code> in the <code>gstat</code> package.</p>
<p>We will illustrate the use of the semivariogram by means of the Walker Lake data. The package <code>gstat</code> accepts simple features objects of the <code>sf</code> package, so we convert our dataframe into such an object:</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="spatially-continuous-data-iii.html#cb783-1" aria-hidden="true" tabindex="-1"></a>Walker_Lake.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(Walker_Lake, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>))</span>
<span id="cb783-2"><a href="spatially-continuous-data-iii.html#cb783-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(Walker_Lake.sf)</span></code></pre></div>
<pre><code>## [1] &quot;sf&quot;         &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>The empirical semivariogram is calculated by means of the <code>gstat::variogram</code> function, as follows:</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="spatially-continuous-data-iii.html#cb785-1" aria-hidden="true" tabindex="-1"></a><span class="co"># `variogram()` calculates the sample semivariogram from data, </span></span>
<span id="cb785-2"><a href="spatially-continuous-data-iii.html#cb785-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or if a linear model is given, for the residuals; in this case, </span></span>
<span id="cb785-3"><a href="spatially-continuous-data-iii.html#cb785-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the formula `V ~ 1` means that we are not using a model</span></span>
<span id="cb785-4"><a href="spatially-continuous-data-iii.html#cb785-4" aria-hidden="true" tabindex="-1"></a>variogram_z <span class="ot">&lt;-</span> <span class="fu">variogram</span>(V <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Walker_Lake.sf) </span>
<span id="cb785-5"><a href="spatially-continuous-data-iii.html#cb785-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb785-6"><a href="spatially-continuous-data-iii.html#cb785-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Note we are plotting the data of `variogram_z`</span></span>
<span id="cb785-7"><a href="spatially-continuous-data-iii.html#cb785-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> variogram_z,</span>
<span id="cb785-8"><a href="spatially-continuous-data-iii.html#cb785-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> dist, </span>
<span id="cb785-9"><a href="spatially-continuous-data-iii.html#cb785-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> gamma)) <span class="sc">+</span> </span>
<span id="cb785-10"><a href="spatially-continuous-data-iii.html#cb785-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb785-11"><a href="spatially-continuous-data-iii.html#cb785-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add labels to indicate the number of pairs of observations used </span></span>
<span id="cb785-12"><a href="spatially-continuous-data-iii.html#cb785-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># in the calculation of each point in the variogram</span></span>
<span id="cb785-13"><a href="spatially-continuous-data-iii.html#cb785-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> np), </span>
<span id="cb785-14"><a href="spatially-continuous-data-iii.html#cb785-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_y =</span> <span class="sc">-</span><span class="dv">1500</span>) <span class="sc">+</span> </span>
<span id="cb785-15"><a href="spatially-continuous-data-iii.html#cb785-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add labels to axes</span></span>
<span id="cb785-16"><a href="spatially-continuous-data-iii.html#cb785-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Distance&quot;</span>) <span class="sc">+</span></span>
<span id="cb785-17"><a href="spatially-continuous-data-iii.html#cb785-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Semivariance&quot;</span>)</span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-387-1.png" width="672" /></p>
<p>The numbers indicate the number of pairs of observations used to calculate the semivariance at the corresponding lag.</p>
<p>Since the sample variance is:</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="spatially-continuous-data-iii.html#cb786-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We are calculating the variance of X</span></span>
<span id="cb786-2"><a href="spatially-continuous-data-iii.html#cb786-2" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">var</span>(Walker_Lake<span class="sc">$</span>V) </span>
<span id="cb786-3"><a href="spatially-continuous-data-iii.html#cb786-3" aria-hidden="true" tabindex="-1"></a>s2</span></code></pre></div>
<pre><code>## [1] 90694.59</code></pre>
<p>It follows that the covariogram in this case is:</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="spatially-continuous-data-iii.html#cb788-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> variogram_z, </span>
<span id="cb788-2"><a href="spatially-continuous-data-iii.html#cb788-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> dist, </span>
<span id="cb788-3"><a href="spatially-continuous-data-iii.html#cb788-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> s2 <span class="sc">-</span> gamma)) <span class="sc">+</span></span>
<span id="cb788-4"><a href="spatially-continuous-data-iii.html#cb788-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb788-5"><a href="spatially-continuous-data-iii.html#cb788-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> np), </span>
<span id="cb788-6"><a href="spatially-continuous-data-iii.html#cb788-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_y =</span> <span class="sc">-</span><span class="dv">1500</span>) <span class="sc">+</span></span>
<span id="cb788-7"><a href="spatially-continuous-data-iii.html#cb788-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Distance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb788-8"><a href="spatially-continuous-data-iii.html#cb788-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Autocovariance&quot;</span>)</span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-389-1.png" width="672" /></p>
<p>As expected, the autocovariance (and hence, the autocorrelation) is stronger at short spatial lags, and declines at larger spatial lags.</p>
<p>The above plots are the <em>empirical</em> semivariogram and covariogram. These plots are used to model a theoretical semivariogram, a function that can be used to estimate spatial dependence at any lag within the domain of the - and not just at the distances for which we have points in the empirical variogram.</p>
<p>Since the semivariogram is the expectation of the square, the function selected for modeling the theoretical semivariogram must be non-negative. Several functions satisfy this condition, a list of which are available in <code>gstat</code> as shown below:</p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="spatially-continuous-data-iii.html#cb789-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This function generates a variogram mode. Here, we are able to view </span></span>
<span id="cb789-2"><a href="spatially-continuous-data-iii.html#cb789-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the list of possible models for a semivariogram</span></span>
<span id="cb789-3"><a href="spatially-continuous-data-iii.html#cb789-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vgm</span>() </span></code></pre></div>
<pre><code>##    short                                      long
## 1    Nug                              Nug (nugget)
## 2    Exp                         Exp (exponential)
## 3    Sph                           Sph (spherical)
## 4    Gau                            Gau (gaussian)
## 5    Exc        Exclass (Exponential class/stable)
## 6    Mat                              Mat (Matern)
## 7    Ste Mat (Matern, M. Stein&#39;s parameterization)
## 8    Cir                            Cir (circular)
## 9    Lin                              Lin (linear)
## 10   Bes                              Bes (bessel)
## 11   Pen                      Pen (pentaspherical)
## 12   Per                            Per (periodic)
## 13   Wav                                Wav (wave)
## 14   Hol                                Hol (hole)
## 15   Log                         Log (logarithmic)
## 16   Pow                               Pow (power)
## 17   Spl                              Spl (spline)
## 18   Leg                            Leg (Legendre)
## 19   Err                   Err (Measurement error)
## 20   Int                           Int (Intercept)</code></pre>
<p>The anatomy of a semivariogram includes a range, a sill, and possibly a nugget. These elements are shown in Figure @ref{fig:semivariogram}.</p>
<div class="figure"><span style="display:block;" id="fig:anatomy-semivariogram"></span>
<img src="figures/35-Figure-2.jpg" alt="\label{fig:semivarigoram}Anatomy of a semivariogram" width="640" />
<p class="caption">
FIGURE 35.3: Anatomy of a semivariogram
</p>
</div>
<p>Since the semivariogram is calculated based on the square of the differences <span class="math inline">\(z_i - z_j\)</span>, the smaller the semivariance is, the more similar observations tend to be. In principle, the semivariogram begins at zero, because at distance zero an observation is identical to itself (i.e., <span class="math inline">\(z_i - z_i\)</span>). The range is the distance at which the sill is reached. The sill, on the other hand, is the point at which the semivariance becomes simply the variance, meaning that there is no more or less similarity between observations than would be implied by the variance of the sample.</p>
<p>An additional element is the nugget. While the semivariogram in principle begins at zero, sometime discontinuities near the origin can be observed. The terminology is from mining, and reflects the fact that a nugget could be very different from the material around it, hence the jump in the semivariogram.</p>
<p>Some theoretical functions are shown next.</p>
<p>Exponential semivariogram:</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="spatially-continuous-data-iii.html#cb791-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We use &quot;exp&quot; to denote the use of an exponential semivariogram. </span></span>
<span id="cb791-2"><a href="spatially-continuous-data-iii.html#cb791-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Refer to the list on line 297 and explore the different outcomes </span></span>
<span id="cb791-3"><a href="spatially-continuous-data-iii.html#cb791-3" aria-hidden="true" tabindex="-1"></a><span class="co"># of the listed variogram models! </span></span>
<span id="cb791-4"><a href="spatially-continuous-data-iii.html#cb791-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">variogramLine</span>(<span class="fu">vgm</span>(<span class="dv">1</span>, </span>
<span id="cb791-5"><a href="spatially-continuous-data-iii.html#cb791-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Exp&quot;</span>,</span>
<span id="cb791-6"><a href="spatially-continuous-data-iii.html#cb791-6" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span>), </span>
<span id="cb791-7"><a href="spatially-continuous-data-iii.html#cb791-7" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">10</span>),</span>
<span id="cb791-8"><a href="spatially-continuous-data-iii.html#cb791-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&#39;l&#39;</span>) </span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-391-1.png" width="672" /></p>
<p>Spherical semivariogram:</p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="spatially-continuous-data-iii.html#cb792-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">variogramLine</span>(<span class="fu">vgm</span>(<span class="dv">1</span>, </span>
<span id="cb792-2"><a href="spatially-continuous-data-iii.html#cb792-2" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Sph&quot;</span>,</span>
<span id="cb792-3"><a href="spatially-continuous-data-iii.html#cb792-3" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span>), </span>
<span id="cb792-4"><a href="spatially-continuous-data-iii.html#cb792-4" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">10</span>), </span>
<span id="cb792-5"><a href="spatially-continuous-data-iii.html#cb792-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-392-1.png" width="672" /></p>
<p>Gaussian semivariogram:</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="spatially-continuous-data-iii.html#cb793-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">variogramLine</span>(<span class="fu">vgm</span>(<span class="dv">1</span>, </span>
<span id="cb793-2"><a href="spatially-continuous-data-iii.html#cb793-2" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Gau&quot;</span>, </span>
<span id="cb793-3"><a href="spatially-continuous-data-iii.html#cb793-3" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span>), </span>
<span id="cb793-4"><a href="spatially-continuous-data-iii.html#cb793-4" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">10</span>), </span>
<span id="cb793-5"><a href="spatially-continuous-data-iii.html#cb793-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-393-1.png" width="672" /></p>
<p>These plots illustrate some differences in the behavior of the models. For identical parameters, the Gaussian model provides smoother changes near the origin. The spherical model reaches the sill more rapidly than the other models.</p>
<p>To fit a theoretical semivariogram to the empirical one, the function <code>fit.variogram</code> is used:</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="spatially-continuous-data-iii.html#cb794-1" aria-hidden="true" tabindex="-1"></a><span class="co"># `fit_variogram` selects the type of model that will fit </span></span>
<span id="cb794-2"><a href="spatially-continuous-data-iii.html#cb794-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the empirical semivariogram best</span></span>
<span id="cb794-3"><a href="spatially-continuous-data-iii.html#cb794-3" aria-hidden="true" tabindex="-1"></a>variogram_z.t <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(variogram_z, <span class="at">model =</span> <span class="fu">vgm</span>(<span class="st">&quot;Exp&quot;</span>)) </span></code></pre></div>
<p>The results of which can be plotted after passing the model the the function <code>variogramLine</code>:</p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="spatially-continuous-data-iii.html#cb795-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice how &#39;maxdist&#39; is 130, and the model does not exceed that value.</span></span>
<span id="cb795-2"><a href="spatially-continuous-data-iii.html#cb795-2" aria-hidden="true" tabindex="-1"></a>gamma.t <span class="ot">&lt;-</span> <span class="fu">variogramLine</span>(variogram_z.t, </span>
<span id="cb795-3"><a href="spatially-continuous-data-iii.html#cb795-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">maxdist =</span> <span class="dv">130</span>) </span>
<span id="cb795-4"><a href="spatially-continuous-data-iii.html#cb795-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb795-5"><a href="spatially-continuous-data-iii.html#cb795-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb795-6"><a href="spatially-continuous-data-iii.html#cb795-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> variogram_z, </span>
<span id="cb795-7"><a href="spatially-continuous-data-iii.html#cb795-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> dist, </span>
<span id="cb795-8"><a href="spatially-continuous-data-iii.html#cb795-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> gamma)) <span class="sc">+</span></span>
<span id="cb795-9"><a href="spatially-continuous-data-iii.html#cb795-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb795-10"><a href="spatially-continuous-data-iii.html#cb795-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> gamma.t,</span>
<span id="cb795-11"><a href="spatially-continuous-data-iii.html#cb795-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> dist, </span>
<span id="cb795-12"><a href="spatially-continuous-data-iii.html#cb795-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> gamma)) <span class="sc">+</span></span>
<span id="cb795-13"><a href="spatially-continuous-data-iii.html#cb795-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Distance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb795-14"><a href="spatially-continuous-data-iii.html#cb795-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Semivariance&quot;</span>)</span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-395-1.png" width="672" /></p>
<p>A set of models can be passed as an argument to <code>fit.variogram</code>, in which case the value (output) of the function is the model that provides the best fit to the empirical semivariogram:</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="spatially-continuous-data-iii.html#cb796-1" aria-hidden="true" tabindex="-1"></a>variogram_z.t <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(variogram_z, </span>
<span id="cb796-2"><a href="spatially-continuous-data-iii.html#cb796-2" aria-hidden="true" tabindex="-1"></a>                               <span class="co"># Models to choosing the best fit</span></span>
<span id="cb796-3"><a href="spatially-continuous-data-iii.html#cb796-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">model =</span> <span class="fu">vgm</span>(<span class="st">&quot;Exp&quot;</span>, </span>
<span id="cb796-4"><a href="spatially-continuous-data-iii.html#cb796-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Sph&quot;</span>, </span>
<span id="cb796-5"><a href="spatially-continuous-data-iii.html#cb796-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">&quot;Gau&quot;</span>)) </span>
<span id="cb796-6"><a href="spatially-continuous-data-iii.html#cb796-6" aria-hidden="true" tabindex="-1"></a>variogram_z.t</span></code></pre></div>
<pre><code>##   model     psill    range
## 1   Nug  4045.567  0.00000
## 2   Exp 90703.773 12.52591</code></pre>
<p>In this case, it can be seen that the best fitting model is the exponential, as follows:</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="spatially-continuous-data-iii.html#cb798-1" aria-hidden="true" tabindex="-1"></a>gamma.t <span class="ot">&lt;-</span> <span class="fu">variogramLine</span>(variogram_z.t, </span>
<span id="cb798-2"><a href="spatially-continuous-data-iii.html#cb798-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">maxdist =</span> <span class="dv">130</span>)</span>
<span id="cb798-3"><a href="spatially-continuous-data-iii.html#cb798-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb798-4"><a href="spatially-continuous-data-iii.html#cb798-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot </span></span>
<span id="cb798-5"><a href="spatially-continuous-data-iii.html#cb798-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> variogram_z, </span>
<span id="cb798-6"><a href="spatially-continuous-data-iii.html#cb798-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> dist, </span>
<span id="cb798-7"><a href="spatially-continuous-data-iii.html#cb798-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> gamma)) <span class="sc">+</span></span>
<span id="cb798-8"><a href="spatially-continuous-data-iii.html#cb798-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb798-9"><a href="spatially-continuous-data-iii.html#cb798-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> gamma.t,</span>
<span id="cb798-10"><a href="spatially-continuous-data-iii.html#cb798-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> dist, </span>
<span id="cb798-11"><a href="spatially-continuous-data-iii.html#cb798-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> gamma)) <span class="sc">+</span></span>
<span id="cb798-12"><a href="spatially-continuous-data-iii.html#cb798-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Distance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb798-13"><a href="spatially-continuous-data-iii.html#cb798-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Semivariance&quot;</span>)</span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-397-1.png" width="672" /></p>
<p>For comparison, we will do the variographic analysis of a simulated random dataset.</p>
<p>Generate coordinates for observations and expand on a grid:</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="spatially-continuous-data-iii.html#cb799-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We are generating a regular sequence of coordinates by means of &#39;seq&#39; </span></span>
<span id="cb799-2"><a href="spatially-continuous-data-iii.html#cb799-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, </span>
<span id="cb799-3"><a href="spatially-continuous-data-iii.html#cb799-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">to =</span> <span class="dv">250</span>, </span>
<span id="cb799-4"><a href="spatially-continuous-data-iii.html#cb799-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">by =</span> <span class="dv">10</span>)</span>
<span id="cb799-5"><a href="spatially-continuous-data-iii.html#cb799-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, </span>
<span id="cb799-6"><a href="spatially-continuous-data-iii.html#cb799-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">to =</span> <span class="dv">290</span>, </span>
<span id="cb799-7"><a href="spatially-continuous-data-iii.html#cb799-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">by =</span> <span class="dv">10</span>)</span>
<span id="cb799-8"><a href="spatially-continuous-data-iii.html#cb799-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb799-9"><a href="spatially-continuous-data-iii.html#cb799-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame `df` to store these values</span></span>
<span id="cb799-10"><a href="spatially-continuous-data-iii.html#cb799-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x =</span> x, </span>
<span id="cb799-11"><a href="spatially-continuous-data-iii.html#cb799-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> y)  </span></code></pre></div>
<p>Then, create a random variable for this coordinates:</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="spatially-continuous-data-iii.html#cb800-1" aria-hidden="true" tabindex="-1"></a><span class="co"># `set.seed()` is used for replicability: it uses the seed </span></span>
<span id="cb800-2"><a href="spatially-continuous-data-iii.html#cb800-2" aria-hidden="true" tabindex="-1"></a><span class="co"># in the argument for generating random numbers</span></span>
<span id="cb800-3"><a href="spatially-continuous-data-iii.html#cb800-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>) </span>
<span id="cb800-4"><a href="spatially-continuous-data-iii.html#cb800-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">780</span>, <span class="at">mean =</span> <span class="dv">500</span>, <span class="at">sd =</span> <span class="dv">300</span>)</span></code></pre></div>
<p>Finally, convert to a simple features object:</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="spatially-continuous-data-iii.html#cb801-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(df, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)) </span></code></pre></div>
<p>The empirical variogram is:</p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="spatially-continuous-data-iii.html#cb802-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the variogram</span></span>
<span id="cb802-2"><a href="spatially-continuous-data-iii.html#cb802-2" aria-hidden="true" tabindex="-1"></a>variogram_df <span class="ot">&lt;-</span> <span class="fu">variogram</span>(z <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span>
<span id="cb802-3"><a href="spatially-continuous-data-iii.html#cb802-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb802-4"><a href="spatially-continuous-data-iii.html#cb802-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb802-5"><a href="spatially-continuous-data-iii.html#cb802-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> variogram_df, <span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y =</span> gamma)) <span class="sc">+</span></span>
<span id="cb802-6"><a href="spatially-continuous-data-iii.html#cb802-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb802-7"><a href="spatially-continuous-data-iii.html#cb802-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> np), <span class="at">nudge_y =</span> <span class="sc">-</span><span class="dv">1500</span>) <span class="sc">+</span> </span>
<span id="cb802-8"><a href="spatially-continuous-data-iii.html#cb802-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">98100</span>)) <span class="sc">+</span></span>
<span id="cb802-9"><a href="spatially-continuous-data-iii.html#cb802-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Distance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb802-10"><a href="spatially-continuous-data-iii.html#cb802-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Semivariance&quot;</span>)  </span></code></pre></div>
<p><img src="spatial-analysis-R_files/figure-html/unnamed-chunk-401-1.png" width="672" /></p>
<p>The range of the semivariogram appears to be zero, or alternatively, there seems to be a pure nugget effect. This is as expected. Since the data are spatially random, they are not more similar at shorter distances than they would be at longer distances.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bailey1995" class="csl-entry">
Bailey, T. C., and A. C. Gatrell. 1995. <em>Interactive Spatial Data Analysis</em>. Book. Essex: Addison Wesley Longman.
</div>
<div id="ref-Bivand2008" class="csl-entry">
Bivand, R. S., E. J. Pebesma, and V. Gómez-Rubio. 2008. <em>Applied Spatial Data Analysis with r</em>. Book. New York: Springer Science+Business Media.
</div>
<div id="ref-Brunsdon2015R" class="csl-entry">
Brunsdon, Chris, and Lex Comber. 2015. <em>An Introduction to r for Spatial Analysis and Mapping</em>. Book. Sage.
</div>
<div id="ref-Isaaks1989applied" class="csl-entry">
Isaaks, E. H., and R. M. Srivastava. 1989. <em>Applied Geostatistics</em>. Book. New York: Oxford University Press.
</div>
<div id="ref-Osullivan2010" class="csl-entry">
O’Sullivan, David, and David Unwin. 2010. <em>Geographic Information Analysis</em>. Book. 2nd. Edition. Hoboken, New Jersey: John Wiley &amp; Sons.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="activity-16-spatially-continuous-data-ii.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="activity-17-spatially-continuous-data-iii.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/paezha/spatial-analysis-R/edit/main/35-Spatially-Continuous-Data-III.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["spatial-analysis-R.pdf", "spatial-analysis-R.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
